!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=15)}([function(e){e.exports=JSON.parse('{"url":{"name":"comparepanel","separator":"*!"},"constructor":"M.plugin.Comparepanel","parameters":[{"type":"object","properties":[{"type":"simple","name":"position","possibleValues":["TL","TR","BL","BR"],"position":0},{"type":"boolean","name":"vertical","position":1},{"type":"simple","name":"baseLayers","position":2}]}],"files":{"ol":{"scripts":["comparepanel.ol.min.js"],"styles":["comparepanel.ol.min.css"]}},"metadata":{"name":"Comparepanel","description":"Plugin de comparadores","text":"Plugin que reune los comparadores","version":"1.0.0","date":"Octubre, 2020","author":"","org":"Consejería de Hacienda, Industria y Energía. Junta de Andalucía.","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg","centralized":true}}')},function(e){e.exports=JSON.parse('{"tooltip":"Comparepanel","title":"Comparepanel","play":"Play","pause":"Pause","exception":"The implementation used cannot create comparepanelControl controls","intervals_error":"The intervals were not defined correctly","tooltipLyr":"Layer Comparison","tooltip_vcurtain":"Vertical curtain","tooltip_hcurtain":"Horizontal curtain","tooltip_multicurtain":"Multi curtain","tooltip_deactivatecurtain":"Deactivate curtain","layers":"Layehrs","radius":"Radius","opacity":"Opacity","static":"Static","dynamic":"Dynamic","mixed":"Mixed","layer":"Layer","opacity_tooltip":"Opacity of the layers (0-100%)","dynamic_tooltip":"Division between layers is fixed by mouse position","mixed_tooltip":"Division between layers is dragged by mouse","static_tooltip":"Division between layers is fixed 50%","lyrLeftSelect_tooltip":"Select layer on the left","lyrRightSelect_tooltip":"Select layer on the right","advice_sameLayer":"One layer in different places is not allowed","no_layers_plugin":"The number of layers is insufficient to apply the effect","repeated_layers":"Selected layers cannot be repeated","tooltipMirrorpanel":"Mirror Comparison","titleMirrorpanel":"Mirror Maps","modViz0":"Standard map","modViz1":"Vertical two maps","modViz2":"Horizontal two maps","modViz3":"Vertical three maps","modViz4":"Vertical four maps","modViz5":"Mosaic maps","modViz6":"Horizontal four maps","modViz7":"Vertical 2-1-1 proportional maps","modViz8":"One map above and two below","modViz9":"Two maps above and one below","tooltipTimeline":"Timeline","titleTimeline":"Timeline","tooltipTransparency":"Transparency","transparency":"Transparency","errorLayer":"Transparency: No valid layer specified on which to apply the effect","nolayertext":"No layer selected","freeze":"freeze cursor","unfreeze":"defrost cursor","activate_spyeye":"SpyEye ON","deactivate_spyeye":"SpyEye OFF"}')},function(e){e.exports=JSON.parse('{"tooltip":"Panel de Comparadores","title":"Panel de Comparadores","play":"Iniciar","pause":"Parar","exception":"La implementación usada no puede crear controles ComparepanelControl","intervals_error":"Los intervalos no fueron definidos correctamente","tooltipLyr":"Comparador de capas","tooltip_vcurtain":"Cortina vertical","tooltip_hcurtain":"Cortina horizontal","tooltip_multicurtain":"Multivista","tooltip_deactivatecurtain":"Desactivar cortina","layers":"Capas","radius":"Radio","opacity":"Opacidad","static":"Estático","dynamic":"Dinámico","mixed":"Mixto","layer":"Capa","opacity_tooltip":"Opacidad de las capas que se comparan (0-100%)","dynamic_tooltip":"La división la marca la posición del cursor","mixed_tooltip":"La división se arrastra con el ratón","static_tooltip":"La división es fija en el centro del mapa","lyrLeftSelect_tooltip":"Selecciona la capa de la izquierda","lyrRightSelect_tooltip":"Selecciona la capa de la derecha","advice_sameLayer":"No puede cargarse la misma capa en varios sitios","no_layers_plugin":"El número de capas es insuficiente para aplicar el efecto","repeated_layers":"Las capas seleccionadas no se pueden repetir","tooltipMirrorpanel":"Comparador de mapas espejo","titleMirrorpanel":"Mapas espejo","modViz0":"Mapa standard","modViz1":"Dos mapas en vertical","modViz2":"Dos mapas en horizontal","modViz3":"Tres mapas en vertical","modViz4":"Cuatro mapas en vertical","modViz5":"Mosaico de mapas","modViz6":"Cuatro mapas en horizontal","modViz7":"Tres mapas en proporción 2-1-1","modViz8":"Un mapa arriba y dos abajo","modViz9":"Dos mapas arriba y uno abajo","tooltipTimeline":"Línea de tiempo","titleTimeline":"Línea de tiempo","tooltipTransparency":"Transparencia","transparency":"Transparencia","errorLayer":"Transparency: No se ha especificado una capa válida sobre la que aplicar el efecto","nolayertext":"Ninguna capa","freeze":"Inmovilizar cursor","unfreeze":"liberar cursor","activate_spyeye":"Activar Spy Eye","deactivate_spyeye":"Desactivar Spy Eye"}')},function(e,t){e.exports='<div id="div-contenedor" class="m-control m-container m-comparepanel-container">\n    <div id=\'m-cp-mirrorpanel\'>\n        <button id=\'m-cp-mirrorpanel-btn\' class="cp-button cp-icon" title="{{translations.tooltipMirrorpanel}}"></button>\n    </div>\n    <div id=\'m-cp-lyrcompare\'>\n        <button id=\'m-cp-lyrcompare-btn\' class="cp-button cp-columns" title="{{translations.tooltipLyr}}"></button>\n    </div>\n    <div id=\'m-cp-timeline\'>\n        <button id=\'m-cp-timeline-btn\' class="cp-button cp-gestion-reloj2" title="{{translations.tooltipTimeline}}" style="display:none;"></button>\n    </div>\n    <div id=\'m-cp-transparency\'>\n        <button id=\'m-cp-transparency-btn\' class="cp-button cp-transparency-icon" title="{{translations.tooltipTransparency}}"></button>\n    </div>\n    \x3c!--\n    <div id=\'m-cp-transparency\'>\n        <button id=\'m-cp-transparency-btn\' class="cp-button cp-transparency-icon" title="{{translations.tooltipTransparency}}"></button>\n    </div>\n    --\x3e\n    \x3c!--<div id=\'m-cp-testing\'>--\x3e\n        \x3c!--<button id=\'m-cp-testing-btn\' class="cp-button  cp-gestion-testing" title="{{translations.tooltipTransparency}}" ></button>--\x3e\n    \x3c!--</div>--\x3e\n\n\n   \n\n</div>\n'},function(e,t){e.exports='<div id="div-contenedor" class="m-mirrorpanel-container">\n  <div class="div-m-mirrorpanel-panel">\n    <div class="m-mirrorpanel-effect-buttoms">\n      <button id="set-mirror-0" class="big-button" title="{{translations.modViz0}}"><i class="cp-modeviz0"></i></button>\n      <button id="set-mirror-1" class="big-button" title="{{translations.modViz1}}"><i class="cp-modeviz1"></i></button>\n      <button id="set-mirror-2" class="big-button" title="{{translations.modViz2}}"><i class="cp-modeviz2"></i></button>\n      <button id="set-mirror-3" class="big-button" title="{{translations.modViz3}}"><i class="cp-modeviz3"></i></button>\n      <button id="set-mirror-4" class="big-button" title="{{translations.modViz4}}"><i class="cp-modeviz4"></i></button>\n      <button id="set-mirror-5" class="big-button" title="{{translations.modViz5}}"><i class="cp-modeviz5"></i></button>\n      <button id="set-mirror-6" class="big-button" title="{{translations.modViz6}}"><i class="cp-modeviz6"></i></button>\n      <button id="set-mirror-7" class="big-button" title="{{translations.modViz7}}"><i class="cp-modeviz7"></i></button>\n      <button id="set-mirror-8" class="big-button" title="{{translations.modViz8}}"><i class="cp-modeviz8"></i></button>\n      <button id="set-mirror-9" class="big-button" title="{{translations.modViz9}}"><i class="cp-modeviz9"></i></button>\n    </div>\n    \n  </div>\n\n</div>\n'},function(e,t){e.exports='<div id="div-contenedor" class="m-control m-container m-lyrdropdown">\n  <div class="m-lyrdropdown-select" id="m-lyrcompare-lyrB-cont">\n    <select id="m-lyrdropdown-selector">\n        <option value=\'None\'>{{translations.nolayertext}}</option>\n        {{#each options}}\n        <option value=\'{{this.name}}\'>{{this.legend}}</option>\n        {{/each}}        \n    </select>\n    <div class="m-lyrdropdown-select_arrow">\n    </div>\n  </div>\n</div>\n'},function(e,t){e.exports='<div id="div-contenedor" class="m-timeline-container">\n    <div class="div-m-timeline-panel">\n        <div class="div-m-timeline-slider">\n            <input type="range" min="0" max="100" value="0" step="any" id="input-slider"></input>\n            <div class=\'slider-tags\'></div>\n        </div>\n        <div class="m-timeline-names">\n            \n        </div>\n        <div class="m-timeline-button">\n            <button id="m-timeline-play" class="cp-control-siguiente" title="Start / Stop"></button>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div id="div-contenedor" class="m-lyrcompare-container">\n    <div class="div-m-lyrcompare-panel">\n        <div class="m-lyrcompare-effect-buttoms">\n            <button id="m-lyrcompare-vcurtain" class="big-buttom" title="{{translations.tooltip_vcurtain}}"><i class="cp-columns"></i></button>\n            <button id="m-lyrcompare-hcurtain" class="big-buttom" title="{{translations.tooltip_hcurtain}}"><i class="cp-columns-rotate"></i></button>\n            <button id="m-lyrcompare-multicurtain" class="big-buttom" title="{{translations.tooltip_multicurtain}}"><i class="cp-th-large"></i></button>\n            <button id="m-lyrcompare-deactivate" class="big-buttom" title="{{translations.tooltip_deactivatecurtain}}"><i class="cp-deactivateCurtain"></i></button>\n        </div>\n        <div class="div-m-lyrcompare-transparent-opacity">\n            <label for="input-transparent-opacity" title="{{translations.opacity_tooltip}}">{{translations.opacity}}: </label>\n            <input type="range" min="0" max="100" value="100" id="input-transparent-opacity" title="{{translations.opacity_tooltip}}"></input>\n        </div>\n        <div class="div-m-lyrcompare-transparent-static">\n            <input type="radio" id="div-m-lyrcompare-transparent-dynamic" name="staticDivision" value="0"><label for="div-m-lyrcompare-transparent-dynamic" title="{{translations.dynamic_tooltip}}">{{translations.dynamic}}</label>\n            <input type="radio" id="div-m-lyrcompare-transparent-static" name="staticDivision" value="1"><label for="div-m-lyrcompare-transparent-static" title="{{translations.static_tooltip}}">{{translations.static}}</label>\n            <input type="radio" id="div-m-lyrcompare-transparent-mixed" name="staticDivision" value="2"><label for="div-m-lyrcompare-transparent-mixed" title="{{translations.mixed_tooltip}}">{{translations.mixed}}</label>\n        </div>\n\n        {{#if options}}\n            <div class="m-lyrcompare-select" id="m-lyrcompare-lyrA-cont">\n                <hr/>\n                <label id="m-lyrcompare-lyrA-lbl" for="m-lyrcompare-lyrA" title="{{translations.lyrLeftSelect_tooltip}}"></label>\n                <select disabled id="m-lyrcompare-lyrA">\n                    {{#each options}}\n                        <option value=\'{{this.name}}\'>{{this.legend}}</option>\n                    {{/each}}\n                </select>\n                <div class="m-lyrcompare-select_arrow"></div>\n            </div>\n            <div class="m-lyrcompare-select" id="m-lyrcompare-lyrB-cont">\n                <label id="m-lyrcompare-lyrB-lbl" for="m-lyrcompare-lyrB" title="{{translations.lyrRightSelect_tooltip}}"></label>\n                <select disabled id="m-lyrcompare-lyrB">\n                    {{#each options}}\n                        <option value=\'{{this.name}}\'>{{this.legend}}</option>\n                    {{/each}}\n                </select>\n                <div class="m-lyrcompare-select_arrow">\n                </div>\n            </div>\n            \x3c!--Multi Curtain--\x3e\n            <div class="m-lyrcompare-select" id="m-lyrcompare-lyrC-cont">\n                <label id="m-lyrcompare-lyrC-lbl" for="m-lyrcompare-lyrC" title="{{translations.lyrLeftSelect_tooltip}}"></label>\n                <select disabled id="m-lyrcompare-lyrC">\n                    {{#each options}}\n                        <option value=\'{{this.name}}\'>{{this.legend}}</option>\n                    {{/each}}\n                </select>\n                <div class="m-lyrcompare-select_arrow"></div>\n            </div>\n            <div class="m-lyrcompare-select" id="m-lyrcompare-lyrD-cont">\n                <label id="m-lyrcompare-lyrD-lbl" for="m-lyrcompare-lyrD" title="{{translations.lyrRightSelect_tooltip}}"></label>\n                <select disabled id="m-lyrcompare-lyrD">\n                    {{#each options}}\n                        <option value=\'{{this.name}}\'>{{this.legend}}</option>\n                    {{/each}}\n                </select>\n                <div class="m-lyrcompare-select_arrow">\n                </div>\n            </div>\n        {{/if}}\n    </div>\n</div>\n'},function(e,t){e.exports='<div id="div-contenedor" class="m-transparency-container">\n    <div class="div-m-transparency-panel">\n        <button id="m-transparency-active" class="big-buttom" title="{{translations.activate_spyeye}}"><i class="cp-transparency-icon"></i></button>\n        <button id="m-transparency-deactivate" class="big-buttom" title="{{translations.deactivate_spyeye}}" disabled><i class="cp-deactivateCurtain"></i></button>\n        <button id="m-transparency-lock" class="big-buttom" title="{{translations.freeze}}"><i class="cp-lock-icon"></i></button>\n        <button id="m-transparency-unlock" class="big-buttom" title="{{translations.unfreeze}}" style="margin-left:-36px;"><i class="cp-unlock-icon"></i></button>\n\n        <div class="div-m-transparency-transparent-radius">\n            <p>{{translations.radius}}:</p>\n            <input type="range" min="30" max="200" value="100" id="input-transparent-radius"></input>\n        </div>\n        {{#if options}}\n            <div class="m-transparency-select">\n                <p>{{translations.layers}}: </p>\n                <select id="m-transparency-lyr" disabled>\n                    {{#each options}}\n                        <option value="{{name}}">{{legend}}</option>\n                    {{/each}}\n                </select>\n                <div class="m-transparency-select_arrow">\n                </div>\n            </div>\n        {{/if}}\n    </div>\n</div>\n'},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){"use strict";r.r(t);r(9);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=u(e);if(t){var o=u(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(p,M.impl.Control);var t,r,n,c=s(p);function p(){return o(this,p),c.apply(this,arguments)}return t=p,(r=[{key:"addTo",value:function(e,t){this.map=e,this.olMap=e.getMapImpl(),a(u(p.prototype),"addTo",this).call(this,e,t)}}])&&i(t.prototype,r),n&&i(t,n),p}(),y=r(3),d=r.n(y),m=r(1),f=r(2),h={en:m,es:f},v=function(){var e="es";return"function"==typeof M.language.getLang&&(e=M.language.getLang()),e},b=function(e){return"es"===e||"en"===e?h[e]:M.language.getTranslation(e).comparepanel},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v(),r=b(t),n="";return M.utils.isNullOrEmpty(r)?console.warn("The translation '".concat(t,"' has not been defined.")):n=e.split(".").reduce((function(e,t){return e[t]}),r),n};r(10);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t,r){return(w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=k(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k(e);if(t){var o=k(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return O(this,r)}}function O(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(i,M.impl.Control);var t,r,n,o=P(i);function i(){return S(this,i),o.apply(this,arguments)}return t=i,(r=[{key:"addTo",value:function(e,t){var r=this;e.getMapImpl().getInteractions().forEach((function(e){e instanceof ol.interaction.DoubleClickZoom&&(r.dblClickInteraction_=e)})),w(k(i.prototype),"addTo",this).call(this,e,t)}}])&&L(t.prototype,r),n&&L(t,n),i}(),R=r(4),j=r.n(R);r(11);function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function V(e,t,r){return(V="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=z(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=z(e);if(t){var o=z(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return I(this,r)}}function I(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(i,M.impl.Control);var t,r,n,o=A(i);function i(){return D(this,i),o.apply(this,arguments)}return t=i,(r=[{key:"addTo",value:function(e,t){this.map=e,this.olMap=e.getMapImpl(),V(z(i.prototype),"addTo",this).call(this,e,t)}},{key:"setLayer",value:function(e){e.setVisible(!0)}},{key:"addLayer",value:function(e){}},{key:"removeEffects",value:function(){}},{key:"removeLayer",value:function(e){}}])&&T(t.prototype,r),n&&T(t,n),i}(),N=r(5),Z=r.n(N);function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function K(e,t){return(K=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=H(e);if(t){var o=H(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return G(this,r)}}function G(e,t){return!t||"object"!==W(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var J=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K(e,t)}(i,M.Control);var t,r,n,o=U(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),M.utils.isUndefined(B)&&M.exception(g("exception"));var r=new B;return(t=o.call(this,r,"Lyrdropdown")).pluginOnLeft=e.pluginOnLeft,t.layers=e.layers,t.collapsible=e.collapsible,t.collapsed=e.collapsed,t.layerSelected=null,t.lyrsMirrorMinZindex=e.lyrsMirrorMinZindex,t.template=null,t}return t=i,(r=[{key:"createView",value:function(e){var t=this;return this.map=e,new Promise((function(e,r){t.layers=t.transformToLayers(t.layers);var n=t.layers.map((function(e){return e instanceof Object?{name:e.name,legend:e.legend}:{name:e,legend:e}})),o="";n.length>1&&(o={jsonp:!0,vars:{options:n,translations:{tooltip:g("tooltip"),nolayertext:g("nolayertext")}}}),t.template=M.template.compileSync(Z.a,o),0===t.layers.length?M.dialog.error(g("no_layers_plugin")):t.activate(),t.template.querySelector("#m-lyrdropdown-selector").addEventListener("change",(function(e){var r=t.map.getLayers().filter((function(t){return t.name===e.target.value}));t.layerSelected.setVisible(!1),t.removeEffects(),0!==r.length&&(t.layerSelected=r[0],t.layerSelected.setZIndex(t.lyrsMirrorMinZindex),t.getImpl().setLayer(t.layerSelected))})),e(t.template)}))}},{key:"activate",value:function(){null===this.layerSelected&&(this.layerSelected=this.layers[0]),this.layers.map((function(e){return e instanceof Object?{name:e.name}:{name:e}})).length>=1&&(this.template.querySelector("#m-lyrdropdown-selector").disabled=!1)}},{key:"deactivate",value:function(){null===this.layerSelected&&(this.layerSelected=this.layers[0]);var e=this.layers.map((function(e){return e instanceof Object?{name:e.name}:{name:e}}));try{this.removeEffects(),this.layerSelected.setVisible(!1),e.length>=1&&(this.template.querySelector("#m-lyrdropdown-selector").disabled=!0)}catch(e){console.log(e)}}},{key:"getActivationButton",value:function(e){return e.querySelector(".m-lyrdropdown button")}},{key:"removeEffects",value:function(){this.getImpl().removeEffects()}},{key:"transformToLayers",value:function(e){var t=this,r=e.map((function(e){var r=null;if(e instanceof Object){if(e instanceof Object){var n=t.map.getLayers().filter((function(t){return e.name.includes(t.name)}))[0];r=t.isValidLayer(n)?n:null}}else if(e.indexOf("*")>=0){var o=e.split("*");"WMS"===o[0].toUpperCase()?(r=new M.layer.WMS({url:o[2],name:o[3],legend:o[1]}),t.map.getLayers().filter((function(e){return r.name.includes(e.name)})).length>0?(r=t.map.getLayers().filter((function(e){return r.name.includes(e.name)}))[0]).legend=o[1]||r.name:t.map.addLayers(r)):"WMTS"===o[0].toUpperCase()&&(r=new M.layer.WMTS({url:o[2],name:o[3],legend:o[1],matrixSet:o[4],transparent:!0,displayInLayerSwitcher:!1,queryable:!1,visibility:!1,format:o[5]}),t.map.addWMTS(r))}else{var i=t.map.getLayers().filter((function(t){return e.includes(t.name)}))[0];r=t.isValidLayer(i)?i:null}if(null!==r)return null===r.getImpl().getOL3Layer()?setTimeout((function(){"WMS"===r.type||"WMTS"===r.type?r.load=!0:"WMTS"===r.type&&(r.facadeLayer_.load=!0)}),1e3):r.load=!0,r.displayInLayerSwitcher=!1,r.setVisible(!1),r.setZIndex(t.lyrsMirrorMinZindex),r;t.layers.remove(e)}),this);return void 0===r[0]?[]:r}},{key:"isValidLayer",value:function(e){return"WMTS"===e.type||"WMS"===e.type}},{key:"equals",value:function(e){return e instanceof i}}])&&F(t.prototype,r),n&&F(t,n),i}(),X=r(0);function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ee(e,t){return(ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ne(e);if(t){var o=ne(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return re(this,r)}}function re(e,t){return!t||"object"!==Y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ee(e,t)}(i,M.Plugin);var t,r,n,o=te(i);function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};$(this,i),(e=o.call(this)).name_="lyrdropdown",e.map_=null,e.controls_=[],e.className="m-plugin-lyrdropdown";var r=["TR","TL","BL","BR"];return e.position=r.includes(t.position)?t.position:"TR",e.collapsed=t.collapsed,void 0===e.collapsed&&(e.collapsed=!0),e.collapsible=t.collapsible,void 0===e.collapsible&&(e.collapsible=!0),e.layers=[],void 0===t.layers?M.dialog.error("No se ha especificado una capa válida sobre la que aplicar el efecto"):Array.isArray(t.layers)?e.layers=t.layers:e.layers=t.layers.split(","),e.lyrsMirrorMinZindex=t.lyrsMirrorMinZindex,void 0===e.lyrsMirrorMinZindex&&(e.lyrsMirrorMinZindex=100),e.tooltip_=t.tooltip||g("tooltip"),e.metadata_=X.metadata,e}return t=i,(r=[{key:"addTo",value:function(e){var t=!!["TL","BL"].includes(this.position);this.control_=new J({pluginOnLeft:t,collapsible:this.collapsible,collapsed:this.collapsed,layers:this.layers,lyrsMirrorMinZindex:this.lyrsMirrorMinZindex}),this.controls_.push(this.control_),this.map_=e,this.panel_=new M.ui.Panel("panelLyrdropdown",{collapsible:this.collapsible,collapsed:this.collapsed,position:M.ui.position[this.position],collapsedButtonClass:"g-cartografia-flecha-izquierda",tooltip:this.tooltip_}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_)}},{key:"destroy",value:function(){this.map_.removeControls([this.control_]);var e=[null,null,null,null,null,null];this.control_=e[0],this.panel_=e[1],this.map_=e[2],this.collapsible=e[3],this.collapsed=e[4],this.layers=e[5]}},{key:"setDisabledLyrs",value:function(e){if(void 0!==this.control_&&null!==this.control_.template)try{var t=null;(t=this.control_.template.querySelector("#m-lyrdropdown-selector")).options[2].disabled=!0;for(var r=1;r<t.options.length;r++)t.options[r].disabled=!e.includes(t.options[r].value)}catch(e){console.log(e)}}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"getAPIRest",value:function(){return"".concat(this.name,"=").concat(this.position,"*").concat(this.collapsible,"*").concat(this.collapsed,"*").concat(this.layers.join(","))}},{key:"activate",value:function(){this.control_.activate()}},{key:"deactivate",value:function(){this.control_.deactivate()}},{key:"equals",value:function(e){return e instanceof i}},{key:"name",get:function(){return this.name_}}])&&Q(t.prototype,r),n&&Q(t,n),i}();function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function le(e,t,r){return(le="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pe(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function se(e,t){return(se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=pe(e);if(t){var o=pe(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ue(this,r)}}function ue(e,t){return!t||"object"!==ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}new M.layer.WMTS({url:"https://servicios.idee.es/wmts/ocupacion-suelo",name:"LC.LandCoverSurfaces",matrixSet:"GoogleMapsCompatible",legend:"CORINE / SIOSE",transparent:!1,displayInLayerSwitcher:!1,queryable:!1,visible:!0,format:"image/png"}),new M.layer.WMTS({url:"https://www.ign.es/wmts/primera-edicion-mtn?",name:"mtn50-edicion1",legend:"MTN50 1Edi",matrixSet:"GoogleMapsCompatible",transparent:!1,displayInLayerSwitcher:!1,queryable:!1,visible:!0,format:"image/jpeg"}),new M.layer.WMTS({url:"https://www.ign.es/wmts/mapa-raster",name:"MTN",matrixSet:"GoogleMapsCompatible",legend:"Mapa MTN",transparent:!1,displayInLayerSwitcher:!1,queryable:!1,visible:!0,format:"image/jpeg"}),new M.layer.WMTS({url:"https://wmts-mapa-lidar.idee.es/lidar",name:"EL.GridCoverageDSM",matrixSet:"GoogleMapsCompatible",legend:"Modelo Digital de Superficies LiDAR",transparent:!0,displayInLayerSwitcher:!1,queryable:!1,visible:!1,format:"image/png"}),new M.layer.XYZ({url:"https://tms-ign-base.idee.es/1.0.0/IGNBaseTodo/{z}/{x}/{-y}.jpeg",projection:"EPSG:3857",transparent:!1,displayInLayerSwitcher:!1,queryable:!1,visible:!0,maxZoom:19}),new M.layer.XYZ({url:"https://tms-pnoa-ma.idee.es/1.0.0/pnoa-ma/{z}/{x}/{-y}.jpeg",projection:"EPSG:3857",transparent:!1,displayInLayerSwitcher:!1,queryable:!1,visible:!0,maxZoom:19}),new M.layer.XYZ({url:"https://tms-ign-base.idee.es/1.0.0/IGNBaseOrto/{z}/{x}/{-y}.png",projection:"EPSG:3857",transparent:!1,displayInLayerSwitcher:!1,queryable:!1,visible:!0,maxZoom:19});var ye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&se(e,t)}(i,M.Control);var t,r,n,o=ce(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),M.utils.isUndefined(x)&&M.exception(g("exception"));var r=new x;return(t=o.call(this,r,"Mirrorpanel")).template=null,t.modeViz=e.modeViz,t.showCursors=e.showCursors,t.mapL={A:null,B:null,C:null,D:null},t.lyrCursor={A:null,B:null,C:null,D:null},t.featureLyrCursor={A:null,B:null,C:null,D:null},t.oldClass="",t.reverseLayout=e.reverseLayout,t.enabledPlugins=e.enabledPlugins,t.backImgLayersConfig=e.backImgLayersConfig,t.styleCursor=new M.style.Point({icon:{form:M.style.form.CIRCLE,fontsize:.5,radius:5,rotation:0,rotate:!1,offset:[0,0],color:"black",fill:"red",gradientcolor:"#088A85",opacity:.8}}),t.defaultBaseLyrs=e.defaultBaseLyrs,t.lyrsMirrorMinZindex=e.lyrsMirrorMinZindex,t.mirrorLayers=e.mirrorLayers,t.lyDropControlA=new oe({position:"TL",collapsible:!1,collapsed:!0,layers:t.defaultBaseLyrs,lyrsMirrorMinZindex:t.lyrsMirrorMinZindex}),t.lyDropControlB=new oe({position:"TL",collapsible:!1,collapsed:!0,layers:t.defaultBaseLyrs,lyrsMirrorMinZindex:t.lyrsMirrorMinZindex}),t.lyDropControlC=new oe({position:"TL",collapsible:!1,collapsed:!0,layers:t.defaultBaseLyrs,lyrsMirrorMinZindex:t.lyrsMirrorMinZindex}),t.lyDropControlD=new oe({position:"TL",collapsible:!1,collapsed:!0,layers:t.defaultBaseLyrs,lyrsMirrorMinZindex:t.lyrsMirrorMinZindex}),t.createMapContainers(),t}return t=i,(r=[{key:"createView",value:function(e){var t=this;return M.template.compileSync||(M.template.compileSync=function(e,t){var r,n={};M.utils.isUndefined(t)||(n=M.utils.extends(n,t.vars),r=t.parseToHtml);var o=Handlebars.compile(e)(n);return!1!==r?M.utils.stringToHtml(o):o}),this.mapL.A=e,this.mirrorLayers.length>0&&(this.mapL.A.addLayers(this.mirrorLayers),this.mapL.A.getLayers().forEach((function(e){0!==e.zindex_&&e.setVisible(!1)})),this.mapL.A.addLayers(this.defaultBaseLyrs[0])),this.showCursors&&this.addLayerCursor("A"),new Promise((function(e,r){var n;n={jsonp:!0,vars:{translations:{titleMirrorpanel:g("titleMirrorpanel"),modViz0:g("modViz0"),modViz1:g("modViz1"),modViz2:g("modViz2"),modViz3:g("modViz3"),modViz4:g("modViz4"),modViz5:g("modViz5"),modViz6:g("modViz6"),modViz7:g("modViz7"),modViz8:g("modViz8"),modViz9:g("modViz9")}}},t.template=M.template.compileSync(j.a,n),t.template.querySelectorAll('button[id^="set-mirror-"]').forEach((function(e,r){e.addEventListener("click",(function(e){t.manageVisionPanelByCSSGrid(r)}))})),e(t.template),t.manageVisionPanelByCSSGrid(t.modeViz)}))}},{key:"activate",value:function(){le(pe(i.prototype),"activate",this).call(this)}},{key:"deactivate",value:function(){this.manageVisionPanelByCSSGrid(0)}},{key:"createMapContainers",value:function(){var e=document.createElement("div");e.id="lienzo",e.classList.add("mirrorpanel-grid");var t=document.getElementById("mapjs")||document.getElementById("map");this.oldClass=t.classList.toString(),t.parentElement.insertBefore(e,t),t.classList.add("mirror1"),e.appendChild(t);var r=document.createElement("div");r.id="mapjsB",r.classList.add("mirror2"),e.appendChild(r);var n=document.createElement("div");n.id="mapjsC",n.classList.add("mirror3"),e.appendChild(n);var o=document.createElement("div");o.id="mapjsD",o.classList.add("mirror4"),e.appendChild(o)}},{key:"manageVisionPanelByCSSGrid",value:function(e){var t=this.modeViz;(document.getElementById("mapjs")||document.getElementById("map")).style.display="none",document.getElementById("mapjsB").style.display="none",document.getElementById("mapjsC").style.display="none",document.getElementById("mapjsD").style.display="none",document.getElementById("lienzo").classList.remove("reverseMirror"),this.template.querySelector("#set-mirror-"+t).classList.remove("buttom-pressed");for(var r=0;r<10;r++)document.getElementById("lienzo").classList.remove("modeViz"+r);if(document.getElementById("lienzo").classList.add("modeViz"+e),this.reverseLayout&&document.getElementById("lienzo").classList.add("reverseMirror"),[1,2].includes(e)&&null===this.mapL.B&&this.createMapObjects("B"),[3,7,8,9].includes(e)&&(null===this.mapL.B&&this.createMapObjects("B"),null===this.mapL.C&&this.createMapObjects("C")),[4,5,6].includes(e)&&(null===this.mapL.B&&this.createMapObjects("B"),null===this.mapL.C&&this.createMapObjects("C"),null===this.mapL.D&&this.createMapObjects("D")),0===e){var n=this.map_.getPlugins().filter((function(e){return"lyrdropdown"===e.name}));n.length>0&&(this.lyDropControlA.deactivate(),this.map_.removePlugins(n))}else this.lyDropControlA=new oe({position:"TL",collapsible:!1,collapsed:!0,layers:this.defaultBaseLyrs,lyrsMirrorMinZindex:this.lyrsMirrorMinZindex}),this.mapL.A.addPlugin(this.lyDropControlA);this.modeViz=e,this.template.querySelector("#set-mirror-"+e).classList.add("buttom-pressed"),this.map_.refresh(),null!==this.mapL.B&&this.mapL.B.refresh(),null!==this.mapL.C&&this.mapL.C.refresh(),null!==this.mapL.D&&this.mapL.D.refresh(),document.querySelector("#m-cp-mirrorpanel-btn").classList.remove("active"),document.querySelector(".m-panel-controls .cp-mirrorpanel").classList.remove("hide-panel")}},{key:"createMapObjects",value:function(e){var t=this,r=null,n=null,o=null;if(this.mapL[e]=M.map({container:"mapjs"+e,center:this.map_.getCenter(),projection:this.map_.getProjection().code+"*"+this.map_.getProjection().units,zoom:this.map_.getZoom()}),this.mapL[e].getMapImpl().setView(this.map_.getMapImpl().getView()),this.enabledPlugins){var i=this.map_.getControls(),a=this.map_.getPlugins();i.forEach((function(r){"backgroundlayers"===r.name&&t.mapL[e].addControls(["backgroundlayers"])})),a.forEach((function(t){t.metadata_&&("FullTOC"===t.metadata_.name&&(r=new M.plugin.FullTOC({position:t.position,collapsed:t.collapsed,collapsible:t.collapsible,http:t.http,https:t.https,precharged:t.precharged})),"Vectors"===t.metadata_.name&&(o=new M.plugin.Vectors({position:t.position,collapsed:t.collapsed,collapsible:t.collapsible})),"backimglayer"===t.metadata_.name&&(n=new M.plugin.BackImgLayer({layerId:"A"===e?0:"B"===e?1:"C"==e?2:3,layerVisibility:t.layerVisibility,columnsNumber:t.columnsNumber,layerOpts:t.layerOpts})))}))}null!==this.lyDropControl&&("B"===e&&this.mapL[e].addPlugin(this.lyDropControlB),"C"===e&&this.mapL[e].addPlugin(this.lyDropControlC),"D"===e&&this.mapL[e].addPlugin(this.lyDropControlD)),null!==r&&this.mapL[e].addPlugin(r),null!==o&&this.mapL[e].addPlugin(o),null!==n&&this.mapL[e].addPlugin(n),this.showCursors&&this.addLayerCursor(e),this.mapL[e].refresh()}},{key:"addLayerCursor",value:function(e){var t=this;this.lyrCursor[e]=new M.layer.Vector({name:"Coordenadas centro "+e},{displayInLayerSwitcher:!1}),this.featureLyrCursor[e]=new M.Feature("Center"+e,{type:"Feature",properties:{},geometry:{type:"Point",coordinates:this.mapL[e].getCenter()}}),this.lyrCursor[e].addFeatures([this.featureLyrCursor[e]]),this.lyrCursor[e].setStyle(this.styleCursor),this.lyrCursor[e].setZIndex(5e3),this.mapL[e].addLayers(this.lyrCursor[e]),this.mapL[e].getMapImpl().on("pointermove",(function(r){t.lyrCursor[e].setVisible(!1),Object.keys(t.featureLyrCursor).forEach((function(n){n!=e&&null!==t.featureLyrCursor[n]&&(t.lyrCursor[n].setVisible(!0),t.featureLyrCursor[n].setGeometry({type:"Point",coordinates:r.coordinate}))}))}))}},{key:"manageLyrAvailable",value:function(e){null!==this.lyDropControlA.control_&&this.lyDropControlA.setDisabledLyrs(e),null!==this.lyDropControlB.control_&&this.lyDropControlB.setDisabledLyrs(e),null!==this.lyDropControlC.control_&&this.lyDropControlC.setDisabledLyrs(e),null!==this.lyDropControlD.control_&&this.lyDropControlD.setDisabledLyrs(e)}},{key:"removeMaps",value:function(){this.mapL.B=null,this.mapL.C=null,this.mapL.D=null}},{key:"destroyMapsContainer",value:function(){this.manageVisionPanelByCSSGrid(0),document.getElementById("mapjsB").remove(),document.getElementById("mapjsC").remove(),document.getElementById("mapjsD").remove();var e=document.getElementById("lienzo"),t=document.querySelector(".mirror1");e.parentElement.insertBefore(t,e),t.style.display="block",t.classList.remove("mirror1"),t.classList=this.oldClass,document.getElementById("lienzo").remove()}},{key:"equals",value:function(e){return e instanceof i}}])&&ae(t.prototype,r),n&&ae(t,n),i}();function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ge(e);if(t){var o=ge(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return be(this,r)}}function be(e,t){return!t||"object"!==de(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _e=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(i,M.Plugin);var t,r,n,o=ve(i);function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return me(this,i),(e=o.call(this)).name_="mirrorpanel",e.map_=null,e.controls_=[],e.className="m-plugin-mirrorpanel",e.position=t.position,e.collapsed=!0,e.collapsible=!0,e.modeViz=t.modeViz,void 0===e.modeViz&&(e.modeViz=0),e.reverseLayout=t.reverseLayout,void 0===e.reverseLayout&&(e.reverseLayout=!1),e.enabledPlugins=t.enabledPlugins,void 0===e.enabledPlugins&&(e.enabledPlugins=!1),e.enabledKeyFunctions=t.enabledKeyFunctions,void 0===e.enabledKeyFunctions&&(e.enabledKeyFunctions=!0),e.showCursors=t.showCursors,void 0===e.showCursors&&(e.showCursors=!0),e.mirrorLayers=[],void 0!==t.mirrorLayers&&(Array.isArray(t.mirrorLayers)?e.mirrorLayers=t.mirrorLayers:e.mirrorLayers=t.mirrorLayers.split(",")),e.lyrsMirrorMinZindex=t.lyrsMirrorMinZindex,void 0===e.lyrsMirrorMinZindex&&(e.lyrsMirrorMinZindex=100),e.defaultBaseLyrs=[],void 0!==t.defaultBaseLyrs&&(Array.isArray(t.defaultBaseLyrs)?e.defaultBaseLyrs=t.defaultBaseLyrs:e.defaultBaseLyrs=t.defaultBaseLyrs.split(",")),e.backImgLayersConfig=t.backImgLayersConfig,e.interface=void 0===t.interface||t.interface,e.tooltip_=t.tooltip||g("tooltip"),e.metadata_=X.metadata,e}return t=i,(r=[{key:"addTo",value:function(e){var t=this,r={pluginOnLeft:!!["TL","BL"].includes(this.position),collapsible:this.collapsible,collapsed:this.collapsed,modeViz:this.modeViz,reverseLayout:this.reverseLayout,enabledPlugins:this.enabledPlugins,showCursors:this.showCursors,mirrorLayers:this.mirrorLayers,defaultBaseLyrs:this.defaultBaseLyrs,lyrsMirrorMinZindex:this.lyrsMirrorMinZindex,backImgLayersConfig:this.backImgLayersConfig};this.control_=new ye(r),this.controls_.push(this.control_),this.map_=e,this.panel_=new M.ui.Panel("panelMirrorpanel",{collapsible:this.collapsible,collapsed:this.collapsed,position:M.ui.position[this.position],modeViz:this.modeViz,showCursors:this.showCursors,className:this.interface?"m-plugin-panelMirrorpanel":"m-plugin-panelMirrorpanel hidden",collapsedButtonClass:"mirrorpanel-icon",tooltip:this.tooltip_,lyrsMirrorMinZindex:this.lyrsMirrorMinZindex}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_),document.addEventListener("keydown",(function(e){if(t.enabledKeyFunctions){for(var r=0;r<10;r++)e.ctrlKey&&e.shiftKey&&e.key==="F"+(r+1)&&t.control_.manageVisionPanelByCSSGrid(r);var n=["Control","Shift","Alt","Meta"].includes(e.key)?"":e.key;"Escape"==(e.ctrlKey?"Control ":"")+(e.shiftKey?"Shift ":"")+(e.altKey?"Alt ":"")+(e.metaKey?"Meta ":"")+n&&t.control_.manageVisionPanelByCSSGrid(0)}}))}},{key:"destroy",value:function(){document.removeEventListener("keydown",(function(e){})),this.control_.removeMaps(),this.control_.destroyMapsContainer(),this.map_.removeControls([this.control_]);var e=[null,null,null,null,null,null,null,null,null,null,null,null,null];this.control_=e[0],this.panel_=e[1],this.map_=e[2],this.collapsible=e[3],this.collapsed=e[4],this.modeViz=e[5],this.enabledPlugins=e[6],this.enabledKeyFunctions=e[7],this.showCursors=e[8],this.mirrorLayers=e[9],this.defaultBaseLyrs=e[10],this.backImgLayersParams=e[11],this.interface=e[12]}},{key:"manageLyrAvailable",value:function(e){this.control_.manageLyrAvailable(e)}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"activate",value:function(){this.control_.activate()}},{key:"deactivate",value:function(){this.control_.deactivate()}},{key:"name",get:function(){return this.name_}}])&&fe(t.prototype,r),n&&fe(t,n),i}();r(12);function Se(e){return(Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Me(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function we(e,t,r){return(we="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ke(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ke(e);if(t){var o=ke(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Oe(this,r)}}function Oe(e,t){return!t||"object"!==Se(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}(i,M.impl.Control);var t,r,n,o=Pe(i);function i(){return Le(this,i),o.apply(this,arguments)}return t=i,(r=[{key:"addTo",value:function(e,t){this.map=e,this.olMap=e.getMapImpl(),we(ke(i.prototype),"addTo",this).call(this,e,t)}}])&&Me(t.prototype,r),n&&Me(t,n),i}(),Re=r(6),je=r.n(Re);function qe(e){return(qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function De(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ae(e);if(t){var o=Ae(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ee(this,r)}}function Ee(e,t){return!t||"object"!==qe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ae(e){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(i,M.Control);var t,r,n,o=Ve(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),M.utils.isUndefined(xe)&&M.exception(g("exception"));var r=new xe;return(t=o.call(this,r,"Timeline")).running=!1,t.animationFrame=0,t.animation=e.animation,t.speed=e.speed,t.intervals=e.intervals,t.template=null,t}return t=i,(r=[{key:"createView",value:function(e){var t=this;return this.map=e,new Promise((function(e,r){var n=[];t.intervals.forEach((function(e,r){var o=t.transformToLayers(e[2]),i=t.getMapLayer(o);void 0!==i&&t.map.removeLayers(i),t.map.addLayers(o);var a={number:r,name:e[0],tag:e[1],service:o};n.push(a)})),t.intervals=n,t.template=M.template.compileSync(je.a,{vars:{translations:{titleTimeline:g("titleTimeline"),play:g("play")}}}),t.intervals.forEach((function(e,r){var n=document.createElement("div");0!=r&&r!=t.intervals.length-1&&r!=parseInt(t.intervals.length/2)?n.dataset.tag="":n.dataset.tag=e.tag,t.template.querySelector(".slider-tags").append(n)})),t.template.querySelector(".div-m-timeline-panel").style.setProperty("--num",t.intervals.length);var o=t.template.querySelector("#input-slider");o.setAttribute("max",n.length-1),o.addEventListener("input",(function(e){return t.changeSlider(o)})),o.addEventListener("change",(function(e){document.querySelector(".m-timeline-button button").classList.add("cp-control-siguiente"),document.querySelector(".m-timeline-button button").classList.remove("cp-control-pausa"),document.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","0"),clearTimeout(t.running),t.running=!1})),t.template.querySelector("#m-timeline-play").addEventListener("click",(function(e){t.running=!t.running,t.running&&t.playTimeline(t.running)})),e(t.template)}))}},{key:"transformToLayers",value:function(e){var t=null;if(e instanceof Object){if(e instanceof Object){var r=this.map.getLayers().filter((function(t){return e.name.includes(t.name)}))[0];t=this.isValidLayer(r)?r:null}}else if(e.indexOf("*")>=0){var n=e.split("*");"WMS"===n[0].toUpperCase()?t=new M.layer.WMS({url:n[2],name:n[3]}):"WMTS"===n[0].toUpperCase()&&(t=new M.layer.WMTS({url:n[2],name:n[3],legend:n[1],matrixSet:n[4],format:n[5]}))}else{var o=this.map.getLayers().filter((function(t){return e.includes(t.name)}))[0];t=this.isValidLayer(o)?o:null}if(null!==t)return t.displayInLayerSwitcher=!1,t.setVisible(!1),t;this.map.removeLayers(e)}},{key:"changeSlider",value:function(e){var t=this;document.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","0");var r=(e.value-e.min)/(e.max-e.min)*246+5;document.querySelector(".div-m-timeline-slider").style.setProperty("--left",r+"px"),(this.animation||""!==this.intervals[0].name)&&(document.querySelector(".m-timeline-names").style.display="block"),this.animation&&(document.querySelector(".m-timeline-button").style.display="block");var n=parseFloat(e.value);this.intervals.forEach((function(e){t.getMapLayer(e.service).setVisible(!1),document.querySelector(".m-timeline-names").innerHTML=""})),n%1==0?(document.querySelector(".div-m-timeline-slider").style.setProperty("--left",r+20+"px"),this.getMapLayer(this.intervals[n].service).setVisible(!0),document.querySelector(".m-timeline-names").innerHTML=this.intervals[n].name,document.querySelector(".div-m-timeline-panel").style.setProperty("--valor",'"'+this.intervals[n].tag+'"'),""!==this.intervals[n].tag?document.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","1"):document.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","0")):(this.getMapLayer(this.intervals[parseInt(n)].service).setVisible(!0),this.getMapLayer(this.intervals[parseInt(n)+1].service).setVisible(!0),""!==this.intervals[parseInt(n)].tag&&""!==this.intervals[parseInt(n)+1].tag?(document.querySelector(".div-m-timeline-slider").style.setProperty("--left",r+"px"),document.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","1"),document.querySelector(".div-m-timeline-panel").style.setProperty("--valor",'"'+this.intervals[parseInt(n)].tag+" - "+this.intervals[parseInt(n)+1].tag+'"'),document.querySelector(".m-timeline-names").innerHTML=this.intervals[parseInt(n)].name+" y "+this.intervals[parseInt(n)+1].name):""===this.intervals[parseInt(n)].tag&&""===this.intervals[parseInt(n)+1].tag?document.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","0"):(document.querySelector(".div-m-timeline-slider").style.setProperty("--left",r+20+"px"),document.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","10"),document.querySelector(".m-timeline-names").innerHTML=this.intervals[parseInt(n)].name+this.intervals[parseInt(n)+1].name,document.querySelector(".div-m-timeline-panel").style.setProperty("--valor",'"'+this.intervals[parseInt(n)].tag+this.intervals[parseInt(n)+1].tag+'"')))}},{key:"getMapLayer",value:function(e){return this.map.getLayers().filter((function(t){return t.getImpl().legend===e.getImpl().legend}))[0]}},{key:"setDefaultLayer",value:function(e){var t=this,r=t.template,n=r.querySelector("#input-slider"),o=e<t.intervals.length?e:0;n.value=o,r.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","0");var i=(n.value-n.min)/(n.max-n.min)*246+5;r.querySelector(".div-m-timeline-slider").style.setProperty("--left",i+"px"),(t.animation||""!==t.intervals[0].name)&&(r.querySelector(".m-timeline-names").style.display="block"),t.animation&&(r.querySelector(".m-timeline-button").style.display="block");var a=parseFloat(n.value);t.intervals.forEach((function(e){t.getMapLayer(e.service).setVisible(!1),r.querySelector(".m-timeline-names").innerHTML=""})),r.querySelector(".div-m-timeline-slider").style.setProperty("--left",i+20+"px"),t.getMapLayer(t.intervals[a].service).setVisible(!0),r.querySelector(".m-timeline-names").innerHTML=t.intervals[a].name,r.querySelector(".div-m-timeline-panel").style.setProperty("--valor",'"'+t.intervals[a].tag+'"'),""!==t.intervals[a].tag?r.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","1"):r.querySelector(".div-m-timeline-slider").style.setProperty("--opacity","0")}},{key:"playTimeline",value:function(e){var t=this,r=this.intervals.length-1,n=document.querySelector("#input-slider"),o=parseInt(n.value);if(this.running?(document.querySelector(".m-timeline-button button").classList.remove("cp-control-siguiente"),document.querySelector(".m-timeline-button button").classList.add("cp-control-pausa")):(document.querySelector(".m-timeline-button button").classList.add("cp-control-siguiente"),document.querySelector(".m-timeline-button button").classList.remove("cp-control-pausa"),clearTimeout(this.running)),!e){if(o>0&&o<r&&this.running)return void(this.running=!1);o>r&&(o=0)}if(o>=r)return n.value=0,this.changeSlider(n),document.querySelector(".m-timeline-button button").classList.add("cp-control-siguiente"),document.querySelector(".m-timeline-button button").classList.remove("cp-control-pausa"),void(this.running=!1);o<0&&(o=0),this.running&&(n.value=parseFloat(n.value)+1,this.changeSlider(n),this.animationFrame=setTimeout((function(e){return t.playTimeline(!0)}),1e3*this.speed))}},{key:"removeTimelineLayers",value:function(){var e=this;clearInterval(this.running),this.intervals.forEach((function(t){e.map.removeLayers(e.getMapLayer(t.service))}))}},{key:"activate",value:function(){clearInterval(this.running),this.running=!1,document.querySelector(".m-timeline-button button").classList.add("cp-control-siguiente"),document.querySelector(".m-timeline-button button").classList.remove("cp-control-pausa")}},{key:"deactivate",value:function(){var e=this;try{clearInterval(this.running),this.running=!1,this.intervals.forEach((function(t){void 0!==t.service.zIndex_&&e.getMapLayer(t.service).setVisible(!1)}))}catch(e){console.error("e2m (1): ".concat(e))}}},{key:"equals",value:function(e){return e instanceof i}}])&&De(t.prototype,r),n&&De(t,n),i}();function ze(e){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ze(e,t){return(Ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function We(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ke(e);if(t){var o=Ke(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Fe(this,r)}}function Fe(e,t){return!t||"object"!==ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ze(e,t)}(i,M.Plugin);var t,r,n,o=We(i);function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Be(this,i),(e=o.call(this)).name_="timeline",e.map_=null,e.controls_=[],e.className="m-plugin-timeline",e.position=t.position,void 0!==t&&(M.utils.isString(t.intervals)?e.intervals=JSON.parse(t.intervals.replace(/!!/g,"[").replace(/¡¡/g,"]")):M.utils.isArray(t.intervals)?e.intervals=t.intervals:M.dialog.error(g("intervals_error"))),e.animation=t.animation,void 0===e.animation&&(e.animation=!0),e.speed=parseFloat(t.speed)||1,e.metadata_=X.metadata,e.tooltip_=t.tooltip||g("tooltip"),e}return t=i,(r=[{key:"addTo",value:function(e){this.control_=new Ie({intervals:this.intervals,animation:this.animation,speed:this.speed}),this.controls_.push(this.control_),this.map_=e,this.panel_=new M.ui.Panel("panelTimeline",{collapsible:!0,position:M.ui.position[this.position],className:this.className,collapsedButtonClass:"timeline-gestion-reloj2",tooltip:this.tooltip_}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_)}},{key:"destroy",value:function(){this.control_.removeTimelineLayers(),this.map_.removeControls([this.control_]);var e=[null,null,null,null,null];this.control_=e[0],this.panel_=e[1],this.map_=e[2],this.layers=e[3],this.radius=e[4]}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"activate",value:function(){this.control_.activate()}},{key:"setDefaultLayer",value:function(e){this.control_.setDefaultLayer(e)}},{key:"deactivate",value:function(){this.control_.deactivate()}},{key:"equals",value:function(e){return e instanceof i}},{key:"name",get:function(){return this.name_}}])&&Ne(t.prototype,r),n&&Ne(t,n),i}();r(13);function Ge(e){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function He(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Je(e,t,r){return(Je="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=et(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function Xe(e,t){return(Xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=et(e);if(t){var o=et(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return $e(this,r)}}function $e(e,t){return!t||"object"!==Ge(t)&&"function"!=typeof t?Qe(e):t}function Qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function et(e){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xe(e,t)}(i,ol.interaction.Pointer);var t,r,n,o=Ye(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).layers_=[],t.swipeClicked=!1,ol.interaction.Pointer.call(Qe(t),{handleDownEvent:t.setPosition,handleUpEvent:function(){return t.swipeClicked=!1},handleMoveEvent:t.setPosition});var r=e||{};t.pos=!1,t.opacityVal=r.opacityVal||100,t.OLVersion="OL6";var n=[r.lyrA].map((function(e){return e.getImpl().getOL3Layer()})).filter((function(e){return null!=e}));t.addLayerA(n);var a=[r.lyrB].map((function(e){return e.getImpl().getOL3Layer()})).filter((function(e){return null!=e}));if(t.addLayerB(a),void 0!==r.lyrC&&void 0!==r.lyrD){var l=[r.lyrC].map((function(e){return e.getImpl().getOL3Layer()})).filter((function(e){return null!=e}));t.addLayerC(l);var s=[r.lyrD].map((function(e){return e.getImpl().getOL3Layer()})).filter((function(e){return null!=e}));t.addLayerD(s)}return t}return t=i,(r=[{key:"setMap",value:function(e){if(this.getMap()){for(var t=0;t<this.layers_.length;t+=1)"OL6"===this.OLVersion?(this.layers_[t].prerender&&ol.Observable.unByKey(this.layers_[t].prerender),this.layers_[t].postrender&&ol.Observable.unByKey(this.layers_[t].postrender),this.layers_[t].prerender=this.layers_[t].postrender=null):(this.layers_[t].precompose&&ol.Observable.unByKey(this.layers_[t].precompose),this.layers_[t].postcompose&&ol.Observable.unByKey(this.layers_[t].postcompose),this.layers_[t].precompose=this.layers_[t].postcompose=null);this.getMap().renderSync()}ol.interaction.Pointer.prototype.setMap.call(this,e),e&&(this.createSwipeControl(),"OL6"===this.OLVersion?(void 0!==this.layers_[0]&&(this.layers_[0].prerender=this.layers_[0].on("prerender",this.precomposeA_.bind(this)),this.layers_[0].postrender=this.layers_[0].on("postrender",this.postcomposeA_.bind(this))),void 0!==this.layers_[1]&&(this.layers_[1].prerender=this.layers_[1].on("prerender",this.precomposeB_.bind(this)),this.layers_[1].postrender=this.layers_[1].on("postrender",this.postcomposeB_.bind(this))),void 0!==this.layers_[2]&&(this.layers_[2].prerender=this.layers_[2].on("prerender",this.precomposeC_.bind(this)),this.layers_[2].postrender=this.layers_[2].on("postrender",this.postcomposeC_.bind(this))),void 0!==this.layers_[3]&&(this.layers_[3].prerender=this.layers_[3].on("prerender",this.precomposeD_.bind(this)),this.layers_[3].postrender=this.layers_[3].on("postrender",this.postcomposeD_.bind(this)))):(this.layers_[0].precompose=this.layers_[0].on("precompose",this.precomposeA_.bind(this)),this.layers_[0].postcompose=this.layers_[0].on("postcompose",this.postcomposeA_.bind(this)),this.layers_[1].precompose=this.layers_[1].on("precompose",this.precomposeB_.bind(this)),this.layers_[1].postcompose=this.layers_[1].on("postcompose",this.postcomposeB_.bind(this)),void 0!==this.layers_[2]&&void 0!==this.layers_[3]&&(this.layers_[2].precompose=this.layers_[2].on("precompose",this.precomposeC_.bind(this)),this.layers_[2].postcompose=this.layers_[2].on("postcompose",this.postcomposeC_.bind(this)),this.layers_[3].precompose=this.layers_[3].on("precompose",this.precomposeD_.bind(this)),this.layers_[3].postcompose=this.layers_[3].on("postcompose",this.postcomposeD_.bind(this)))),e.renderSync())}},{key:"setOpacity",value:function(e){if(this.opacityVal=e,this.getMap())for(var t=0;t<this.layers_.length;t+=1)void 0!==this.layers_[t]&&this.layers_[t].setOpacity(this.opacityVal/100)}},{key:"setStaticDivision",value:function(e){this.staticDivision=e,this.updatePosition()}},{key:"setComparisonMode",value:function(e){this.comparisonMode=e,this.updatePosition()}},{key:"setVisibilityLayersCD",value:function(){void 0===this.layers_[2]||void 0===this.layers_[3]||1!==this.comparisonMode&&2!==this.comparisonMode?void 0!==this.layers_[2]&&void 0!==this.layers_[3]&&(this.layers_[2].setVisible(!0),this.layers_[3].setVisible(!0)):(this.layers_[2].setVisible(!1),this.layers_[3].setVisible(!1))}},{key:"addLayerA",value:function(e){e instanceof Array||(e=[e]);var t={layer:e[0]};this.getMap()&&(t.prerender=e[0].on("prerender",this.precomposeA_.bind(this)),t.postrender=e[0].on("postrender",this.postcomposeA_.bind(this)),this.getMap().renderSync()),this.layers_.push(e[0])}},{key:"addLayerB",value:function(e){e instanceof Array||(e=[e]);var t={layer:e[0]};this.getMap()&&(t.prerender=e[0].on("prerender",this.precomposeB_.bind(this)),t.postrender=e[0].on("postrender",this.postcomposeB_.bind(this)),this.getMap().renderSync()),this.layers_.push(e[0])}},{key:"addLayerC",value:function(e){e instanceof Array||(e=[e]);var t={layer:e[0]};this.getMap()&&(t.prerender=e[0].on("prerender",this.precomposeC_.bind(this)),t.postrender=e[0].on("postrender",this.postcomposeC_.bind(this)),this.getMap().renderSync()),this.layers_.push(e[0])}},{key:"addLayerD",value:function(e){e instanceof Array||(e=[e]);var t={layer:e[0]};this.getMap()&&(t.prerender=e[0].on("prerender",this.precomposeD_.bind(this)),t.postrender=e[0].on("postrender",this.postcomposeD_.bind(this)),this.getMap().renderSync()),this.layers_.push(e[0])}},{key:"removeLayer",value:function(e){e instanceof Array||(e=[e]);for(var t=0;t<e.length;t+=1){var r=void 0;for(r=0;r<this.layers_.length&&this.layers_[r]!==e[t];r+=1);r!==this.layers_.length&&this.getMap()&&(this.layers_[r].prerender&&ol.Observable.unByKey(this.layers_[r].prerender),this.layers_[r].postrender&&ol.Observable.unByKey(this.layers_[r].postrender),this.layers_.splice(r,1),this.getMap().renderSync())}}},{key:"setPosition",value:function(e){if(2===this.staticDivision&&this.swipeClicked||2!==this.staticDivision){if(e.pixel?this.pos=e.pixel:e&&e instanceof Array?this.pos=e:e=[-1e7,-1e7],2===this.staticDivision&&1!==e.pointerEvent.buttons){var t=this.map_.getSize();this.pos=[t[0]/2,t[1]/2],this.swipeClicked=!1}this.getMap()&&this.getMap().renderSync(),this.moveSwipeControl()}}},{key:"updatePosition",value:function(){var e=document.querySelector(".lyrcompare-swipe-control");if(e&&(1===this.comparisonMode?e.classList="lyrcompare-swipe-control vertical"+(1===this.staticDivision?" static":" dynamic"):2===this.comparisonMode?e.classList="lyrcompare-swipe-control horizontal"+(1===this.staticDivision?" static":" dynamic"):3===this.comparisonMode&&(e.classList="lyrcompare-swipe-control vertical horizontal"+(1===this.staticDivision?" static":" dynamic"))),this.getMap()){var t=this.map_.getSize();e.style.left=t[0]/2-e.offsetWidth/2+"px",e.style.top=t[1]/2-e.offsetHeight/2+"px",this.pos=[t[0]/2,t[1]/2],this.swipeClicked=!1,this.getMap().renderSync()}}},{key:"precomposeA_",value:function(e){var t,r,n,o,i=e.context,a=(e.frameState.pixelRatio,this.map_.getSize()),l=this.pos[0],s=this.pos[1];i.save(),i.beginPath(),1===this.staticDivision?1===this.comparisonMode?(t=ol.render.getRenderPixel(e,[0,0]),r=ol.render.getRenderPixel(e,[a[0]/2,0]),n=ol.render.getRenderPixel(e,[a[0]/2,a[1]]),o=ol.render.getRenderPixel(e,[0,a[1]])):2===this.comparisonMode?(t=ol.render.getRenderPixel(e,[0,0]),r=ol.render.getRenderPixel(e,[a[0],0]),n=ol.render.getRenderPixel(e,[a[0],a[1]/2]),o=ol.render.getRenderPixel(e,[0,a[1]/2])):3===this.comparisonMode&&(t=ol.render.getRenderPixel(e,[0,0]),r=ol.render.getRenderPixel(e,[a[0]/2,0]),n=ol.render.getRenderPixel(e,[a[0]/2,a[1]/2]),o=ol.render.getRenderPixel(e,[0,a[1]/2])):1===this.comparisonMode?(t=ol.render.getRenderPixel(e,[0,0]),r=ol.render.getRenderPixel(e,[l,0]),n=ol.render.getRenderPixel(e,[l,a[1]]),o=ol.render.getRenderPixel(e,[0,a[1]])):2===this.comparisonMode?(t=ol.render.getRenderPixel(e,[0,0]),r=ol.render.getRenderPixel(e,[a[0],0]),n=ol.render.getRenderPixel(e,[a[0],s]),o=ol.render.getRenderPixel(e,[0,s])):3===this.comparisonMode&&(t=ol.render.getRenderPixel(e,[0,0]),r=ol.render.getRenderPixel(e,[l,0]),n=ol.render.getRenderPixel(e,[l,s]),o=ol.render.getRenderPixel(e,[0,s])),void 0!==t&&(i.moveTo(t[0],t[1]),i.lineTo(o[0],o[1]),i.lineTo(n[0],n[1]),i.lineTo(r[0],r[1]),i.closePath()),i.clip()}},{key:"postcomposeA_",value:function(e){e.context.restore()}},{key:"precomposeB_",value:function(e){var t,r,n,o,i=e.context,a=(e.frameState.pixelRatio,this.map_.getSize()),l=this.pos[0],s=this.pos[1];i.save(),i.beginPath(),1===this.staticDivision?1===this.comparisonMode?(t=ol.render.getRenderPixel(e,[a[0]/2,0]),r=ol.render.getRenderPixel(e,[a[0],0]),n=ol.render.getRenderPixel(e,[a[0],a[1]]),o=ol.render.getRenderPixel(e,[a[0]/2,a[1]])):2===this.comparisonMode?(t=ol.render.getRenderPixel(e,[0,a[1]/2]),r=ol.render.getRenderPixel(e,[a[0],a[1]/2]),n=ol.render.getRenderPixel(e,[a[0],a[1]]),o=ol.render.getRenderPixel(e,[0,a[1]])):3===this.comparisonMode&&(t=ol.render.getRenderPixel(e,[a[0]/2,0]),r=ol.render.getRenderPixel(e,[a[0],0]),n=ol.render.getRenderPixel(e,[a[0],a[1]/2]),o=ol.render.getRenderPixel(e,[a[0]/2,a[1]/2])):1===this.comparisonMode?(t=ol.render.getRenderPixel(e,[l,0]),r=ol.render.getRenderPixel(e,[a[0],0]),n=ol.render.getRenderPixel(e,[a[0],a[1]]),o=ol.render.getRenderPixel(e,[l,a[1]])):2===this.comparisonMode?(t=ol.render.getRenderPixel(e,[0,s]),r=ol.render.getRenderPixel(e,[a[0],s]),n=ol.render.getRenderPixel(e,[a[0],a[1]]),o=ol.render.getRenderPixel(e,[0,a[1]])):3===this.comparisonMode&&(t=ol.render.getRenderPixel(e,[l,0]),r=ol.render.getRenderPixel(e,[a[0],0]),n=ol.render.getRenderPixel(e,[a[0],s]),o=ol.render.getRenderPixel(e,[l,s])),void 0!==t&&(i.moveTo(t[0],t[1]),i.lineTo(o[0],o[1]),i.lineTo(n[0],n[1]),i.lineTo(r[0],r[1]),i.closePath()),i.clip()}},{key:"postcomposeB_",value:function(e){e.context.restore()}},{key:"precomposeC_",value:function(e){var t,r,n,o,i=e.context,a=(e.frameState.pixelRatio,this.map_.getSize()),l=this.pos[0],s=this.pos[1];i.save(),i.beginPath(),1===this.staticDivision?3===this.comparisonMode&&(t=ol.render.getRenderPixel(e,[0,a[1]/2]),r=ol.render.getRenderPixel(e,[a[0]/2,a[1]/2]),n=ol.render.getRenderPixel(e,[a[0]/2,a[1]]),o=ol.render.getRenderPixel(e,[0,a[1]])):3===this.comparisonMode&&(t=ol.render.getRenderPixel(e,[0,s]),r=ol.render.getRenderPixel(e,[l,s]),n=ol.render.getRenderPixel(e,[l,a[1]]),o=ol.render.getRenderPixel(e,[0,a[1]])),void 0!==t&&(i.moveTo(t[0],t[1]),i.lineTo(o[0],o[1]),i.lineTo(n[0],n[1]),i.lineTo(r[0],r[1]),i.closePath()),i.clip()}},{key:"postcomposeC_",value:function(e){e.context.restore()}},{key:"precomposeD_",value:function(e){var t,r,n,o,i=e.context,a=(e.frameState.pixelRatio,this.map_.getSize()),l=this.pos[0],s=this.pos[1];i.save(),i.beginPath(),1===this.staticDivision?3===this.comparisonMode&&(t=ol.render.getRenderPixel(e,[a[0]/2,a[1]/2]),r=ol.render.getRenderPixel(e,[a[0],a[1]/2]),n=ol.render.getRenderPixel(e,[a[0],a[1]]),o=ol.render.getRenderPixel(e,[a[0]/2,a[1]])):3===this.comparisonMode&&(t=ol.render.getRenderPixel(e,[l,s]),r=ol.render.getRenderPixel(e,[a[0],s]),n=ol.render.getRenderPixel(e,[a[0],a[1]]),o=ol.render.getRenderPixel(e,[l,a[1]])),void 0!==t&&(i.moveTo(t[0],t[1]),i.lineTo(o[0],o[1]),i.lineTo(n[0],n[1]),i.lineTo(r[0],r[1]),i.closePath()),i.clip()}},{key:"postcomposeD_",value:function(e){e.context.restore()}},{key:"createSwipeControl",value:function(){var e,t,r=this;null===document.querySelector(".lyrcompare-swipe-control")?((e=document.createElement("div")).classList.add("lyrcompare-swipe-control"),(t=document.createElement("div")).classList.add("control-icon"),e.append(t),document.querySelector(".ol-overlaycontainer-stopevent").append(e)):(e=document.querySelector(".lyrcompare-swipe-control"),t=document.querySelector(".lyrcompare-swipe-control .control-icon")),e.addEventListener("mousedown",(function(){return r.swipeClicked=!0})),e.addEventListener("mouseup",(function(){return r.swipeClicked=!1})),e.addEventListener("touchstart",(function(){return r.swipeClicked=!0})),e.addEventListener("touchend",(function(){return r.swipeClicked=!1})),this.updatePosition()}},{key:"moveSwipeControl",value:function(){var e=this.map_.getSize(),t=document.querySelector(".lyrcompare-swipe-control");t&&this.getMap()&&(0===this.staticDivision||2===this.staticDivision?1===this.comparisonMode?(t.style.top=e[1]/2-t.offsetHeight/2+"px",t.style.left=this.pos[0]-t.offsetWidth/2+"px"):2===this.comparisonMode?(t.style.left=e[0]/2-t.offsetWidth/2+"px",t.style.top=this.pos[1]-t.offsetHeight/2+"px"):3===this.comparisonMode&&(t.style.left=this.pos[0]-t.offsetWidth/2+"px",t.style.top=this.pos[1]-t.offsetHeight/2+"px"):(t.style.left=e[0]/2-t.offsetWidth/2+"px",t.style.top=e[1]/2-t.offsetHeight/2+"px"))}},{key:"setActive",value:function(e){Je(et(i.prototype),"setActive",this).call(this,e)}}])&&He(t.prototype,r),n&&He(t,n),i}();function rt(e){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ot(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function it(e,t,r){return(it="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ct(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function at(e,t){return(at=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ct(e);if(t){var o=ct(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return st(this,r)}}function st(e,t){return!t||"object"!==rt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ut=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&at(e,t)}(i,M.impl.Control);var t,r,n,o=lt(i);function i(){return nt(this,i),o.apply(this,arguments)}return t=i,(r=[{key:"addTo",value:function(e,t){this.map=e,this.olMap=e.getMapImpl(),it(ct(i.prototype),"addTo",this).call(this,e,t)}},{key:"effectSelectedCurtain",value:function(e,t,r,n,o,i,a){e.setVisible(!0),t.setVisible(!0),this.transparentInteraction_=new tt({opacityVal:o,lyrA:e,lyrB:t,lyrC:r,lyrD:n}),this.olMap.addInteraction(this.transparentInteraction_),this.setOpacity(o),this.setComparisonMode(a),this.setStaticDivision(i)}},{key:"setVisibilityLayersCD",value:function(){void 0!==this.transparentInteraction_&&this.transparentInteraction_.setVisibilityLayersCD()}},{key:"setOpacity",value:function(e){void 0!==this.transparentInteraction_&&this.transparentInteraction_.setOpacity(e)}},{key:"setComparisonMode",value:function(e){void 0!==this.transparentInteraction_&&this.transparentInteraction_.setComparisonMode(e),this.setVisibilityLayersCD()}},{key:"setStaticDivision",value:function(e){void 0!==this.transparentInteraction_&&this.transparentInteraction_.setStaticDivision(e)}},{key:"addLayer",value:function(e){this.transparentInteraction_.addLayer(e.getImpl().getOL3Layer())}},{key:"removeEffectsCurtain",value:function(){this.olMap.removeInteraction(this.transparentInteraction_)}},{key:"removeLayer",value:function(e){this.transparentInteraction_.removeLayer(e.getImpl().getOL3Layer())}}])&&ot(t.prototype,r),n&&ot(t,n),i}(),pt=r(7),yt=r.n(pt),dt=void 0;function mt(e){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ft(e){return function(e){if(Array.isArray(e))return ht(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ht(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ht(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bt(e,t){return(bt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=St(e);if(t){var o=St(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _t(this,r)}}function _t(e,t){return!t||"object"!==mt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function St(e){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Array.prototype.unique=function(e){return function(){return dt.filter(e)}};var Lt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bt(e,t)}(i,M.Control);var t,r,n,o=gt(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),M.utils.isUndefined(ut)&&M.exception(g("exception"));var r=new ut;return(t=o.call(this,r,"LyrCompare")).layers=e.layers,t.opacityVal=e.opacityVal,t.layerSelectedA=null,t.layerSelectedB=null,t.layerSelectedC=null,t.layerSelectedD=null,t.template=null,t.staticDivision=e.staticDivision,t.opacityVal=e.opacityVal,t.comparisonMode=e.comparisonMode,t.defaultLyrA=e.defaultLyrA,t.defaultLyrB=e.defaultLyrB,t.defaultLyrC=e.defaultLyrC,t.defaultLyrD=e.defaultLyrD,t.interface=e.interface,t}return t=i,(r=[{key:"createView",value:function(e){var t=this;return this.map=e,new Promise((function(e,r){if(t.layers=t.transformToLayers(t.layers),t.layers.length>=2){3===t.comparisonMode&&t.layers.length<4&&(M.dialog.error(g("no_layers_plugin"),"lyrcompare"),t.comparisonMode=0);var n=t.allLayerLoad();if(n)t.setFunctionsAndCompile(e);else var o=setInterval((function(){(n=t.allLayerLoad())&&(clearInterval(o),t.setFunctionsAndCompile(e))}),200)}else M.dialog.error(g("no_layers_plugin"),"lyrcompare")}))}},{key:"setFunctionsAndCompile",value:function(e){var t=this,r={jsonp:!0,vars:{options:this.layers.map((function(e){return e instanceof Object?{name:e.name,legend:e.legend}:{name:e,legend:e}})),comparisonMode:this.comparisonMode,translations:{tooltip_vcurtain:g("tooltip_vcurtain"),tooltip_hcurtain:g("tooltip_hcurtain"),tooltip_multicurtain:g("tooltip_multicurtain"),tooltip_deactivatecurtain:g("tooltip_deactivatecurtain"),opacity:g("opacity"),static:g("static"),dynamic:g("dynamic"),mixed:g("mixed"),layer:g("layer"),opacity_tooltip:g("opacity_tooltip"),static_tooltip:g("static_tooltip"),dynamic_tooltip:g("dynamic_tooltip"),mixed_tooltip:g("mixed_tooltip"),lyrLeftSelect_tooltip:g("lyrLeftSelect_tooltip"),lyrRightSelect_tooltip:g("lyrRightSelect_tooltip")}}};return this.template=M.template.compileSync(yt.a,r),this.setEventsAndValues(),this.updateControls(),0===this.layers.length?M.dialog.error(g("no_layers_plugin")):this.template.querySelectorAll('button[id^="m-lyrcompare-"]').forEach((function(e,r){"m-lyrcompare-deactivate"===e.id?e.addEventListener("click",(function(e){document.querySelector("#m-lyrdropdown-selector").style.display="block",document.querySelector("#m-transparency-active").disabled=!1,document.querySelector("#m-transparency-deactivate").disabled=!1,t.comparisonMode=0,t.deactivateCurtain()})):e.addEventListener("click",(function(e){return 0===t.comparisonMode?(document.querySelector("#m-lyrdropdown-selector").value="none",document.querySelector("#m-lyrdropdown-selector").style.display="none",document.querySelector("#m-transparency-active").disabled=!0,document.querySelector("#m-transparency-deactivate").disabled=!0,t.comparisonMode=r+1,void t.activateCurtain()):t.comparisonMode===r+1?(t.comparisonMode=0,void t.deactivateCurtain()):(t.comparisonMode=r+1,t.updateControls(),void t.getImpl().setComparisonMode(t.comparisonMode))}))})),e(this.template)}},{key:"setEventsAndValues",value:function(){var e=this;this.template.querySelector("#input-transparent-opacity").value=this.opacityVal,this.template.querySelector("#input-transparent-opacity").addEventListener("input",(function(t){e.opacityVal=Number(t.target.value),e.getImpl().setOpacity(e.opacityVal)})),1===this.staticDivision?this.template.querySelector("#div-m-lyrcompare-transparent-static").checked=!0:0===this.staticDivision?this.template.querySelector("#div-m-lyrcompare-transparent-dynamic").checked=!0:this.template.querySelector("#div-m-lyrcompare-transparent-mixed").checked=!0,this.template.querySelector("#div-m-lyrcompare-transparent-dynamic").addEventListener("change",(function(t){e.staticDivision=Number(t.target.value),e.getImpl().setStaticDivision(e.staticDivision)})),this.template.querySelector("#div-m-lyrcompare-transparent-static").addEventListener("change",(function(t){e.staticDivision=Number(t.target.value),e.getImpl().setStaticDivision(e.staticDivision)})),this.template.querySelector("#div-m-lyrcompare-transparent-mixed").addEventListener("change",(function(t){e.staticDivision=Number(t.target.value),e.getImpl().setStaticDivision(e.staticDivision)})),this.template.querySelectorAll('select[id^="m-lyrcompare-"]').forEach((function(t){t.addEventListener("change",(function(r){var n=e.layers.filter((function(e){return e.name===r.target.value})),o=[];if("m-lyrcompare-lyrA"===t.id?o=[n[0].name,e.layerSelectedB.name,e.layerSelectedC.name,e.layerSelectedD.name]:"m-lyrcompare-lyrB"===t.id?o=[e.layerSelectedA.name,n[0].name,e.layerSelectedC.name,e.layerSelectedD.name]:"m-lyrcompare-lyrC"===t.id?o=[e.layerSelectedA.name,e.layerSelectedB.name,n[0].name,e.layerSelectedD.name]:"m-lyrcompare-lyrD"===t.id&&(o=[e.layerSelectedA.name,e.layerSelectedB.name,e.layerSelectedC.name,n[0].name]),!1===e.checkLayersAreDifferent.apply(e,ft(o)))return M.dialog.info(g("advice_sameLayer")),"m-lyrcompare-lyrA"===t.id?e.template.querySelector("#"+t.id).value=e.layerSelectedA.name:"m-lyrcompare-lyrB"===t.id?e.template.querySelector("#"+t.id).value=e.layerSelectedB.name:"m-lyrcompare-lyrC"===t.id?e.template.querySelector("#"+t.id).value=e.layerSelectedC.name:"m-lyrcompare-lyrD"===t.id&&(e.template.querySelector("#"+t.id).value=e.layerSelectedD.name),!1;"m-lyrcompare-lyrA"===t.id?(n[0].name===e.layerSelectedC.name&&(e.layerSelectedC.setVisible(!1),e.layerSelectedC=e.layerSelectedA,e.template.querySelector("#m-lyrcompare-lyrC").value=e.layerSelectedA.name),n[0].name===e.layerSelectedD.name&&(e.layerSelectedD.setVisible(!1),e.layerSelectedD=e.layerSelectedA,e.template.querySelector("#m-lyrcompare-lyrD").value=e.layerSelectedA.name)):"m-lyrcompare-lyrB"===t.id&&(n[0].name===e.layerSelectedC.name&&(e.layerSelectedC.setVisible(!1),e.layerSelectedC=e.layerSelectedB,e.template.querySelector("#m-lyrcompare-lyrC").value=e.layerSelectedB.name),n[0].name===e.layerSelectedD.name&&(e.layerSelectedD.setVisible(!1),e.layerSelectedD=e.layerSelectedB,e.template.querySelector("#m-lyrcompare-lyrD").value=e.layerSelectedB.name)),"m-lyrcompare-lyrA"===t.id?(e.layerSelectedA.setVisible(!1),e.layerSelectedA=n[0]):"m-lyrcompare-lyrB"===t.id?(e.layerSelectedB.setVisible(!1),e.layerSelectedB=n[0]):"m-lyrcompare-lyrC"===t.id?(e.layerSelectedC.setVisible(!1),e.layerSelectedC=n[0]):"m-lyrcompare-lyrD"===t.id&&(e.layerSelectedD.setVisible(!1),e.layerSelectedD=n[0]),e.removeEffectsComparison(),e.getImpl().effectSelectedCurtain(e.layerSelectedA,e.layerSelectedB,e.layerSelectedC,e.layerSelectedD,e.opacityVal,e.staticDivision,e.comparisonMode)}))}))}},{key:"checkLayersAreDifferent",value:function(e,t,r,n){var o=!0;if(1===this.comparisonMode||2===this.comparisonMode)o=e!==t;else{var i=[e,t,r,n];o=ft(new Set(i)).length===i.length}return o}},{key:"activateCurtain",value:function(){this.activeDefault(),this.getImpl().effectSelectedCurtain(this.layerSelectedA,this.layerSelectedB,this.layerSelectedC,this.layerSelectedD,this.opacityVal,this.staticDivision,this.comparisonMode),this.updateControls()}},{key:"activeDefault",value:function(){null===this.layerSelectedA&&(this.layerSelectedA=this.layers[this.defaultLyrA],this.template.querySelector("#m-lyrcompare-lyrA").selectedIndex=this.defaultLyrA),null===this.layerSelectedB&&(this.layerSelectedB=this.layers[this.defaultLyrB],this.template.querySelector("#m-lyrcompare-lyrB").selectedIndex=this.defaultLyrB),null===this.layerSelectedC&&(this.layerSelectedC=this.layers[this.defaultLyrC],this.template.querySelector("#m-lyrcompare-lyrC").selectedIndex=this.defaultLyrC),null===this.layerSelectedD&&(this.layerSelectedD=this.layers[this.defaultLyrD],this.template.querySelector("#m-lyrcompare-lyrD").selectedIndex=this.defaultLyrD)}},{key:"deactivateCurtain",value:function(){var e=document.querySelector(".lyrcompare-swipe-control");e&&(e.classList.display="none !important"),this.comparisonMode=0,null!==this.layerSelectedA&&null!==this.layerSelectedB&&(this.layerSelectedA.setVisible(!1),this.layerSelectedB.setVisible(!1)),null!==this.layerSelectedC&&null!==this.layerSelectedD&&void 0!==this.layerSelectedC&&void 0!==this.layerSelectedD&&(this.layerSelectedC.setVisible(!1),this.layerSelectedD.setVisible(!1)),this.removeEffectsComparison(),this.updateControls()}},{key:"removeEffectsComparison",value:function(){this.getImpl().removeEffectsCurtain()}},{key:"manageLyrAvailable",value:function(e){null!==this.template&&(this.updateLyrsAvailables(e,"A"),this.updateLyrsAvailables(e,"B"),this.updateLyrsAvailables(e,"C"),this.updateLyrsAvailables(e,"D"))}},{key:"updateLyrsAvailables",value:function(e,t){try{var r=null;r=this.template.querySelector("#m-lyrcompare-lyr"+t);for(var n=1;n<r.options.length;n++)r.options[n].disabled=!e.includes(r.options[n].value)}catch(e){console.log(e)}}},{key:"updateControls",value:function(){this.removeActivate(),this.activateByMode();var e=document.querySelector(".lyrcompare-swipe-control");if(0===this.comparisonMode)return this.template.querySelectorAll('select[id^="m-lyrcompare-"]').forEach((function(e){e.disabled=!0})),this.template.querySelector("input").disabled=!0,this.template.querySelector("#div-m-lyrcompare-transparent-dynamic").disabled=!0,this.template.querySelector("#div-m-lyrcompare-transparent-static").disabled=!0,void(this.template.querySelector("#div-m-lyrcompare-transparent-mixed").disabled=!0);1===this.comparisonMode?(e&&(e.style.opacity="1"),this.template.querySelector("#m-lyrcompare-lyrA-lbl").classList.add("cp-columns-2"),this.template.querySelector("#m-lyrcompare-lyrB-lbl").classList.add("cp-columns-1"),this.template.querySelector("#m-lyrcompare-lyrA-cont").style.display="block",this.template.querySelector("#m-lyrcompare-lyrB-cont").style.display="block",this.template.querySelector("#m-lyrcompare-lyrA").disabled=!1,this.template.querySelector("#m-lyrcompare-lyrB").disabled=!1):2===this.comparisonMode?(e&&(e.style.opacity="1"),this.template.querySelector("#m-lyrcompare-lyrA-lbl").classList.add("cp-columns-4"),this.template.querySelector("#m-lyrcompare-lyrB-lbl").classList.add("cp-columns-3"),this.template.querySelector("#m-lyrcompare-lyrA-cont").style.display="block",this.template.querySelector("#m-lyrcompare-lyrB-cont").style.display="block",this.template.querySelector("#m-lyrcompare-lyrA").disabled=!1,this.template.querySelector("#m-lyrcompare-lyrB").disabled=!1):3===this.comparisonMode&&(e&&(e.style.opacity="1"),this.template.querySelectorAll('select[id^="m-lyrcompare-"]').forEach((function(e){e.disabled=!1})),this.template.querySelector("#m-lyrcompare-lyrA-lbl").classList.add("cp-th-large-1"),this.template.querySelector("#m-lyrcompare-lyrB-lbl").classList.add("cp-th-large-2"),this.template.querySelector("#m-lyrcompare-lyrC-lbl").classList.add("cp-th-large-3"),this.template.querySelector("#m-lyrcompare-lyrD-lbl").classList.add("cp-th-large-4"),this.template.querySelector("#m-lyrcompare-lyrA-cont").style.display="block",this.template.querySelector("#m-lyrcompare-lyrB-cont").style.display="block",this.template.querySelector("#m-lyrcompare-lyrC-cont").style.display="block",this.template.querySelector("#m-lyrcompare-lyrD-cont").style.display="block"),this.template.querySelector("input").disabled=!1,this.template.querySelector("#div-m-lyrcompare-transparent-dynamic").disabled=!1,this.template.querySelector("#div-m-lyrcompare-transparent-static").disabled=!1,this.template.querySelector("#div-m-lyrcompare-transparent-mixed").disabled=!1}},{key:"activateByMode",value:function(){1===this.comparisonMode?this.template.querySelector("#m-lyrcompare-vcurtain").classList.add("buttom-pressed-vcurtain"):2===this.comparisonMode?this.template.querySelector("#m-lyrcompare-hcurtain").classList.add("buttom-pressed-hcurtain"):3===this.comparisonMode&&this.template.querySelector("#m-lyrcompare-multicurtain").classList.add("buttom-pressed-multicurtain")}},{key:"removeActivate",value:function(){this.template.querySelector("#m-lyrcompare-vcurtain").classList.remove("buttom-pressed-vcurtain"),this.template.querySelector("#m-lyrcompare-hcurtain").classList.remove("buttom-pressed-hcurtain"),this.template.querySelector("#m-lyrcompare-multicurtain").classList.remove("buttom-pressed-multicurtain"),this.template.querySelectorAll('select[id^="m-lyrcompare-"]').disabled=!0,this.template.querySelector("#m-lyrcompare-lyrA-cont").style.display="none",this.template.querySelector("#m-lyrcompare-lyrB-cont").style.display="none",this.template.querySelector("#m-lyrcompare-lyrC-cont").style.display="none",this.template.querySelector("#m-lyrcompare-lyrD-cont").style.display="none",this.template.querySelector("#m-lyrcompare-lyrA-lbl").classList="",this.template.querySelector("#m-lyrcompare-lyrB-lbl").classList="";var e=document.querySelector(".lyrcompare-swipe-control");e&&(e.style.opacity="0")}},{key:"removeCurtainLayers",value:function(e){var t=this;e.forEach((function(e){if(e instanceof Object){if(e instanceof Object){var r=t.map.getLayers().filter((function(t){return e.name.includes(t.name)}))[t.map.getLayers().filter((function(t){return e.name.includes(t.name)})).length-1];t.map.removeLayers(r)}}else if(e.indexOf("*")>=0){var n=e.split("*")[3],o=t.map.getLayers().filter((function(e){return n.includes(e.name)}))[t.map.getLayers().filter((function(e){return n.includes(e.name)})).length-1];t.map.removeLayers(o)}else{var i=t.map.getLayers().filter((function(t){return e.includes(t.name)}))[t.map.getLayers().filter((function(t){return e.includes(t.name)})).length-1];t.map.removeLayers(i)}}))}},{key:"allLayerLoad",value:function(){var e=!0;return void 0!==this.layers[0].load&&(void 0!==this.layers[1].load||void 0===this.layers[2]||void 0===this.layers[3]||void 0!==this.layers[2].load&&void 0!==this.layers[3].load)||(e=!1),e}},{key:"transformToLayers",value:function(e){var t=this,r=e.map((function(e){var r=null;if(e instanceof Object){if(e instanceof Object){var n=t.map.getLayers().filter((function(t){return e.name.includes(t.name)}))[0];r=t.isValidLayer(n)?n:null}}else if(e.indexOf("*")>=0){var o=e.split("*");"WMS"===o[0].toUpperCase()?(r=new M.layer.WMS({url:o[2],name:o[3],legend:o[1]}),t.map.getLayers().filter((function(e){return r.name.includes(e.name)})).length>0?(r=t.map.getLayers().filter((function(e){return r.name.includes(e.name)}))[0]).legend=o[1]||r.name:t.map.addLayers(r)):"WMTS"===o[0].toUpperCase()&&(r=new M.layer.WMTS({url:o[2]+"?",name:o[3],legend:o[1],matrixSet:o[4],transparent:!0,displayInLayerSwitcher:!1,queryable:!1,visibility:!1,format:o[5]}),t.map.addWMTS(r))}else{var i=t.map.getLayers().filter((function(t){return e.includes(t.name)}))[0];r=t.isValidLayer(i)?i:null}if(null!==r)return null===r.getImpl().getOL3Layer()?setTimeout((function(){"WMS"===r.type||"WMTS"===r.type?r.load=!0:"WMTS"===r.type&&(r.facadeLayer_.load=!0)}),1e3):r.load=!0,r.displayInLayerSwitcher=!1,r.setVisible(!1),r;t.layers.remove(e)}),this);return void 0===r[0]?[]:r}},{key:"isValidLayer",value:function(e){return"WMTS"===e.type||"WMS"===e.type}},{key:"equals",value:function(e){return e instanceof i}},{key:"getLayersNames",value:function(){return this.layers.map((function(e){return e.name}))}}])&&vt(t.prototype,r),n&&vt(t,n),i}();function Mt(e){return(Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ct(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pt(e,t){return(Pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ot(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=xt(e);if(t){var o=xt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return kt(this,r)}}function kt(e,t){return!t||"object"!==Mt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xt(e){return(xt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pt(e,t)}(i,M.Plugin);var t,r,n,o=Ot(i);function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return wt(this,i),(e=o.call(this)).name_="lyrcompare",e.error_=!1,e.layers=[],void 0===t.layers||t.layers.length<2?(M.dialog.error(g("no_layers_plugin"),"lyrcompare"),e.error_=!0):Array.isArray(t.layers)?e.layers=t.layers:e.layers=t.layers.split(","),e.controls_=[],e.map_=null,!1===e.error_&&(e.position=t.position,e.collapsed=!0,e.collapsible=!0,e.staticDivision=void 0===t.staticDivision?1:parseInt(t.staticDivision),void 0===t.opacityVal?e.opacityVal=100:(e.opacityVal=parseInt(t.opacityVal),e.opacityVal<=0?e.opacityVal=0:e.opacityVal>=100&&(e.opacityVal=100)),void 0===t.comparisonMode?e.comparisonMode=0:(e.comparisonMode=parseInt(t.comparisonMode),(e.comparisonMode<=0||e.comparisonMode>3)&&(e.comparisonMode=0)),e.metadata_=X.metadata,e.tooltip_=t.tooltip||g("tooltip"),e.interface=void 0===t.interface||t.interface,void 0===t.defaultLyrA?e.defaultLyrA=0:e.defaultLyrA=parseInt(t.defaultLyrA),void 0===t.defaultLyrB?e.defaultLyrB=0!==e.defaultLyrA?0:1:e.defaultLyrB=parseInt(t.defaultLyrB),e.defaultLyrA===e.defaultLyrB&&(M.dialog.error(g("repeated_layers"),"lyrcompare"),e.error_=!0),void 0===t.defaultLyrC?e.defaultLyrC=2:e.defaultLyrC=parseInt(t.defaultLyrC),e.defaultLyrA!==e.defaultLyrC&&e.defaultLyrB!==e.defaultLyrC||(M.dialog.error(g("repeated_layers"),"lyrcompare"),e.error_=!0),void 0===t.defaultLyrD?e.defaultLyrD=3:e.defaultLyrD=parseInt(t.defaultLyrD),e.defaultLyrA!==e.defaultLyrD&&e.defaultLyrB!==e.defaultLyrD&&e.defaultLyrC!==e.defaultLyrD||(M.dialog.error(g("repeated_layers"),"lyrcompare"),e.error_=!0)),e}return t=i,(r=[{key:"addTo",value:function(e){this.map_=e;var t={layers:this.layers,collapsible:this.collapsible,collapsed:this.collapsed,staticDivision:this.staticDivision,opacityVal:this.opacityVal,comparisonMode:this.comparisonMode,defaultLyrA:this.defaultLyrA,defaultLyrB:this.defaultLyrB,defaultLyrC:this.defaultLyrC,defaultLyrD:this.defaultLyrD,interface:this.interface};this.control_=new Lt(t),this.controls_.push(this.control_),this.error_?0!==e.getPlugins("lyrcompare").length&&e.removePlugins(e.getPlugins("lyrcompare")):(this.interface?this.panel_=new M.ui.Panel("panelLyrcompare",{collapsible:this.collapsible,collapsed:this.collapsed,position:M.ui.position[this.position],className:"m-plugin-lyrcompare",collapsedButtonClass:"cp-icon",tooltip:this.tooltip_}):this.panel_=new M.ui.Panel("panelLyrcompare",{collapsible:!1,collapsed:!0,position:M.ui.position[this.position],className:"m-plugin-lyrcompare-hidden"}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_))}},{key:"destroy",value:function(){this.deactivate();var e=document.querySelector(".lyrcompare-swipe-control");e&&e.remove(),this.map_.removeControls([this.control_]),this.control_.removeCurtainLayers(this.control_.getLayersNames());var t=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];this.name_=t[0],this.error_=t[1],this.layers=t[2],this.controls_=t[3],this.map_=t[4],this.position=t[5],this.collapsed=t[6],this.collapsible=t[7],this.staticDivision=t[8],this.opacityVal=t[9],this.comparisonMode=t[10],this.metadata_=t[11],this.tooltip_=t[12],this.interface=t[13],this.defaultLyrA=t[14],this.defaultLyrB=t[15],this.defaultLyrC=t[16],this.defaultLyrD=t[17]}},{key:"manageLyrAvailable",value:function(e){this.control_.manageLyrAvailable(e)}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"activate",value:function(){this.control_.activateCurtain()}},{key:"deactivate",value:function(){this.control_.deactivateCurtain()}},{key:"isActive",value:function(){return 0!==this.control_.comparisonMode}},{key:"equals",value:function(e){return e instanceof i}},{key:"name",get:function(){return this.name_}}])&&Ct(t.prototype,r),n&&Ct(t,n),i}();r(14);function jt(e){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dt(e,t,r){return(Dt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=It(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function Tt(e,t){return(Tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=It(e);if(t){var o=It(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Et(this,r)}}function Et(e,t){return!t||"object"!==jt(t)&&"function"!=typeof t?At(e):t}function At(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function It(e){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tt(e,t)}(i,ol.interaction.Pointer);var t,r,n,o=Vt(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).layers_=[],ol.interaction.Pointer.call(At(t),{handleDownEvent:t.setPosition,handleMoveEvent:t.setPosition});var r=e||{};t.freeze=r.freeze,t.pos=r.freezeInPosition,t.radius=r.radius||100,t.OLVersion="OL6";var n=[r.layers].map((function(e){return e.getImpl().getOL3Layer()})).filter((function(e){return null!=e}));return t.addLayer(n),t}return t=i,(r=[{key:"setMap",value:function(e){var t;if(this.getMap()){for(t=0;t<this.layers_.length;t+=1)"OL6"===this.OLVersion?(this.layers_[t].prerender&&ol.Observable.unByKey(this.layers_[t].prerender),this.layers_[t].postrender&&ol.Observable.unByKey(this.layers_[t].postrender),this.layers_[t].prerender=this.layers_[t].postcompose=null):(this.layers_[t].precompose&&ol.Observable.unByKey(this.layers_[t].precompose),this.layers_[t].postcompose&&ol.Observable.unByKey(this.layers_[t].postcompose),this.layers_[t].precompose=this.layers_[t].postcompose=null);this.getMap().renderSync()}if(ol.interaction.Pointer.prototype.setMap.call(this,e),e){for(t=0;t<this.layers_.length;t+=1)"OL6"===this.OLVersion?(this.layers_[t].prerender=this.layers_[t].on("prerender",this.precompose_.bind(this)),this.layers_[t].postrender=this.layers_[t].on("postrender",this.postcompose_.bind(this))):(this.layers_[t].precompose=this.layers_[t].on("precompose",this.precompose_.bind(this)),this.layers_[t].postcompose=this.layers_[t].on("postcompose",this.postcompose_.bind(this)));e.renderSync()}}},{key:"setRadius",value:function(e){this.radius=e,this.getMap()&&this.getMap().renderSync()}},{key:"setFreeze",value:function(e){this.freeze=e,this.getMap()&&this.getMap().renderSync()}},{key:"toogleFreeze",value:function(){this.freeze=!this.freeze,this.getMap()&&this.getMap().renderSync()}},{key:"addLayer",value:function(e){e instanceof Array||(e=[e]);for(var t=0;t<e.length;t+=1){var r={layer:e[t]};this.getMap()&&(r.prerender=e[t].on("prerender",this.precompose_.bind(this)),r.postrender=e[t].on("postrender",this.postcompose_.bind(this)),this.getMap().renderSync()),this.layers_.push(e[t])}}},{key:"removeLayer",value:function(e){e instanceof Array||(e=[e]);for(var t=0;t<e.length;t+=1){var r=void 0;for(r=0;r<this.layers_.length&&this.layers_[r]!==e[t];r+=1);r!==this.layers_.length&&this.getMap()&&(this.layers_[r].precompose&&ol.Observable.unByKey(this.layers_[r].precompose),this.layers_[r].postcompose&&ol.Observable.unByKey(this.layers_[r].postcompose),this.layers_.splice(r,1),this.getMap().renderSync())}}},{key:"setPosition",value:function(e){e.pixel?!1===this.freeze&&(this.pos=e.pixel):e&&e instanceof Array?this.pos=e:e=[-1e7,-1e7],this.getMap()&&this.getMap().renderSync()}},{key:"precompose_",value:function(e){var t=e.context;t.save(),t.beginPath(),t.arc(this.pos[0],this.pos[1],this.radius,0,2*Math.PI),t.lineWidth=3,this.freeze?t.strokeStyle="rgba(255,0,0,0.7)":t.strokeStyle="rgba(0,0,0,0.5)",t.stroke(),t.clip()}},{key:"postcompose_",value:function(e){e.context.restore()}},{key:"setActive",value:function(e){Dt(It(i.prototype),"setActive",this).call(this,e)}}])&&qt(t.prototype,r),n&&qt(t,n),i}();function Bt(e){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Wt(e,t,r){return(Wt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gt(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function Ft(e,t){return(Ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Gt(e);if(t){var o=Gt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ut(this,r)}}function Ut(e,t){return!t||"object"!==Bt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gt(e){return(Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ht=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ft(e,t)}(i,M.impl.Control);var t,r,n,o=Kt(i);function i(){return Nt(this,i),o.apply(this,arguments)}return t=i,(r=[{key:"addTo",value:function(e,t){this.map=e,this.olMap=e.getMapImpl(),this.freezePosition=!1,Wt(Gt(i.prototype),"addTo",this).call(this,e,t)}},{key:"effectSelected",value:function(e,t,r){e.setVisible(!0),e.setZIndex(5e3),this.transparentInteraction_=new zt({radius:t,freeze:r,freezeInPosition:this.freezePosition,layers:e}),this.olMap.addInteraction(this.transparentInteraction_)}},{key:"setRadius",value:function(e){void 0!==this.transparentInteraction_&&this.transparentInteraction_.setRadius(e)}},{key:"setFreeze",value:function(e){this.freezePosition=this.transparentInteraction_.pos,void 0!==this.transparentInteraction_&&this.transparentInteraction_.setFreeze(e)}},{key:"toogleFreeze",value:function(){this.freezePosition=this.transparentInteraction_.pos,void 0!==this.transparentInteraction_&&this.transparentInteraction_.toogleFreeze()}},{key:"addLayer",value:function(e){this.transparentInteraction_.addLayer(e)}},{key:"removeEffects",value:function(){this.olMap.removeInteraction(this.transparentInteraction_)}},{key:"removeLayer",value:function(e){this.transparentInteraction_.removeLayer(e.getImpl().getOL3Layer())}}])&&Zt(t.prototype,r),n&&Zt(t,n),i}(),Jt=r(8),Xt=r.n(Jt);function Yt(e){return(Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qt(e,t){return(Qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function er(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=rr(e);if(t){var o=rr(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return tr(this,r)}}function tr(e,t){return!t||"object"!==Yt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rr(e){return(rr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qt(e,t)}(i,M.Control);var t,r,n,o=er(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),M.utils.isUndefined(Ht)&&M.exception(g("exception"));var r=new Ht;return(t=o.call(this,r,"Transparency")).layers=e.layers,t.radius=e.radius,t.layerSelected=null,t.freeze=!1,t.template=null,t.freezeSpyEye=!1,t}return t=i,(r=[{key:"createView",value:function(e){var t=this;return this.map=e,new Promise((function(e,r){t.layers=t.transformToLayers(t.layers);var n=t.layers.map((function(e){return e instanceof Object?{name:e.name,legend:e.legend}:{name:e,legend:e}})),o={jsonp:!0,vars:{translations:{transparency:g("transparency"),radius:g("radius"),layers:g("layers"),freeze:g("freeze"),unfreeze:g("unfreeze"),activate_spyeye:g("activate_spyeye"),deactivate_spyeye:g("deactivate_spyeye")}}};n.length>=1&&(o.vars.options=n),t.template=M.template.compileSync(Xt.a,o),t.template.querySelector("#input-transparent-radius").value=t.radius,t.template.querySelector("#input-transparent-radius").addEventListener("change",(function(e){t.radius=Number(e.target.value),t.getImpl().setRadius(t.radius)})),t.template.querySelector("#m-transparency-active").addEventListener("click",(function(e){document.querySelector("#m-lyrdropdown-selector").value="none",document.querySelector("#m-lyrdropdown-selector").style.display="none",document.querySelector("#m-lyrcompare-vcurtain").disabled=!0,document.querySelector("#m-lyrcompare-hcurtain").disabled=!0,document.querySelector("#m-lyrcompare-multicurtain").disabled=!0,document.querySelector("#m-lyrcompare-deactivate").disabled=!0,t.template.querySelector("#m-transparency-lock").style.visibility="visible",t.template.querySelector("#m-transparency-unlock").style.visibility="hidden",t.activate()})),t.template.querySelector("#m-transparency-deactivate").addEventListener("click",(function(e){document.querySelector("#m-lyrdropdown-selector").style.display="block",document.querySelector("#m-lyrcompare-vcurtain").disabled=!1,document.querySelector("#m-lyrcompare-hcurtain").disabled=!1,document.querySelector("#m-lyrcompare-multicurtain").disabled=!1,document.querySelector("#m-lyrcompare-deactivate").disabled=!1,t.template.querySelector("#m-transparency-lock").style.visibility="hidden",t.template.querySelector("#m-transparency-unlock").style.visibility="hidden",t.deactivate()})),t.template.querySelector("#m-transparency-lock").addEventListener("click",(function(e){M.dialog.info("Mueva el cursor a la zona deseada y pulse Ctrl+Shift+Enter para congelar")})),t.template.querySelector("#m-transparency-unlock").addEventListener("click",(function(e){t.freeze=!t.freeze,t.getImpl().setFreeze(t.freeze),t.template.querySelector("#m-transparency-lock").style.visibility="visible",t.template.querySelector("#m-transparency-unlock").style.visibility="hidden"})),0===t.layers.length||""===t.layers?M.dialog.error(g("errorLayer")):""!==o&&(t.template.querySelector("#m-transparency-lock").style.visibility="hidden",t.template.querySelector("#m-transparency-unlock").style.visibility="hidden",t.template.querySelector("select").disabled=!0,t.template.querySelector("input").disabled=!0,t.template.querySelector("select").addEventListener("change",(function(e){t.layerSelected.setVisible(!1),t.removeEffects();var r=t.layers.filter((function(t){return t.name===e.target.value}));t.layerSelected=r[0],t.getImpl().effectSelected(t.layerSelected,t.radius,t.freeze)}))),e(t.template)}))}},{key:"setDefaultLayer",value:function(){console.log("Activación remota")}},{key:"manageLyrAvailable",value:function(e){if(null!==this.template)try{var t=null;t=this.template.querySelector("#m-transparency-lyr");for(var r=1;r<t.options.length;r++)t.options[r].disabled=!e.includes(t.options[r].value)}catch(e){console.log(e)}}},{key:"activate",value:function(){null===this.layerSelected&&(this.layerSelected=this.layers[0]),this.layers.map((function(e){return e instanceof Object?{name:e.name}:{name:e}})).length>=1&&(this.template.querySelector("select").disabled=!1,this.template.querySelector("input").disabled=!1,this.template.querySelector("#m-transparency-lock").style.visibility="visible",this.template.querySelector("#m-transparency-unlock").style.visibility="hidden",this.template.querySelector("#m-transparency-active").disabled=!0,this.template.querySelector("#m-transparency-deactivate").disabled=!1),this.getImpl().effectSelected(this.layerSelected,this.radius,this.freeze)}},{key:"deactivate",value:function(){null===this.layerSelected&&(this.layerSelected=this.layers[0]);var e=this.layers.map((function(e){return e instanceof Object?{name:e.name}:{name:e}}));this.removeEffects(),this.layerSelected.setVisible(!1),e.length>=1&&(this.template.querySelector("select").disabled=!0,this.template.querySelector("input").disabled=!0,this.template.querySelector("#m-transparency-active").disabled=!1,this.template.querySelector("#m-transparency-deactivate").disabled=!0)}},{key:"removeEffects",value:function(){this.getImpl().removeEffects()}},{key:"removeTransparencyLayers",value:function(e){var t=this;e.forEach((function(e){if(e instanceof Object){if(e instanceof Object){var r=t.map.getLayers().filter((function(t){return e.name.includes(t.name)}))[0];t.map.removeLayers(r)}}else if(e.indexOf("*")>=0){var n=e.split("*")[3],o=t.map.getLayers().filter((function(e){return n.includes(e.name)}))[0];t.map.removeLayers(o)}else{var i=t.map.getLayers().filter((function(t){return e.includes(t.name)}))[0];t.map.removeLayers(i)}}))}},{key:"transformToLayers",value:function(e){var t=this,r=e.map((function(e){var r=null;if(e instanceof Object){if(e instanceof Object){var n=t.map.getLayers().filter((function(t){return e.name.includes(t.name)}))[0];r=t.isValidLayer(n)?n:null}}else if(e.indexOf("*")>=0){var o=e.split("*");"WMS"===o[0].toUpperCase()?r=new M.layer.WMS({url:o[2],name:o[3],legend:o[1]}):"WMTS"===o[0].toUpperCase()&&(r=new M.layer.WMTS({url:o[2]+"?",name:o[3],legend:o[1],matrixSet:o[4],transparent:!0,displayInLayerSwitcher:!1,queryable:!1,visibility:!1,format:o[5]}),t.map.addWMTS(r)),t.map.getLayers().filter((function(e){return r.name.includes(e.name)})).length>0?(r=t.map.getLayers().filter((function(e){return r.name.includes(e.name)}))[0]).legend=o[1]||r.name:t.map.addLayers(r)}else{var i=t.map.getLayers().filter((function(t){return e.includes(t.name)}))[0];r=t.isValidLayer(i)?i:null}if(null!==r)return null===r.getImpl().getOL3Layer()?setTimeout((function(){"WMS"!==r.type&&"WMTS"!==r.type||(r.load=!0)}),1e3):r.load=!0,r.displayInLayerSwitcher=!1,r.setVisible(!1),r;t.layers.remove(e)}),this);return void 0===r[0]?[]:r}},{key:"isValidLayer",value:function(e){return"WMTS"===e.type||"WMS"===e.type}},{key:"equals",value:function(e){return e instanceof i}},{key:"getLayersNames",value:function(){return this.layers.map((function(e){return e.name}))}}])&&$t(t.prototype,r),n&&$t(t,n),i}();function or(e){return(or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ir(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ar(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lr(e,t){return(lr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ur(e);if(t){var o=ur(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return cr(this,r)}}function cr(e,t){return!t||"object"!==or(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ur(e){return(ur=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lr(e,t)}(i,M.Plugin);var t,r,n,o=sr(i);function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ir(this,i),(e=o.call(this)).name_="transparency",e.map_=null,e.controls_=[],e.className="m-plugin-transparency",e.position=t.position,e.enabledKeyFunctions=t.enabledKeyFunctions,void 0===e.enabledKeyFunctions&&(e.enabledKeyFunctions=!0),void 0===t.layers||""===t.layers?(M.dialog.error(g("errorLayer")),e.layers=[]):Array.isArray(t.layers)?e.layers=t.layers:e.layers=t.layers.split(","),isNaN(parseInt(t.radius))?e.radius=100:t.radius>=30&&t.radius<=200?e.radius=parseInt(t.radius):t.radius>200?e.radius=200:t.radius<30&&(e.radius=30),e.metadata_=X.metadata,e.separatorApiJson=X.url.separator,e.tooltip_=t.tooltip||g("tooltip"),e.collapsed=t.collapsed||!0,e.collapsible=t.collapsible||!0,e}return t=i,(r=[{key:"addTo",value:function(e){var t=this,r={layers:this.layers,radius:this.radius};this.control_=new nr(r),this.controls_.push(this.control_),this.map_=e,this.panel_=new M.ui.Panel("panelTransparency",{collapsible:this.collapsible,collapsed:this.collapsed,position:M.ui.position[this.position],className:this.className,collapsedButtonClass:"icon-gps4",tooltip:this.tooltip_}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_),document.addEventListener("keydown",(function(e){if(t.enabledKeyFunctions){if(e.ctrlKey&&e.shiftKey&&"ArrowUp"===e.key){if(t.control_.radius>=200)return;t.control_.radius+=20,t.control_.getImpl().setRadius(t.control_.radius),t.control_.template.querySelector("#input-transparent-radius").value=t.control_.radius}if(e.ctrlKey&&e.shiftKey&&"ArrowDown"===e.key){if(t.control_.radius<=32)return;t.control_.radius-=20,t.control_.getImpl().setRadius(t.control_.radius),t.control_.template.querySelector("#input-transparent-radius").value=t.control_.radius}e.ctrlKey&&e.shiftKey&&"Enter"===e.key&&(t.control_.freeze=!t.control_.freeze,t.control_.getImpl().setFreeze(t.control_.freeze),t.control_.freeze?(t.control_.template.querySelector("#m-transparency-lock").style.visibility="hidden",t.control_.template.querySelector("#m-transparency-unlock").style.visibility="visible"):(t.control_.template.querySelector("#m-transparency-lock").style.visibility="visible",t.control_.template.querySelector("#m-transparency-unlock").style.visibility="hidden"))}}))}},{key:"manageLyrAvailable",value:function(e){this.control_.manageLyrAvailable(e)}},{key:"destroy",value:function(){this.control_.removeEffects(),this.control_.removeTransparencyLayers(this.control_.getLayersNames()),this.map_.removeControls([this.control_]);var e=[null,null,null,null,null];this.control_=e[0],this.panel_=e[1],this.map_=e[2],this.layers=e[3],this.radius=e[4]}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"setDefaultLayer",value:function(){this.control_.setDefaultLayer()}},{key:"activate",value:function(){this.control_.activate()}},{key:"deactivate",value:function(){this.control_.deactivate()}},{key:"equals",value:function(e){return e instanceof i}},{key:"name",get:function(){return this.name_}}])&&ar(t.prototype,r),n&&ar(t,n),i}();function yr(e){return(yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mr(e,t){return(mr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=vr(e);if(t){var o=vr(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return hr(this,r)}}function hr(e,t){return!t||"object"!==yr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vr(e){return(vr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var br=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mr(e,t)}(i,M.Control);var t,r,n,o=fr(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),M.utils.isUndefined(p)&&M.exception(g("exception"));var r=new p;return(t=o.call(this,r,"Comparepanel")).template=null,t.baseLayers=e.baseLayers,t.position=e.position,t.layers=[],t.defaultComparisonMode=e.defaultComparisonMode,t.defaultComparisonViz=e.defaultComparisonViz,t.previousComparisonMode="",t.actualComparisonMode="",t.urlCover=e.urlCover,t.lyrsMirrorMinZindex=e.lyrsMirrorMinZindex,t.baseLayers.forEach((function(e){return t.layers.push(e[2])})),t.params=[e.mirrorpanelParams,e.timelineParams,e.lyrcompareParams,e.transparencyParams],t.params.forEach((function(e){e.position=t.position})),e.mirrorpanelParams.defaultBaseLyrs=t.layers,e.mirrorpanelParams.lyrsMirrorMinZindex=t.lyrsMirrorMinZindex,e.timelineParams.intervals=t.baseLayers,e.lyrcompareParams.layers=t.layers,e.transparencyParams.layers=t.layers,t.allLayersName=t.layers.map((function(e){if(e.indexOf("*")>=0){var t=e.split("*");if("WMS"===t[0].toUpperCase())return t[3];if("WMTS"===t[0].toUpperCase())return t[3]}})),t.mirrorpanel=new _e(e.mirrorpanelParams),t.timeline=new Ue(e.timelineParams),t.lyrcompare=new Rt(e.lyrcompareParams),t.transparency=new pr(e.transparencyParams),t.panels=[],t.plugins=[t.mirrorpanel,t.timeline,t.lyrcompare,t.transparency],t.map=null,t.lyrCoverture=null,t}return t=i,(r=[{key:"createView",value:function(e){var t=this;return this.map=e,new Promise((function(r,n){var o={jsonp:!0,vars:{translations:{tooltipLyr:g("tooltipLyr"),tooltipMirrorpanel:g("tooltipMirrorpanel"),tooltipTimeline:g("tooltipTimeline"),tooltipTransparency:g("tooltipTransparency")}}};t.template=M.template.compileSync(d.a,o),r(t.template),t.addComparators(e)}))}},{key:"addComparators",value:function(e){var t=this;this.plugins.forEach((function(r,n){e.addPlugin(r),t.panels.push(r.panel_._element);var o=document.querySelector("."+r.panel_._className+" .m-panel-controls");o.classList.add("cp-"+r.name),document.querySelector("."+r.panel_._className).remove(),t.template.querySelector("#m-cp-"+r.name).append(o),n===t.plugins.length-1&&t.addButtonEvents()})),this.setComparatorsDefaultStyle(),""!==this.urlCover&&this.loadCoverPNOALyr(),this.onMoveEnd((function(e){""===t.urlCover?(t.mirrorpanel.manageLyrAvailable(t.allLayersName),t.lyrcompare.manageLyrAvailable(t.allLayersName),t.transparency.manageLyrAvailable(t.allLayersName)):t.getCobertura(e)}))}},{key:"addButtonEvents",value:function(){var e=this;this.plugins.forEach((function(t){"mirrorpanel"===t.name?e.template.querySelector("#m-cp-"+t.name+" .cp-button").addEventListener("click",(function(r){e.deactivateAndActivateMirrorPanel(t)})):(t.name,e.template.querySelector("#m-cp-"+t.name+" .cp-button").addEventListener("click",(function(r){e.deactivateAndActivateOtherModes(t)})))})),this.template.querySelector("#m-cp-testing-btn").addEventListener("click",(function(t){e.map.getMapImpl().getLayers().forEach((function(e){console.log(e.getSource().key_)}))}))}},{key:"setComparatorsDefaultStyle",value:function(){var e=this;"mirrorpanel"===this.defaultComparisonMode&&0===this.defaultComparisonViz&&console.log("Modo defecto"),this.plugins.forEach((function(t){t.name===e.defaultComparisonMode&&("transparency"===t.name&&t.setDefaultLayer(),"timeline"===t.name&&t.setDefaultLayer(e.defaultComparisonViz))})),this.actualComparisonMode=this.defaultComparisonMode}},{key:"deactivateAndActivateMirrorPanel",value:function(e){var t=this;this.template.querySelector("#m-cp-mirrorpanel .cp-mirrorpanel").classList.toggle("hide-panel"),this.template.querySelector("#m-cp-mirrorpanel .cp-button").classList.toggle("active"),this.plugins.forEach((function(e){"mirrorpanel"!==e.name&&(t.template.querySelector("#m-cp-".concat(e.name," .cp-").concat(e.name)).classList.remove("hide-panel"),t.template.querySelector("#m-cp-".concat(e.name," .cp-button")).classList.remove("active"))})),"mirrorpanel"!==e.name||(this.actualComparisonMode=e.name)}},{key:"deactivateAndActivateOtherModes",value:function(e){var t=this;this.actualComparisonMode=e.name,"mirrorpanel"!==e.name&&(this.plugins.forEach((function(r){r.name!==e.name&&(t.template.querySelector("#m-cp-"+r.name+" .cp-"+r.name).classList.remove("hide-panel"),t.template.querySelector("#m-cp-"+r.name+" .cp-button").classList.remove("active"))})),this.template.querySelector("#m-cp-"+e.name+" .cp-button").classList.toggle("active"),this.template.querySelector("#m-cp-"+e.name+" .cp-"+e.name).classList.toggle("hide-panel"))}},{key:"deactivateAndActivateOtherModesDeprecated",value:function(e){this.actualComparisonMode=e.name,"mirrorpanel"!==e.name&&(this.template.querySelector("#m-cp-"+e.name+" .cp-button").classList.toggle("active"),this.template.querySelector("#m-cp-"+e.name+" .cp-button").classList.contains("active")&&"timeline"===e.name&&e.activate(),this.template.querySelector("#m-cp-"+e.name+" .cp-"+e.name).classList.toggle("hide-panel"),this.template.querySelector("#m-cp-mirrorpanel .cp-mirrorpanel").classList.remove("hide-panel"),this.template.querySelector("#m-cp-mirrorpanel .cp-button").classList.remove("active"))}},{key:"loadCoverPNOALyr",value:function(){var e=new M.style.Polygon({fill:{color:"green",opacity:0}}),t={name:"coverpnoa",url:this.urlCover};this.lyrCoverture=new M.layer.GeoJSON(t,{displayInLayerSwitcher:!1}),this.map.addLayers(this.lyrCoverture),this.lyrCoverture.displayInLayerSwitcher=!1,this.lyrCoverture.setVisible(!0),this.lyrCoverture.setStyle(e)}},{key:"onMoveEnd",value:function(e){this.map.getMapImpl().on("moveend",(function(t){return e(t)}))}},{key:"getCobertura",value:function(e){var t=this.map.getMapImpl(),r=t.getPixelFromCoordinate(t.getView().getCenter()),n=[];t.forEachFeatureAtPixel(r,(function(e,t){void 0!==e.get("layerkey")&&n.push(e.get("layerkey"))})),this.mirrorpanel.manageLyrAvailable(n),this.lyrcompare.manageLyrAvailable(n),this.transparency.manageLyrAvailable(n)}},{key:"deactivate",value:function(){var e=this;this.plugins.forEach((function(t,r){t.deactivate(),document.querySelector(".m-plugin-comparepanel").parentElement.append(e.panels[r])})),this.map.removePlugins(this.plugins)}},{key:"equals",value:function(e){return e instanceof i}}])&&dr(t.prototype,r),n&&dr(t,n),i}();function gr(e){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Lr(e,t){return(Lr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Cr(e);if(t){var o=Cr(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return wr(this,r)}}function wr(e,t){return!t||"object"!==gr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cr(e){return(Cr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lr(e,t)}(i,M.Plugin);var t,r,n,o=Mr(i);function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_r(this,i),(e=o.call(this)).name_="comparepanel",e.map_=null,e.controls_=[],e.className="m-plugin-comparepanel";var r=["TR","TL","BL","BR"];e.COMP_PLUGIN_NAMES={none:"default",mirror:"mirrorpanel",curtain:"lyrcompare",timeline:"timeline",spyeye:"transparency"},e.position=r.includes(t.position)?t.position:"TR",e.collapsed=t.collapsed,void 0===e.collapsed&&(e.collapsed=!0),e.collapsible=t.collapsible,void 0===e.collapsible&&(e.collapsible=!0),e.vertical=t.vertical,void 0===e.vertical&&(e.vertical=!0),void 0!==t&&(M.utils.isString(t.baseLayers)?e.baseLayers=JSON.parse(t.baseLayers.replace(/!!/g,"[").replace(/¡¡/g,"]")):M.utils.isArray(t.baseLayers)?e.baseLayers=t.baseLayers:M.dialog.error(g("baseLayers_error")));var n=["mirror","curtain","spyeye","timeline","none"];return e.defaultCompareMode=n.includes(t.defaultCompareMode)?t.defaultCompareMode:"mirror",e.defaultCompareViz=t.defaultCompareViz||0,e.layerName_=t.layerName||"attributions",e.layerCobertura_=t.layerCobertura,e.urlCoberturas_=t.urlcoberturas||"",e.lyrsMirrorMinZindex=t.lyrsMirrorMinZindex,void 0===e.lyrsMirrorMinZindex&&(e.lyrsMirrorMinZindex=100),e.mirrorpanelParams=t.mirrorpanelParams||{},e.timelineParams=t.timelineParams||{},e.lyrcompareParams=t.lyrcompareParams||{},e.transparencyParams=t.transparencyParams||{},e.backImgLayersConfig=t.backImgLayersConfig||{},e.metadata_=X.metadata,e.tooltip_=t.tooltip||g("tooltip"),e}return t=i,n=[{key:"getJSONTranslations",value:function(e){return"en"===e||"es"===e?"en"===e?m:f:M.language.getTranslation(e).comparepanel}}],(r=[{key:"addTo",value:function(e){this.mirrorpanelParams.modeViz=this.mirrorpanelParams.modeViz||{},this.mirrorpanelParams.modeViz="mirror"===this.defaultCompareMode?this.defaultCompareViz:0,"none"===this.defaultCompareMode&&(this.defaultCompareMode="mirror",this.defaultCompareViz=0),this.lyrcompareParams.comparisonMode=this.lyrcompareParams.comparisonMode||{},this.lyrcompareParams.comparisonMode="curtain"===this.defaultCompareMode?this.defaultCompareViz:0,this.control_=new br({baseLayers:this.baseLayers,mirrorpanelParams:this.mirrorpanelParams,timelineParams:this.timelineParams,lyrcompareParams:this.lyrcompareParams,transparencyParams:this.transparencyParams,defaultComparisonMode:this.COMP_PLUGIN_NAMES[this.defaultCompareMode],defaultComparisonViz:this.defaultCompareViz,position:this.position,urlCover:this.urlCoberturas_,lyrsMirrorMinZindex:this.lyrsMirrorMinZindex}),this.controls_.push(this.control_),this.map_=e,this.panel_=new M.ui.Panel("panelComparepanel",{position:M.ui.position[this.position],collapsible:this.collapsible,collapsed:this.collapsed,className:this.className,collapsedButtonClass:"cp-icon-comparepanel",tooltip:this.tooltip_}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_),this.panel_._element.classList.add(this.vertical?"orientation-vertical":"orientation-horizontal")}},{key:"destroy",value:function(){this.control_.deactivate(),this.map_.removeControls([this.control_]);var e=[null,null,null,null,null,null,null,null,null];this.control_=e[0],this.panel_=e[1],this.map_=e[2],this.baseLayers=e[3],this.vertical=e[4],this.mirrorpanelParams=e[5],this.lyrcompareParams=e[6],this.timelineParams=e[7],this.transparencyParams=e[8]}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"getAPIRest",value:function(){var e=JSON.stringify(this.baseLayers).replace(/\[/g,"!!").replace(/\]/g,"¡¡");return"".concat(this.name,"=").concat(this.position,"*!").concat(this.vertical,"*!").concat(e)}},{key:"activate",value:function(){this.control_.activate()}},{key:"deactivate",value:function(){this.control_.deactivate()}},{key:"equals",value:function(e){return e instanceof i}},{key:"name",get:function(){return this.name_}}])&&Sr(t.prototype,r),n&&Sr(t,n),i}();window.M.plugin||(window.M.plugin={}),window.M.control||(window.M.control={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.plugin.Comparepanel=Pr,window.M.control.ComparepanelControl=br,window.M.plugin.LyrCompare=Rt,window.M.control.LyrCompareControl=Lt,window.M.plugin.Mirrorpanel=_e,window.M.control.CompareMirrorpanel=ye,window.M.plugin.Timeline=Ue,window.M.control.TimelineControl=Ie,window.M.plugin.Transparency=pr,window.M.control.TransparencyControl=nr,window.M.plugin.Lyrdropdown=oe,window.M.control.LyrdropdownControl=J,window.M.impl.control.ComparepanelControl=p,window.M.impl.control.Lyrcomparecontrol=ut,window.M.impl.control.LyrcompareInteraction=tt,window.M.impl.control.CompareMirrorpanel=x,window.M.impl.control.TimelineControl=xe,window.M.impl.control.TransparencyControl=Ht,window.M.impl.control.TransparentInteraction=zt,window.M.impl.control.LyrdropdownControl=B}]);
//# sourceMappingURL=comparepanel.ol.min.js.map