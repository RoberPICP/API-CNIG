!function(e){var t={};function o(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=10)}([function(e){e.exports=JSON.parse('{"exception":{"impl":"The implementation used cannot create XYLocatorControl.","wrong_coords":"The coordinates entered are not correct.","transforming":"Error performing the transformation.","mapeaerror":"It is not possible to establish a connection with the Cadastre server.","noresults":"No results found","noubi":"There is no associated address for this location.","wrong_values":"Some value entered are not correct. Remember that minutes and seconds must be between 0 and 59 and degrees between 0 and 180."},"searchresult":"searchresult","coordinateresult":"coordinateresult","informacion":"Information","informacionCatastral":"Cadastre information","errorConexion":"It is not possible to establish a connection with the Cadastre server.","consultar":"Cadastre information","description":"Description","reference":"Cadastral reference","noReference":"No reference","noInfo":"NO REFERENCES AVAILABLE FOR THESE COORDINATES ","tooltip":"Search places","tooltip_input":"Place name, address or postal code","geographic":"Geographic","zone":"zone","title":"Coordinate locator","titleparcela":"Search parcel/cadastre","municipality":"Municipality","selectmuni":"Select a municipality","selectprov":"Select a province","estate":"Polygon","plot":"Parcel","search":"Search","placeHolderRC":"Enter the 14 or 20 digits of the RC","consultReference":"Consult Reference","titlerefCatastral":"Cadastral reference search","refCastatro":"Cadastral reference","province":"Province","srs":"Coordinate system","longitude":"Longitude","latitude":"Latitude","locate":"Locate","north":"North","south":"South","east":"East","west":"West","dms":"DMS","dd":"DD","negative":"Note: Negative values​​ correspond to south latitude and west longitude respectively ","notaRef":"Parcel code (first 14 digits). Ex.9977715VK3797F (IGN building)","RCnull":"You must enter a cadastral reference","direccion":"Place name, address or postal code","obtener":"Get direction at a point on the map","buscparcela":"Search parcel/cadastre","busccoord":"Search coordinates","borrarresult":"Delete results","exact":"Exact address","aprox":"Approximate address","debeprov":"You must select a province.","debemuni":"You must select a municipality.","debepoli":"You must select an polygon.","debeparce":"You must select a parcel.","accessibility":{"province":"Select a province.","town":"Select a town.","estate":"Insert polygon","plot":"Insert parcel","cadastre":"Insert cadastre","srs":"Select coordinate system"}}')},function(e){e.exports=JSON.parse('{"exception":{"impl":"La implementación usada no puede crear controles InformationControl.","wrong_coords":"Las coordenadas introducidas no son correctas.","transforming":"Error realizando la transformación.","mapeaerror":"No es posible establecer la conexión con el servidor de Catastro.","noresults":"No se han encontrado resultados","noubi":"No existe dirección asociada para esta ubicación.","wrong_values":"Algún valor introducido no es correcto. Recuerda que los minutos y los segundos tienen que tener un valor entre 0 y 59 y los grados entre 0 y 180."},"informacion":"Información","informacionCatastral":"Información catastral","errorConexion":"No es posible establecer conexión con el servidor de Catastro.","consultar":"Consultar Catastro","description":"Descripción","reference":"Referencia catastral","noReference":"No hay referencia","noInfo":"PARA ESAS COORDENADAS NO HAY REFERENCIA DISPONIBLE","searchresult":"searchresult","coordinateresult":"coordinateresult","tooltip":"Búsqueda de lugares","tooltip_input":"Topónimo, dirección o código postal","geographic":"Geograficas","zone":"huso","title":"Buscar por coordenadas","titleparcela":"Buscar parcela/catastro","province":"Provincia","municipality":"Municipio","selectmuni":"Seleccione municipio","selectprov":"Seleccione provincia","estate":"Polígono","plot":"Parcela","search":"Buscar","titlerefCatastral":"Búsqueda referencia catastral","refCastatro":"Referencia catastral","placeHolderRC":"Introduzca los 14 ó 20 dígitos de la RC","consultReference":"Consultar Referencia","srs":"Sistema de coordenadas","longitude":"Longitud","latitude":"Latitud","locate":"Localizar","north":"Norte","south":"Sur","east":"Este","west":"Oeste","dms":"GMS","dd":"GD","negative":"Nota: Los valores negativos se corresponden con latitud sur y longitud oeste respectivamente","notaRef":"Código de parcela (14 primeros dígitos). Ej.9977715VK3797F (edificio del IGN)","RCnull":"Debe introducir una referencia catastral","direccion":"Topónimo, dirección o código postal","obtener":"Obtener dirección en un punto del mapa","buscparcela":"Buscar parcela/catastro","busccoord":"Buscar por coordenadas","borrarresult":"Borrar resultados de la búsqueda","exact":"Dirección exacta","aprox":"Dirección aproximada","debeprov":"Debe seleccionar una provincia.","debemuni":"Debe seleccionar un municipio.","debepoli":"Debe seleccionar un polígono.","debeparce":"Debe seleccionar una parcela.","accessibility":{"province":"Seleccionar una provincia.","town":"Seleccione un municipio.","estate":"Insertar polígono","plot":"Insertar parcela","cadastre":"Insertar catastro","srs":"Seleccionar sistema de coordenadas"}}')},function(e){e.exports=JSON.parse('{"url":{"name":"ignsearchlocator","separator":"*"},"constructor":"M.plugin.IGNSearchLocator","parameters":[{"type":"object","properties":[{"type":"simple","name":"position","position":0},{"type":"boolean","name":"collapsible","position":1},{"type":"boolean","name":"isCollapsed","position":2},{"type":"simple","name":"tooltip","position":3},{"type":"simple","name":"servicesToSearch","position":4},{"type":"number","name":"maxResults","position":5},{"type":"simple","name":"noProcess","position":6},{"type":"boolean","name":"resultVisibility","position":7},{"type":"boolean","name":"reverse","position":8},{"type":"simple","name":"requestStreet","position":9},{"type":"simple","name":"locationID","position":10},{"type":"simple","name":"geocoderCoords","position":11},{"type":"number","name":"zoom","position":12},{"type":"simple","name":"searchPosition","position":13},{"type":"simple","name":"pointStyle","position":14},{"type":"simple","name":"helpUrl","position":15},{"type":"simple","name":"countryCode","position":16},{"type":"boolean","name":"cadastre","position":17},{"type":"boolean","name":"searchCoordinatesXYZ","position":18},{"type":"simple","name":"urlCandidates","position":19},{"type":"simple","name":"urlFind","position":20},{"type":"simple","name":"urlReverse","position":21},{"type":"simple","name":"urlPrefix","position":22},{"type":"simple","name":"urlAssistant","position":23},{"type":"simple","name":"urlDispatcher","position":24},{"type":"simple","name":"CMC_url","position":25},{"type":"simple","name":"DNPPP_url","position":26},{"type":"simple","name":"CPMRC_url","position":27},{"type":"simple","name":"catastroWMS","position":28}]}],"files":{"ol":{"scripts":["ignsearchlocator.ol.min.js"],"styles":["ignsearchlocator.ol.min.css"]}},"metadata":{"name":"IGNSearchLocator","description":"Searches location on IGN geocoding services and locates coordinates","text":"Searches location on IGN geocoding services and locates coordinates","version":"1.0.0","date":"02/12/2019","author":"Guadaltel","org":"CNIG","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg"}}')},function(e,t){e.exports='<div id="div-contenedor" tabindex="0" class="m-control m-container m-ignsearchlocator" title="IGN search locator">\n    <div class="search-panel">\n        <input type="text" tabindex="0" id="m-ignsearchlocator-search-input" class="m-input-search" autocomplete="new-password" title="{{translations.tooltip_input}}" placeholder="{{translations.direccion}}" />\n        <button type="button" tabindex="0" id="m-ignsearchlocator-locate-button" title="{{translations.obtener}}">\n            <span class="icon-locate" />\n        </button>\n        <button type="button" tabindex="0" id="m-ignsearchlocator-parcela-button" class="m-button-limpiar2" title="{{translations.buscparcela}}">\n            <span class="icon-catastro" />\n        </button>\n        <button type="button"  tabindex="0" id="m-ignsearchlocator-xylocator-button" class="m-button-limpiar" title="{{translations.busccoord}}">\n            <span class="icon-coordinates" />\n        </button>\n        <button type="button" tabindex="0" id="m-ignsearchlocator-clear-button" class="m-button-limpiar" title="{{translations.borrarresult}}">\n            <span class="icon-remove" />\n        </button>\n    </div>\n    <div id="m-ignsearchlocator-results">\n        \x3c!-- Here goes the list of search results --\x3e\n    </div>\n</div>\n'},function(e,t){e.exports='<ul id="m-ignsearchlocator-results-list">\n    {{#each places}}\n        {{#if this.address}}\n            {{#printType this.type this.address this.id this.municipality this.cps}}\n            {{/printType}}\n        {{else}}\n            {{#printType this.type this.title this.id this.municipality this.cps}}\n            {{/printType}}\n        {{/if}}\n    {{/each}}\n</ul>\n'},function(e,t){e.exports='<div class="m-xylocator-container">\n    <div class="m-xylocator-panel panel-codigo">\n        <div role="heading" tabindex="0" aria-label="{{translations.title}}" class="title">{{translations.title}}</div>\n        <div class="m-xylocator-datas">\n            <div id="m-xylocator-coordinatesSystemXYLocator">\n                <br>\n                <b role="text" tabindex="0" aria-label="{{translations.srs}}"><span>{{translations.srs}}:</span></b>\n                <select role="select" tabindex="0" aria-label="{{accessibility.srs}}" name="srs" id="m-xylocator-srs" class="dropdown">\n                    <option class="m-xylocator-srs-option" data-units="d" value="EPSG:4258d" option="selected">ETRS89 {{translations.geographic}} (4258) {{translations.dd}}</option>\n                    <option class="m-xylocator-srs-option" data-units="d" value="EPSG:4326d">WGS84 {{translations.geographic}} (4326) {{translations.dd}}</option>\n                    <option class="m-xylocator-srs-option" data-units="dms" value="EPSG:4258dms" option="selected">ETRS89 {{translations.geographic}} (4258) {{translations.dms}}</option>\n                    <option class="m-xylocator-srs-option" data-units="dms" value="EPSG:4326dms">WGS84 {{translations.geographic}} (4326) {{translations.dms}}</option>\n                    <option class="m-xylocator-srs-option" data-units="m" value="EPSG:3857">WGS84 Pseudo Mercator (3857)</option>\n                    <option class="m-xylocator-srs-option" data-units="m" value="EPSG:25831">ETRS89 UTM {{translations.zone}} 31N (25831)</option>\n                    <option class="m-xylocator-srs-option" data-units="m" value="EPSG:25830">ETRS89 UTM {{translations.zone}} 30N (25830)</option>\n                    <option class="m-xylocator-srs-option" data-units="m" value="EPSG:25829">ETRS89 UTM {{translations.zone}} 29N (25829)</option>\n                    <option class="m-xylocator-srs-option" data-units="m" value="EPSG:4083">REGCAN95 / UTM {{translations.zone}} 28N (4083)</option>\n                </select>\n                {{#if hasHelp}}\n                  <div class="m-xylocator-help-button" title="EPSG">\n                    <a href="{{helpUrl}}" target="_blank"><i class="icon-help"></i></a>\n                  </div>\n                {{/if}}\n            </div>\n            <div id="m-xylocator-utm" style="display:none;">\n                <b>\n                    <p role="text" tabindex="0" class="parcela--input" style="width: 0px !important;">X:</p>\n                </b>\n                <input tabindex="0" type="text" name="UTM-X" id="UTM-X" value="439770,29" style="color:black">\n                <b>\n                    <p role="text" tabindex="0" class="parcela--input" style="width: 0px !important; margin-left: 15px;">Y:</p>\n                </b>\n                <input tabindex="0" type="text" name="UTM-Y" id="UTM-Y" value="4477526,14" style="color:black">\n            </div>\n            <div id="m-xylocator-dms" style="display:none;">\n                <b>\n                    <p tabindex="0" role="text" aria-label="{{translations.longitude}}">{{translations.longitude}}:</p>\n                </b>\n                <div style="margin-bottom: -1.5rem;">\n                    <div>\n                        <input tabindex="0" type="number" name="LONHH" id="LONHH" value="3" min="0" max="180" style="color:black"><span>º</span>\n                    </div>\n                    <div>\n                        <input tabindex="0" type="number" name="LONMM" id="LONMM" value="42" min="0" max="59" style="color:black"><span>\'</span>\n                    </div>\n                    <div>\n                        <input tabindex="0" type="number" name="LONSS" id="LONSS" value="36" min="0" max="59.9999" style="color:black"><span>\'\'</span>\n                    </div>\n                    <div class="m-xylocator-dms-radio">\n                        <table>\n                            <tbody>\n                                <tr>\n                                    <td><input tabindex="0" aria-label="{{translations.east}}" type="radio" name="LONDIR" style="color:black" value="east"></td>\n                                    <td role="text" tabindex="0">{{translations.east}}</td>\n                                </tr>\n                                <tr>\n                                    <td><input tabindex="0" aria-label="{{translations.east}}" type="radio" name="LONDIR" style="color:black" value="west" checked></td>\n                                    <td role="text" tabindex="0">{{translations.west}}</td>\n                                </tr>\n                                </tbdoy>\n                        </table>\n                    </div>\n                </div>\n                <b>\n                    <p tabindex="0" role="text">{{translations.latitude}}:</p>\n                </b>\n                <div style="margin-bottom: -0.8rem;">\n                    <div>\n                        <input tabindex="0" type="number" name="LATHH" id="LATHH" value="40" min="0" max="180" style="color:black"><span>º</span>\n                    </div>\n                    <div>\n                        <input tabindex="0" type="number" name="LATMM" id="LATMM" value="26" min="0" max="59" style="color:black"><span>\'</span>\n                    </div>\n                    <div>\n                        <input tabindex="0" type="number" name="LATSS" id="LATSS" value="46" min="0" max="59.9999" style="color:black"><span>\'\'</span>\n                    </div>\n                    <div class="m-xylocator-dms-radio">\n                        <table>\n                            <tbody>\n                                <tr>\n                                    <td><input tabindex="0" type="radio" name="LATDIR" style="color:black" value="north" checked></td>\n                                    <td tabindex="0" role="text">{{translations.north}}</td>\n                                </tr>\n                                <tr>\n                                    <td><input tabindex="0" type="radio" name="LATDIR" style="color:black" value="south"></td>\n                                    <td tabindex="0" role="text">{{translations.south}}</td>\n                                </tr>\n                                </tbdoy>\n                        </table>\n                    </div>\n                </div>\n            </div>\n            <div class="m-xylocator-lonlat" id="m-xylocator-latlon">\n                <b>\n                    <p class="parcela--input" tabindex="0" style="width: 0px !important;">{{translations.longitude}}:</p>\n                </b>\n                <input type="text" tabindex="0" title="{{translations.negative}}" name="LON" id="LON" value="-3,71024" style="color:black">\n                <b>\n                    <p class="parcela--input" style="width: 0px !important;">{{translations.latitude}}:</p>\n                </b>\n                <input type="text" tabindex="0" title="{{translations.negative}}" name="LAT" id="LAT" value="40,44620" style="color:black"></br>\n                <i>\n                    <p id="m-informa" tabindex="0" class="parcela--input" style="width: 0px !important; display: contents; font-size: 13px; font-family: auto;">{{translations.negative}}</p>\n                </i>\n            </div>\n        </div>\n        <div class="button">\n            <button type="button" aria-label="{{translations.locate}}" class="represent" id="m-xylocator-loc">\n                <i class="icon-coordinates"></i> {{translations.locate}}\n            </button>\n        </div>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="m-xylocator-container">\n    <div class="m-xylocator-panel panel-codigo">\n        <div role="heading" tabindex="0" aria-label="{{translations.titleparcela}}" class="title">{{translations.titleparcela}}</div>\n        <div tabindex="0" aria-label="{{translations.plot}}" class="m-search-tabs">\n            <input type="radio" name="tabset" id="tab-search-parcela" aria-controls="m-search-tab-parcela" checked>\n            <label for="tab-search-parcela">Buscar parcela</label>\n            <input type="radio" name="tabset" id="tab-search-catastro" aria-controls="m-search-tab-catastro">\n            <label for="tab-search-catastro">Buscar Catastro</label>\n            <div class="m-search-tab-content">\n                <section id="m-search-tab-parcela" class="m-search-tab-panels">\n                    <div class="m-xylocator-datas">\n                        <div id="m-searchParams-container">\n                            <div id="m-xylocator-coordinatesSystemParcela">\n                                <b>\n                                    <p tabindex="0" role="text" id="m-provin" class="parcela--input">{{translations.province}}:</p>\n                                </b>\n                                <select role="select" tabindex="0" aria-label="{{accessibility.province}}" id="m-searchParamsProvincia-select" name="srs" class="dropdown">\n                                    <option value="0">{{translations.selectprov}}</option>\n                                    <option value="02">ALBACETE</option>\n                                    <option value="03">ALICANTE/ALACANT</option>\n                                    <option value="04">ALMERÍA</option>\n                                    <option value="01">ARABA/ÁLAVA</option>\n                                    <option value="33">ASTURIAS</option>\n                                    <option value="05">ÁVILA</option>\n                                    <option value="06">BADAJOZ</option>\n                                    <option value="07">BALEARS, ILLES</option>\n                                    <option value="08">BARCELONA</option>\n                                    <option value="48">BIZKAIA</option>\n                                    <option value="09">BURGOS</option>\n                                    <option value="10">CÁCERES</option>\n                                    <option value="11">CÁDIZ</option>\n                                    <option value="39">CANTABRIA</option>\n                                    <option value="12">CASTELLÓN/CASTELLÓ</option>\n                                    <option value="13">CIUDAD REAL</option>\n                                    <option value="14">CÓRDOBA</option>\n                                    <option value="15">CORUÑA, A</option>\n                                    <option value="16">CUENCA</option>\n                                    <option value="20">GIPUZKOA</option>\n                                    <option value="17">GIRONA</option>\n                                    <option value="18">GRANADA</option>\n                                    <option value="19">GUADALAJARA</option>\n                                    <option value="21">HUELVA</option>\n                                    <option value="22">HUESCA</option>\n                                    <option value="23">JAÉN</option>\n                                    <option value="24">LEÓN</option>\n                                    <option value="25">LLEIDA</option>\n                                    <option value="27">LUGO</option>\n                                    <option value="28">MADRID</option>\n                                    <option value="29">MÁLAGA</option>\n                                    <option value="30">MURCIA</option>\n                                    <option value="31">NAVARRA</option>\n                                    <option value="32">OURENSE</option>\n                                    <option value="34">PALENCIA</option>\n                                    <option value="35">PALMAS, LAS</option>\n                                    <option value="36">PONTEVEDRA</option>\n                                    <option value="26">RIOJA, LA</option>\n                                    <option value="37">SALAMANCA</option>\n                                    <option value="38">SANTA CRUZ DE TENERIFE</option>\n                                    <option value="40">SEGOVIA</option>\n                                    <option value="41">SEVILLA</option>\n                                    <option value="42">SORIA</option>\n                                    <option value="43">TARRAGONA</option>\n                                    <option value="44">TERUEL</option>\n                                    <option value="45">TOLEDO</option>\n                                    <option value="46">VALENCIA/VALÈNCIA</option>\n                                    <option value="47">VALLADOLID</option>\n                                    <option value="49">ZAMORA</option>\n                                    <option value="50">ZARAGOZA</option>\n                                    <option value="51">CEUTA</option>\n                                    <option value="52">MELILLA</option>\n                                </select>\n                            </div>\n                            <div id="m-xylocator-coordinatesSystemParcela">\n                                <b>\n                                    <p id="m-munici" tabindex="0" role="text" class="parcela--input">{{translations.municipality}}:</p>\n                                </b>\n                                <select id="m-searchParamsMunicipio-select" name="Municipios" class="dropdown">\n                                    <option value="0">{{translations.selectmuni}}</option>\n                                </select>\n                            </div>\n\n                            <div id="m-xylocator-dms">\n                                <b>\n                                    <p type="text" tabindex="0" class="parcela--input" style="width: 60px">{{translations.estate}}:</p>\n                                </b>\n                                <input type="text" tabindex="0" id="m-searchParamsPoligono-input" style="color:black">\n                                <b>\n                                    <p type="text" tabindex="0" class="parcela--input" style="width: auto">{{translations.plot}}:</p>\n                                </b>\n                                <input type="text" tabindex="0" id="m-searchParamsParcela-input" style="color:black">\n                            </div>\n                        </div>\n                    </div>\n                    <div class="button">\n                        <button type="button" aria-label="{{translations.search}}" tabindex="0" class="represent" id="m-searchParams-button" style="margin-right:10px">\n                            <i class="icon-position"></i> {{translations.search}}\n                        </button>\n                    </div>\n                </section>\n                <section id="m-search-tab-catastro" class="m-search-tab-panels">\n                    <div class="m-xylocator-datas">\n                        <div id="m-searchParams-container">\n                            <div id="m-xylocator-coordinatesSystemRefCatastral" tabindex="0" aria-label="{{translations.refCastatro}}">\n                                <b>\n                                    <p tabindex="0" role="text" class="refCastastrl--input">{{translations.refCastatro}}:</p>\n                                </b>\n                                <input type="text" tabindex="0" aria-label="{{accessibility.cadastre}}" id="m-refCatastral-input" style="color:black; width: 97% !important;"\n                                    maxlength="20">\n\n                                <i>\n                                    <p tabindex="0" role="text" aria-label="{{translations.notaRef}}" id="m-informa" class="parcela--input"\n                                        style="width: 0px !important; display: contents; font-size: 13px; font-family: auto;">\n                                        {{translations.notaRef}}</p>\n                                </i>\n                            </div>\n\n                        </div>\n                    </div>\n\n                    <div class="button">\n                        <button type="button" tabindex="0" aria-label="{{translations.search}}" class="represent" id="m-refCatastral-button" style="margin-left: 5px">\n                            <i class="icon-catastro"></i> {{translations.search}}\n                        </button>\n\n                        <button type="button" tabindex="0" aria-label="{{translations.consultReference}}" class="represent" id="m-consulRef-button" style="margin-left: 5px">\n                            <i class="icon-info"></i> {{translations.consultReference}}\n                        </button>\n                    </div>\n                </section>\n            </div>\n        </div>\n\n    </div>\n</div>\n'},function(e,t){e.exports='<ul id="m-ignsearchlocator-recent-results-list">\r\n    {{#each places}}\r\n    {{#if this.address}}\r\n        {{#printType this.type this.address this.id this.municipality this.cps}}\r\n        {{/printType}}\r\n    {{else}}\r\n        {{#printType this.type this.title this.id this.municipality this.cps}}\r\n        {{/printType}}\r\n    {{/if}}\r\n    {{/each}}\r\n</ul>'},function(e,t,o){},function(e,t,o){},function(e,t,o){"use strict";o.r(t);o(8),o(9);var n=o(2),a=["Estado","Isla administrativa","Comarca administrativa","Jurisdicción","Vértice Geodésico","Alineación montañosa","Montaña","Paso de montaña","Llanura","Depresión","Vertientes","Comarca geográfica","Paraje","Elemento puntual del paisaje","Saliente costero","Playa","Isla","Otro relieve costero","Curso natural de agua","Masa de agua","Curso artificial de agua","Hidrónimo puntual","Glaciares","Mar","Entrante costero y estrecho marítimo","Relieve submarino"];function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(a=n.key,r=void 0,r=function(e,t){if("object"!==i(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===i(r)?r:String(r)),n)}var a,r}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,o){var n=c(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(arguments.length<3?e:o):a.value}}).apply(this,arguments)}function c(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=m(e);if(t){var a=m(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return d(this,o)}}function d(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h,y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(i,M.impl.Control);var t,o,n,a=p(i);function i(){return r(this,i),a.apply(this,arguments)}return t=i,(o=[{key:"addTo",value:function(e,t){this.map=e,l(m(i.prototype),"addTo",this).call(this,e,t)}},{key:"setScale",value:function(e){var t=[559082264.0287178,279541132.0143589,139770566.0071794,69885283.00358972,34942641.50179486,17471320.75089743,8735660.375448715,4367830.187724357,2183915.093862179,1091957.546931089,545978.7734655447,272989.3867327723,136494.6933663862,68247.34668319309,34123.67334159654,17061.83667079827,8530.918335399136,4265.459167699568,2132.729583849784],o=t.reduce((function(t,o){return Math.abs(o-e)<Math.abs(t-e)?o:t})),n=[156543.033928041,78271.51696402048,39135.75848201023,19567.87924100512,9783.93962050256,4891.96981025128,2445.98490512564,1222.99245256282,611.49622628141,305.7481131407048,152.8740565703525,76.43702828517624,38.21851414258813,19.10925707129406,9.554628535647032,4.777314267823516,2.388657133911758,1.194328566955879,.5971642834779395][t.indexOf(o)];this.facadeMap_.getMapImpl().getView().setResolution(n)}},{key:"reproject",value:function(e,t){var o=ol.proj.get(e),n=ol.proj.get(this.map.getProjection().code),a=ol.proj.transform(t,o,n);return a=[this.normalizeNumber(t[0],a[0]),this.normalizeNumber(t[1],a[1])]}},{key:"reprojectReverse",value:function(e,t,o){return ol.proj.getTransform(t,o)(e)}},{key:"reprojectXY",value:function(e,t){var o=ol.proj.get(e),n=ol.proj.get(this.map.getProjection().code),a=ol.proj.transform(t,o,n);return a=[this.normalizeNumber(t[0],a[0]),this.normalizeNumber(t[1],a[1])]}},{key:"readFromWKT",value:function(e,t){var o=(new ol.format.WKT).readFeature(e,{dataProjection:"EPSG:4326",featureProjection:this.map.getProjection().code}),n=JSON.parse(t);return delete n.geom,o.setId("f".concat((new Date).getTime())),o.setProperties(n),this.wrapComplexFeature(o),o}},{key:"wrapComplexFeature",value:function(e){var t=e.getGeometry();if(t.getType()===M.geom.wkt.type.POLYGON||t.getType()===M.geom.wkt.type.MULTI_POLYGON){var o;o=t.getType()===M.geom.wkt.type.POLYGON?t.getInteriorPoint():t.getInteriorPoints();var n=new ol.geom.GeometryCollection([o,t]);e.setGeometry(n)}}},{key:"normalizeNumber",value:function(e,t){var o=e;return 0!==e&&(o=parseFloat(t.toFixed(9))),o}}])&&s(t.prototype,o),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(),v=o(3),g=o.n(v),f=o(4),b=o.n(f),x=o(5),S=o.n(x),P=o(6),C=o.n(P),E=o(0),L=o(1),w={en:E,es:L},R=function(){var e="es";return"function"==typeof M.language.getLang&&(e=M.language.getLang()),e},T=function(e){return"es"===e||"en"===e?w[e]:M.language.getTranslation(e).ignsearchlocator},N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:R(),o=T(t),n="";return M.utils.isNullOrEmpty(o)?console.warn("The translation '".concat(t,"' has not been defined.")):n=e.split(".").reduce((function(e,t){return e[t]}),o),n},k=o(7),_=o.n(k);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(a=n.key,i=void 0,i=function(e,t){if("object"!==A(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!==A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===A(i)?i:String(i)),n)}var a,i}function q(e,t){return(q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=j(e);if(t){var a=j(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return D(this,o)}}function D(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var F=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q(e,t)}(i,M.Control);var t,o,n,a=B(i);function i(e){var t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,u=arguments.length>7?arguments[7]:void 0,p=arguments.length>8?arguments[8]:void 0,d=arguments.length>9?arguments[9]:void 0,m=arguments.length>10?arguments[10]:void 0,h=arguments.length>11?arguments[11]:void 0,v=arguments.length>12?arguments[12]:void 0,g=arguments.length>13?arguments[13]:void 0,f=!(arguments.length>14&&void 0!==arguments[14])||arguments[14],b=arguments.length>15?arguments[15]:void 0,x=arguments.length>16?arguments[16]:void 0,S=arguments.length>17?arguments[17]:void 0,P=arguments.length>18?arguments[18]:void 0,C=arguments.length>19?arguments[19]:void 0,E=arguments.length>20?arguments[20]:void 0,L=arguments.length>21?arguments[21]:void 0,w=arguments.length>22?arguments[22]:void 0,R=arguments.length>23?arguments[23]:void 0,T=arguments.length>24?arguments[24]:void 0,k=arguments.length>25?arguments[25]:void 0,_=arguments.length>26?arguments[26]:void 0,A=arguments.length>27?arguments[27]:void 0;O(this,i),M.utils.isUndefined(y)&&M.exception(N("impl"));var I=new y;return(t=a.call(this,I,"IGNSearchLocator")).servicesToSearch=e,t.ConsultaMunicipioCodigos_=o,t.DNPPP_url_=n,t.CPMRC_url_=r,t.catastroWMS=s,t.selectProvincias=null,t.selectMunicipios=null,t.inputPoligono=null,t.inputParcela=null,t.inputRefCatastral=null,t.maxResults=l,t.noProcess=c,t.countryCode=u,t.urlCandidates=p,t.urlFind=d,t.urlReverse=m,t.urlPrefix=h,t.urlAssistant=v,t.urlDispatcher=g,t.resultVisibility_=f,t.nomenclatorSearchType=R,t.searchPosition=E,t.reverse=b,t.reverseActivated=!1,t.locationID=x,t.requestStreet=S,t.geocoderCoords=P,t.urlParse=null,t.isXYLocatorActive=!1,t.zoom=C,t.position=L,t.parcela_prov=null,t.parcela_mun=null,t.parcela_pol=null,t.parcela_parc=null,t.xytype=null,t.xydata=null,t.xylon=null,t.xylat=null,t.xylathh=null,t.xylatmm=null,t.xylatss=null,t.xylonhh=null,t.xylonmm=null,t.xylonss=null,t.xyutmx=null,t.xyutmy=null,t.provincecode=null,t.municipalityvalue=null,t.pointStyle=w,t.inputRC_=null,t.helpUrl=T,t.cadastre=k,t.searchCoordinatesXYZ=_,t.order=A,t}return t=i,(o=[{key:"createView",value:function(e){var t=this;return this.map=e,this.destroyMapLayers(),new Promise((function(e){var o=M.template.compileSync(g.a,{vars:{translations:{direccion:N("direccion"),obtener:N("obtener"),buscparcela:N("buscparcela"),busccoord:N("busccoord"),borrarresult:N("borrarresult"),tooltip_input:N("tooltip_input")}}});t.accessibilityTab(o),t.html=o,t.resultsBox=o.querySelector("#m-ignsearchlocator-results"),t.searchInput=t.html.querySelector("#m-ignsearchlocator-search-input"),o.querySelector("#m-ignsearchlocator-clear-button").addEventListener("click",t.clearResultsAndGeometry.bind(t)),!1===t.cadastre?o.querySelector("#m-ignsearchlocator-parcela-button").style.display="none":o.querySelector("#m-ignsearchlocator-parcela-button").addEventListener("click",t.openParcela.bind(t)),!1===t.searchCoordinatesXYZ?o.querySelector("#m-ignsearchlocator-xylocator-button").style.display="none":o.querySelector("#m-ignsearchlocator-xylocator-button").addEventListener("click",t.openXYLocator.bind(t)),o.querySelector("#m-ignsearchlocator-search-input").addEventListener("keyup",(function(e){return t.createTimeout(e)})),o.querySelector("#m-ignsearchlocator-search-input").addEventListener("click",(function(){"rgb(113, 167, 211)"!==document.getElementById("m-ignsearchlocator-xylocator-button").style.backgroundColor&&"rgb(113, 167, 211)"!==document.getElementById("m-ignsearchlocator-parcela-button").style.backgroundColor||(t.clearResults(),t.activationManager(!1,"m-ignsearchlocator-xylocator-button"),t.activationManager(!1,"m-ignsearchlocator-parcela-button")),document.getElementById("m-ignsearchlocator-search-input").value||document.getElementById("m-ignsearchlocator-recent-results-list")||t.openRecentsResults()})),o.querySelector("#m-ignsearchlocator-search-input").addEventListener("keydown",(function(){clearTimeout(h)})),o.querySelector("#m-ignsearchlocator-search-input").addEventListener("keydown",(function(){clearTimeout(h)})),o.querySelector("#m-ignsearchlocator-locate-button").addEventListener("click",t.activateDeactivateReverse.bind(t)),document.querySelector(".ign-searchlocator-panel>.m-panel-btn").addEventListener("click",t.clearResults.bind(t)),t.clickReverseEvent=t.map.on(M.evt.CLICK,(function(e){return t.showReversePopUp(e)})),t.changePlaceholder(),t.reverse||(o.querySelector("#m-ignsearchlocator-locate-button").style.display="none"),"TC"===t.position&&(document.querySelector(".ign-searchlocator-panel").style="position: relative; left: calc(50vw - 210px);"),t.on(M.evt.ADDED_TO_MAP,(function(){if(t.locationID&&t.locationID.length>0&&(t.point=new M.style.Point({radius:5,icon:{form:"none",class:"g-cartografia-pin",radius:12,rotation:0,rotate:!1,offset:[0,-12],color:"#f00",opacity:1}}),t.simple=new M.style.Polygon({fill:{color:"black",opacity:0}}),t.drawNomenclatorResult(t.locationID,!1)),t.requestStreet&&t.requestStreet.length>0&&(M.proxy(!1),M.remote.get(t.requestStreet).then((function(e){var o=e.text.substring(9,e.text.length-1);t.map.removeLayers(t.clickedElementLayer);var n=JSON.parse(o),a=t.getImpl().readFromWKT(n.geom,o);t.coordinates="".concat(n.lat,", ").concat(n.lng),t.clickedElementLayer=new M.layer.GeoJSON({name:N("searchresult"),source:{type:"FeatureCollection",features:[]}},{displayInLayerSwitcher:!1}),t.clickedElementLayer.displayInLayerSwitcher=!1,t.createGeometryStyles(),t.map.addLayers(t.clickedElementLayer);var i=a.getGeometry().getType();if("Point"===i&&t.clickedElementLayer.setStyle(t.point),(i.indexOf("Polygon")>-1||i.indexOf("Collection")>-1)&&t.clickedElementLayer.setStyle(new M.style.Polygon({fill:{color:"#3399CC",opacity:0},stroke:{color:"#3399CC",width:2}})),t.clickedElementLayer.setZIndex(1e19),t.resultVisibility_||t.clickedElementLayer.setStyle(t.simple),setTimeout((function(){t.clickedElementLayer.getImpl().getOL3Layer().getSource().addFeature(a),t.zoomInLocation("g",i,t.zoom)}),200),"callejero"===n.type||"portal"===n.type){var r=t.createFullAddress(n),s=[n.lat,n.lng],l=n.state;t.showSearchPopUp(r,s,l,{fake:!0})}M.proxy(!0)})).catch((function(e){M.proxy(!0)}))),t.geocoderCoords&&2===t.geocoderCoords.length){t.activateDeactivateReverse();var e=t.getImpl().reproject("EPSG:4326",t.geocoderCoords);t.showReversePopUp({coord:e,fake:!0})}})),e(o)}))}},{key:"openRecentsResults",value:function(){var e=this;document.getElementById("m-ignsearchlocator-results").style="width: 347px";var t=window.localStorage.getItem("recents");if(t&&t.length>0){var o=M.template.compileSync(_.a,{vars:{places:JSON.parse(t)}});o.querySelectorAll("li").forEach((function(t){t.addEventListener("click",(function(){e.goToLocation(t,!0)}))})),this.resultsBox.appendChild(o)}}},{key:"destroyMapLayers",value:function(){for(var e=0;e<this.map.getLayers().length;e+=1)this.map.getLayers()[e].name===N("searchresult")&&(this.map.removeLayers(this.map.getLayers()[e]),this.map.removePopup())}},{key:"activateDeactivateReverse",value:function(){this.reverseActivated?(this.reverseActivated=!1,document.querySelector("#m-ignsearchlocator-locate-button span").style.color="#7A7A73",document.removeEventListener("keyup",this.checkEscKey),document.getElementsByTagName("body")[0].style.cursor="auto"):(this.invokeEscKey(),this.reverseActivated=!0,document.querySelector("#m-ignsearchlocator-locate-button span").style.color="#71a7d3",document.addEventListener("keyup",this.checkEscKey.bind(this)),document.getElementsByTagName("body")[0].style.cursor="url(".concat(M.utils.concatUrlPaths([M.config.THEME_URL,"/img/pushpin.svg"]),") 0 20, auto"))}},{key:"checkEscKey",value:function(e){"Escape"===e.key&&(this.reverseActivated=!1,document.querySelector("#m-ignsearchlocator-locate-button span").style.color="#7A7A73",document.removeEventListener("keyup",this.checkEscKey),document.getElementsByTagName("body")[0].style.cursor="auto")}},{key:"invokeEscKey",value:function(){try{document.dispatchEvent(new window.KeyboardEvent("keyup",{key:"Escape",keyCode:27,code:"",which:69,shiftKey:!1,ctrlKey:!1,metaKey:!1}))}catch(e){console.error(e)}}},{key:"showReversePopUp",value:function(e){var t=this;if(this.reverseActivated){var o=this.map.getProjection().code,n=this.getImpl().reprojectReverse([e.coord[0],e.coord[1]],o,"EPSG:4258"),a="lon=".concat(n[0],"&lat=").concat(n[1]),i="".concat(this.urlReverse,"?").concat(a),r=e.coord;this.geocoderCoords=n;var s=[n[1],n[0]],l="";M.proxy(!1),M.remote.get(i).then((function(o){if(null!==o.text){var n=JSON.parse(o.text);l=t.createFullAddress(n)}else l=N("exception.exists");t.showPopUp(l,r,s,null,!0,e,!1)})),M.proxy(!0)}}},{key:"createTimeout",value:function(e){var t=this;clearTimeout(h),h=setTimeout((function(){return t.searchInputValue(e)}),500)}},{key:"getActivationButton",value:function(e){return e.querySelector(".m-ignsearchlocator button")}},{key:"equals",value:function(e){return e instanceof i}},{key:"searchInputValue",value:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];document.getElementById("m-ignsearchlocator-results").style="width: 347px";var n=e.target.value.replace(","," ");this.searchValue=n,n.length<=2?this.resultsBox.innerHTML="":(this.resultsBox.innerHTML="",this.resultsBox.classList.add("g-cartografia-spinner"),this.resultsBox.style.fontSize="24px",this.nomenclatorCandidates=[],this.geocoderCandidates=[],this.nomenclatorFinished=!1,this.candidatesFinished=!1,this.getNomenclatorData(n,this.nomenclatorCandidates).then((function(){t.nomenclatorFinished=!0,t.showCandidatesResults(o)})),this.getCandidatesData(n,this.geocoderCandidates).then((function(){t.candidatesFinished=!0,t.showCandidatesResults(o)})))}},{key:"showCandidatesResults",value:function(e){var t=this;this.allCandidates=[];for(var o=0;o<this.searchPosition.split(",").length;o+=1){if("nomenclator"===this.searchPosition.split(",")[o])for(var n=0;n<this.nomenclatorCandidates.length;n+=1)this.allCandidates.push(this.nomenclatorCandidates[n]);if("geocoder"===this.searchPosition.split(",")[o])for(var a=0;a<this.geocoderCandidates.length;a+=1)this.allCandidates.push(this.geocoderCandidates[a])}if(0===this.allCandidates.length&&this.nomenclatorFinished&&this.candidatesFinished){this.resultsBox.innerHTML="",this.resultsBox.classList.remove("g-cartografia-spinner"),this.resultsBox.style.fontSize="1em";var i=document.createElement("p"),r=document.createTextNode(N("exception.noresults"));i.classList.add("m-ignsearchlocator-noresults"),i.appendChild(r),this.resultsBox.appendChild(i)}else if(this.allCandidates.length>0){this.resultsBox.innerHTML="",this.resultsBox.classList.remove("g-cartografia-spinner"),this.resultsBox.style.fontSize="1em";var s=M.template.compileSync(b.a,{vars:{places:this.allCandidates}});this.accessibilityTab(s);var l=s.querySelectorAll("li");l.forEach((function(e){e.addEventListener("click",(function(){t.goToLocation(e)}))})),!0===e&&l.length>0&&l.item(0).click(),this.resultsBox.appendChild(s)}}},{key:"drawGeocoderResult",value:function(e){var t=this;this.map.removeLayers(this.clickedElementLayer);var o=e,n=JSON.parse(o),a=this.getImpl().readFromWKT(n.geom,o),i=JSON.parse(o);this.coordinates="".concat(i.lat,", ").concat(i.lng),this.clickedElementLayer=new M.layer.GeoJSON({name:N("searchresult"),source:{type:"FeatureCollection",features:[]}},{displayInLayerSwitcher:!1}),this.clickedElementLayer.displayInLayerSwitcher=!1,this.map.addLayers(this.clickedElementLayer);var r=a.getGeometry().getType();if("Point"===r&&this.clickedElementLayer.setStyle(this.point),(r.indexOf("Polygon")>-1||r.indexOf("Collection")>-1)&&this.clickedElementLayer.setStyle(new M.style.Polygon({fill:{color:"#3399CC",opacity:0},stroke:{color:"#3399CC",width:2}})),this.clickedElementLayer.setZIndex(1e17),this.resultVisibility_||this.clickedElementLayer.setStyle(this.simple),setTimeout((function(){t.clickedElementLayer.getImpl().getOL3Layer().getSource().addFeature(a),t.zoomInLocation("g",r,t.zoom)}),200),"callejero"===i.type||"portal"===i.type){var s=this.createFullAddress(i),l=[i.lat,i.lng],c=i.state;this.showSearchPopUp(s,l,c)}else void 0!==this.popup&&this.map.removePopup(this.popup)}},{key:"createFullAddress",value:function(e){var t=null===e.tip_via||void 0===e.tip_via?"":e.tip_via,o=null===e.address||void 0===e.address?"":e.address,n=null===e.portalNumber||void 0===e.portalNumber||0===e.portalNumber?"":e.portalNumber,a=null===e.muni||void 0===e.muni?"":e.muni,i=null===e.province||void 0===e.province?"":e.province;return"".concat(t," ").concat(o," ").concat(n,", ").concat(a.toUpperCase(),", ").concat(i.toUpperCase())}},{key:"drawNomenclatorResult",value:function(e){var t=this,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.requestStreet="",this.requestPlace=M.utils.addParameters(this.urlDispatcher,{request:"OpenQuerySource",query:'<ogc:Filter><ogc:FeatureId fid="'.concat(e,'"/></ogc:Filter>'),sourcename:"".concat(this.urlPrefix,"communicationsPoolServlet/sourceAccessWFS-INSPIRE-NGBE.rdf"),outputformat:"application/json"}),this.locationID=e,M.remote.get(this.requestPlace).then((function(e){var n=JSON.parse(e.text).results[0].location,a=JSON.parse(e.text).results[0].title,i=n.split(" "),r=parseFloat(i[0]),s=parseFloat(i[1]);t.map.removeLayers(t.clickedElementLayer);var l={name:N("searchresult"),source:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[s,r]},properties:{name:a}}]}};t.clickedElementLayer=new M.layer.GeoJSON(l,{displayInLayerSwitcher:!1}),t.clickedElementLayer.displayInLayerSwitcher=!1,t.clickedElementLayer.setStyle(t.point),t.clickedElementLayer.setZIndex(1e19),t.resultVisibility_||t.clickedElementLayer.setStyle(t.simple),t.map.addLayers(t.clickedElementLayer),!0===o&&t.zoomInLocation("n","Point",t.zoom,[s,r])}))}},{key:"getCandidatesData",value:function(e,t){var o=this,n=window.encodeURIComponent(e);return new Promise((function(e){if("n"!==o.servicesToSearch){var a="q=".concat(n,"&limit=").concat(o.maxResults+5,"&no_process=").concat(o.noProcess);a+="&countrycode=".concat(o.countryCode,"&autocancel=true");var i="".concat(o.urlCandidates,"?").concat(a);M.proxy(!1),M.remote.get(i).then((function(o){for(var n=JSON.parse(o.text.substring(9,o.text.length-1)),a=0;a<n.length;a+=1)t.push(n[a]);e()})),M.proxy(!0)}else e()}))}},{key:"getNomenclatorData",value:function(e,t){var o=this,n=window.encodeURIComponent(e);return new Promise((function(e){if("g"!==o.servicesToSearch){var a="maxresults=".concat(o.maxResults-5,"&name_equals=").concat(n),i="".concat(o.urlAssistant,"?").concat(a);M.remote.get(i).then((function(n){for(var a=(""!==n.text&&null!==n.text?JSON.parse(n.text):{results:[]}).results,i=0;i<a.length;i+=1)o.nomenclatorSearchType.indexOf(a[i].type)>=0&&t.push(a[i]);for(var r=0;r<t.length;r+=1)if("Núcleos de población"===t[r].type){var s=t.splice(r,1);t.splice(0,0,s)}t.forEach((function(e){e.cps=!0})),e()}))}else e()}))}},{key:"getFindData",value:function(e,t){var o=this;return new Promise((function(n){var a,i,r,s,l;if(t.forEach((function(t){e.getAttribute("id")===t.id&&(a="&id=".concat(t.id),i="&type=".concat(t.type),r=0!==t.portalNumber&&void 0!==t.portalNumber?"&portal=".concat(t.portalNumber):"",s=""!==t.tip_via?"&tip_via=".concat(t.tip_via):"")})),l=e.innerHTML,e.innerHTML.includes("(")){var c=e.innerHTML.indexOf("(");l=e.innerHTML.substring(0,c)}var u="".concat(i).concat(s).concat(a).concat(r),p="".concat(o.urlFind,"?q=").concat(l).concat(u);o.urlParse=p,o.requestStreet=p,o.locationID="",M.proxy(!1),M.remote.get(p).then((function(e){var t=e.text.substring(9,e.text.length-1);n(t)})),M.proxy(!0)}))}},{key:"goToLocation",value:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.querySelector("#info").innerHTML;this.html.querySelector("#m-ignsearchlocator-search-input").value=n,this.currentElement=e;var a=o?JSON.parse(window.localStorage.getItem("recents")):this.allCandidates,i=this.findClickedItem(e,a);this.createGeometryStyles(),Object.prototype.hasOwnProperty.call(i,"address")?this.getFindData(e,a).then((function(e){t.drawGeocoderResult(e),e.includes('"tip_via":null')&&(e.includes('"type":"Municipio"')||e.includes('"type":"municipio"')||e.includes('"type":"Provincia"')||e.includes('"type":"provincia"')||e.includes('"type":"comunidad autonoma"'))&&t.map.removePopup()})):this.drawNomenclatorResult(i.id),this.resultsBox.innerHTML=""}},{key:"zoomInLocation",value:function(e,t,o,n){var a=this;if(this.resultsList=document.getElementById("m-ignsearchlocator-results-list"),this.clickedElementLayer instanceof M.layer.Vector)if("n"===e&&"Point"===t)this.clickedElementLayer.calculateMaxExtent().then((function(e){a.map.setBbox(e),a.map.setZoom(o),a.fire("ignsearchlocator:entityFound",[e])}));else{var i=this.clickedElementLayer.getImpl().getOL3Layer().getSource().getExtent();this.map.setBbox(i),this.fire("ignsearchlocator:entityFound",[i])}}},{key:"findClickedItem",value:function(e,t){var o=t.filter((function(t){return t.id===e.getAttribute("id")}))[0];return this.setRecents(o),o}},{key:"checkDuplicateRecent",value:function(e){var t=JSON.parse(window.localStorage.getItem("recents")),o=!1;return t.forEach((function(t){t.id===e.id&&(o=!0)})),o}},{key:"setRecents",value:function(e){var t=JSON.parse(window.localStorage.getItem("recents"));t&&0!==t.length?this.checkDuplicateRecent(e)||(5===t.length?(t.shift(),t.push(e)):t.push(e)):t=[e],window.localStorage.setItem("recents",JSON.stringify(t))}},{key:"searchCoordinates",value:function(e){return new Promise((function(e){e()}))}},{key:"clearResults",value:function(){this.activationManager(!1,"m-ignsearchlocator-xylocator-button"),this.activationManager(!1,"m-ignsearchlocator-parcela-button"),this.searchInput.value="",this.resultsBox.innerHTML="",this.searchValue="",this.map.removeLayers(this.coordinatesLayer),this.map.removeLayers(this.clickedElementLayer),this.map.removePopup(this.map.getPopup())}},{key:"clearResultsAndGeometry",value:function(){this.clearResults(),this.activationManager(!1,"m-ignsearchlocator-xylocator-button"),this.activationManager(!1,"m-ignsearchlocator-parcela-button"),void 0!==this.clickedElementLayer&&this.clickedElementLayer.setStyle(this.simple),this.map.removePopup(this.popup,[this.lng,this.lat]),this.xytype=null,this.xydata=null,this.xylon=null,this.xylat=null,this.xylathh=null,this.xylatmm=null,this.xylatss=null,this.xylonhh=null,this.xylonmm=null,this.xylonss=null,this.xyutmx=null,this.xyutmy=null,this.provincecode=null,this.selectMunicipios=null,this.inputPoligono=null,this.inputParcela=null,this.inputRefCatastral=null}},{key:"onRCSearch",value:function(e){if(e.preventDefault(),this.inputRefCatastral=document.querySelector("#m-refCatastral-input"),this.inputRC_=this.element_.querySelector("#m-refCatastral-input").value.trim(),"keyup"!==e.type||13===e.keyCode){var t=this.inputRC_;if(M.utils.isNullOrEmpty(t))M.dialog.info(N("RCnull"));else{t=t.substr(0,14);var o=M.utils.addParameters(this.CPMRC_url_,{Provincia:"",Municipio:"",SRS:this.map.getProjection().code,RC:t});this.search_(o,this.showResults_),this.clearResults(),this.activationManager(!1,"m-ignsearchlocator-parcela-button")}}}},{key:"onRCConsult",value:function(e){e.preventDefault(),document.body.style.cursor="crosshair",this.clearResults(),this.activationManager(!1,"m-ignsearchlocator-parcela-button"),this.map.on(M.evt.CLICK,this.buildUrl_,this)}},{key:"buildUrl_",value:function(e){var t=this,o=this.map.getProjection().code;M.remote.get(this.catastroWMS,{SRS:o,Coordenada_X:e.coord[0],Coordenada_Y:e.coord[1]}).then((function(o){t.showInfoFromURL_(o,e.coord),t.map.un(M.evt.CLICK,t.buildUrl_,t),document.body.style.cursor=""}),{jsonp:!0})}},{key:"showInfoFromURL_",value:function(e,t){var o=this;if(200===e.code&&!1===e.error){var n=[],a=e.text,i=this.formatInfo_(a);n.push(i);var r={icon:"g-cartografia-pin",title:this.POPUP_TITLE,content:n.join("")},s=this.map.getPopup();if(M.utils.isNullOrEmpty(s))(s=new M.Popup).addTab(r),this.map.addPopup(s,t);else if(s.getCoordinate()[0]===t[0]&&s.getCoordinate()[1]===t[1]){var l=!1;s.getTabs().forEach((function(e){e.title!==o.POPUP_TITLE?l=!0:s.removeTab(e)})),l?s.addTab(r):((s=new M.Popup).addTab(r),this.map.addPopup(s,t))}else(s=new M.Popup).addTab(r),this.map.addPopup(s,t)}else this.map.removePopup(),M.dialog.error(N("errorConexion"))}},{key:"formatInfo_",value:function(e){var t,o,n,a,i="",r=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("consulta_coordenadas")[0];if("1"===r.getElementsByTagName("control")[0].getElementsByTagName("cuerr")[0].childNodes[0].nodeValue)o=N("noInfo");else{var s=r.getElementsByTagName("coordenadas")[0].getElementsByTagName("coord")[0],l=s.getElementsByTagName("pc")[0],c=l.getElementsByTagName("pc1")[0].childNodes[0].nodeValue,u=l.getElementsByTagName("pc2")[0].childNodes[0].nodeValue;n=c.substring(0,2),a=c.substring(2,5),t=s.getElementsByTagName("ldt")[0].childNodes[0].nodeValue,o=c+u,i="https://www1.sedecatastro.gob.es/CYCBienInmueble/OVCListaBienes.aspx?del==".concat(n,"&mun=").concat(a,"&rc1=").concat(c,"&rc2=").concat(u)}var p="".concat(M.utils.beautifyAttribute(N("informacionCatastral")),"\n    <div class='divinfo'>\n    <table class='mapea-table'>\n    <tbody>\n    <tr><td class='header' colspan='4'></td></tr>\n    <tr><td class='key'><b>").concat(M.utils.beautifyAttribute(N("reference")),"</b></td><td class='value'></b>\n    <a href='").concat(i,"' target='_blank'>").concat(o,"</a></td></tr>\n    <tr><td class='key'><b>").concat(M.utils.beautifyAttribute(N("description")),"</b></td>\n    <td class='value'>").concat(t,"</td></tr>\n    </tbody></table></div>");return o.toLowerCase().indexOf(N("noReference"))>-1&&(p="".concat(M.utils.beautifyAttribute(N("informacionCatastral")),"\n      <div class='divinfo'>\n      <table class='mapea-table'>\n      <tbody>\n      <tr><td class='header' colspan='4'></td></tr>\n      <tr><td class='key' colspan='4'><b>").concat(o,"</b></td></tr>\n      </tbody></table>\n      </div>")),p}},{key:"search_",value:function(e,t){var o=this;M.remote.get(e).then((function(e){o.acceptOVCSW(e)&&t.call(o,e.xml)}))}},{key:"showResults_",value:function(e){var t,o=this;t=this.parseRCResultsForTemplate_(e,!1),Promise.resolve(t).then((function(e){o.drawGeocoderResultRC(e)}))}},{key:"parseRCResultsForTemplate_",value:function(e,t){var o=this.parseCPMRCResults(e);return!0===t?this.rcResults_.unshift(o):this.rcResults_=[o],{docs:this.rcResults_,total:this.rcResults_.length,partial:!1,notResutls:!1,query:this.inputRC_.value}}},{key:"drawGeocoderResultRC",value:function(e){this.map.removeLayers(this.clickedElementLayer);var t=e.docs[0];this.coordinates="".concat(t.coords[0].xcen,", ").concat(t.coords[0].ycen);var o=[parseFloat(t.coords[0].xcen),parseFloat(t.coords[0].ycen)];this.locator_(o,this.point);var n=t.attributes[1].value;this.showSearchPopUpRC(n,o,1,{fake:!0});var a=o[1],i=parseFloat(o[0]),r=parseFloat(a);this.map.setCenter("".concat(i,",").concat(r,"*false"))}},{key:"openParcela",value:function(){var e=this;if(this.resultsBox.innerHTML.includes("coordinatesSystemParcela"))this.clearResults(),this.activationManager(!1,"m-ignsearchlocator-parcela-button");else{this.clearResults(),this.resultsBox.innerHTML.indexOf("coordinatesSystemParcela")&&this.activationManager(!1,"m-ignsearchlocator-xylocator-button"),this.activationManager(!0,"m-ignsearchlocator-parcela-button"),document.getElementById("m-ignsearchlocator-results").style="width: 258px !important; min-width: 258px !important;";var t=M.template.compileSync(C.a,{vars:{translations:{titleparcela:N("titleparcela"),province:N("province"),municipality:N("municipality"),selectmuni:N("selectmuni"),selectprov:N("selectprov"),estate:N("estate"),plot:N("plot"),titlerefCatastral:N("titlerefCatastral"),refCastatro:N("refCastatro"),search:N("search"),consultReference:N("consultReference"),notaRef:N("notaRef")},accessibility:{province:N("accessibility.province"),town:N("accessibility.town"),estate:N("accessibility.estate"),plot:N("accessibility.plot"),cadastre:N("accessibility.cadastre"),srs:N("accessibility.srs")}}});this.accessibilityTab(t),null===this.provincecode?(this.selectProvincias=t.querySelector("select#m-searchParamsProvincia-select"),this.selectProvincias.addEventListener("change",(function(t){return e.onProvinciaSelect(t,null)}))):(t.querySelector("select#m-searchParamsProvincia-select").value=this.provincecode,this.selectProvincias=t.querySelector("select#m-searchParamsProvincia-select"),this.onProvinciaSelect(null,this.provincecode,this.selectMunicipios),this.selectProvincias.addEventListener("change",(function(t){return e.onProvinciaSelect(t,null,null)}))),null===this.selectMunicipios?this.selectMunicipios=t.querySelector("#m-searchParamsMunicipio-select"):t.querySelector("#m-searchParamsMunicipio-select").value=this.selectMunicipios.value,null===this.inputPoligono?this.inputPoligono=t.querySelector("#m-searchParamsPoligono-input"):t.querySelector("#m-searchParamsPoligono-input").value=this.inputPoligono.value,null===this.inputParcela?this.inputParcela=t.querySelector("#m-searchParamsParcela-input"):t.querySelector("#m-searchParamsParcela-input").value=this.inputParcela.value,null===this.inputRefCatastral?this.inputRefCatastral=t.querySelector("#m-refCatastral-input"):t.querySelector("#m-refCatastral-input").value=this.inputRefCatastral.value,t.querySelector("button#m-searchParams-button").addEventListener("click",(function(t){return e.onParamsSearch(t)})),t.querySelector("button#m-refCatastral-button").addEventListener("click",this.onRCSearch.bind(this)),t.querySelector("button#m-consulRef-button").addEventListener("click",this.onRCConsult.bind(this)),this.resultsBox.appendChild(t),"es"===M.language.getLang()&&(document.querySelectorAll("p.parcela--input")[0].style="width: 71px",document.querySelectorAll("p.parcela--input")[1].style="width: 71px",document.querySelector("#m-searchParamsProvincia-select").style="width: 68%",document.querySelector("#m-searchParamsMunicipio-select").style="width: 68%")}}},{key:"onParamsSearch",value:function(e){var t=this;if(e.preventDefault(),this.inputPoligono=document.querySelector("#m-searchParamsPoligono-input"),this.inputParcela=document.querySelector("#m-searchParamsParcela-input"),"keyup"!==e.type||13===e.keyCode){if(M.utils.isNullOrEmpty(this.selectProvincias.value)||"0"===this.selectProvincias.value)return void M.dialog.info(N("debeprov"));if(M.utils.isNullOrEmpty(this.selectMunicipios.value)||"0"===document.querySelector("#m-searchParamsMunicipio-select").value)return void M.dialog.info(N("debemuni"));if(M.utils.isNullOrEmpty(this.inputPoligono.value))return void M.dialog.info(N("debepoli"));if(M.utils.isNullOrEmpty(this.inputParcela.value))return void M.dialog.info(N("debeparce"));this.provincecode=this.selectProvincias.value,this.selectMunicipios=document.querySelector("#m-searchParamsMunicipio-select"),this.municipalityvalue=this.selectMunicipios.value;var o=M.utils.addParameters(this.DNPPP_url_,{CodigoProvincia:this.selectProvincias.value,CodigoMunicipio:this.selectMunicipios.value,CodigoMunicipioINE:"",Poligono:this.inputPoligono.value,Parcela:this.inputParcela.value});M.remote.get(o).then((function(e){t.acceptOVCSW(e)&&t.parseParamsResultsForTemplate_(e.xml),t.clearResults(),t.activationManager(!1,"m-ignsearchlocator-parcela-button")}))}}},{key:"parseParamsResultsForTemplate_",value:function(e){var t,o=this,n=e.getElementsByTagName("consulta_dnp")[0],a=n.getElementsByTagName("lrcdnp"),i=(t=a.length>0?a[0].getElementsByTagName("rcdnp")[0].getElementsByTagName("rc")[0]:n.getElementsByTagName("bico")[0].getElementsByTagName("bi")[0].getElementsByTagName("idbi")[0].getElementsByTagName("rc")[0]).getElementsByTagName("pc1")[0].childNodes[0].nodeValue,r=t.getElementsByTagName("pc2")[0].childNodes[0].nodeValue,s=M.utils.addParameters(this.CPMRC_url_,{Provincia:"",Municipio:"",SRS:this.map.getProjection().code,RC:i+r});return M.remote.get(s).then((function(e){if(o.acceptOVCSW(e)){var t=o.parseCPMRCResults(e.xml),n=t.coords[0].xcen,a=t.coords[0].ycen;o.locator_([n,a],null)}}))}},{key:"parseCPMRCResults",value:function(e){var t=e.getElementsByTagName("consulta_coordenadas")[0].getElementsByTagName("coordenadas")[0].getElementsByTagName("coord")[0],o=t.getElementsByTagName("pc")[0],n=o.getElementsByTagName("pc1")[0].childNodes[0].nodeValue,a=o.getElementsByTagName("pc2")[0].childNodes[0].nodeValue,i=t.getElementsByTagName("geo")[0],r=i.getElementsByTagName("xcen")[0].childNodes[0].nodeValue,s=i.getElementsByTagName("ycen")[0].childNodes[0].nodeValue,l=i.getElementsByTagName("srs")[0].childNodes[0].nodeValue;return{attributes:[{key:"Referencia Catastral",value:n+a},{key:"Descripción",value:t.getElementsByTagName("ldt")[0].childNodes[0].nodeValue}],rcId:"rc_".concat(n).concat(a),coords:[{xcen:r,ycen:s,srs:l}]}}},{key:"acceptOVCSW",value:function(e){var t=!0;try{if(200===e.code&&!1===e.error){var o=e.xml.childNodes[0],n=o.getElementsByTagName("control")[0].getElementsByTagName("cuerr")[0],a="0";if(void 0!==n&&(a=n.childNodes[0].nodeValue),"1"===a){var i=o.getElementsByTagName("lerr")[0].getElementsByTagName("err")[0].getElementsByTagName("des")[0].childNodes[0].nodeValue;this.element_.classList.remove(this.SEARCHING_CLASS),t=!1,M.dialog.info(i)}}else t=!1,M.dialog.error(N("exception.mapeaerror"))}catch(e){t=!1,M.exception("La respuesta no es un JSON válido: ".concat(e,"."))}return t}},{key:"onProvinciaSelect",value:function(e,t,o){var n=this,a=null;"0"!==(a=null!=e?e.target.value:t)?(void 0!==this.element_.getElementsByTagName("select")["m-searchParamsMunicipio-select"]&&this.clearMunicipiosSelect(),M.remote.get(this.ConsultaMunicipioCodigos_,{CodigoProvincia:a,CodigoMunicipio:"",CodigoMunicipioIne:""}).then((function(e){n.loadMunicipiosSelect(e,o)}))):this.clearMunicipiosSelect()}},{key:"loadMunicipiosSelect",value:function(e,t){if(200===e.code&&!1===e.error){for(var o=e.xml.getElementsByTagName("consulta_municipiero")[0].getElementsByTagName("municipiero")[0].getElementsByTagName("muni"),n=this.element_.getElementsByTagName("select")["m-searchParamsMunicipio-select"],a=0;a<o.length;a+=1){var i=document.createElement("option"),r=o[a].getElementsByTagName("locat")[0];i.value=r.getElementsByTagName("cmc")[0].childNodes[0].nodeValue,i.innerHTML=o[a].getElementsByTagName("nm")[0].childNodes[0].nodeValue,n.appendChild(i)}null!=t&&(document.querySelector("#m-searchParamsMunicipio-select").value=this.municipalityvalue)}else M.dialog.error(N("exception.mapeaerror"))}},{key:"clearMunicipiosSelect",value:function(){for(var e=this.element_.getElementsByTagName("select")["m-searchParamsMunicipio-select"];e.firstChild;)e.removeChild(e.firstChild);var t=document.createElement("option");t.value="0",t.innerHTML=N("selectmuni"),e.appendChild(t)}},{key:"openXYLocator",value:function(){var e=this;if(this.resultsBox.innerHTML.includes("coordinatesSystemXYLocator"))this.clearResults(),this.activationManager(!1,"m-ignsearchlocator-xylocator-button");else{this.clearResults(),this.resultsBox.innerHTML.indexOf("coordinatesSystemParcela")&&this.activationManager(!1,"m-ignsearchlocator-parcela-button"),this.activationManager(!0,"m-ignsearchlocator-xylocator-button"),document.getElementById("m-ignsearchlocator-results").style="width: 301px;";var t=M.template.compileSync(S.a,{vars:{hasHelp:void 0!==this.helpUrl&&M.utils.isUrl(this.helpUrl),helpUrl:this.helpUrl,translations:{title:N("title"),srs:N("srs"),longitude:N("longitude"),latitude:N("latitude"),locate:N("locate"),negative:N("negative"),east:N("east"),west:N("west"),north:N("north"),south:N("south"),geographic:N("geographic"),zone:N("zone"),dms:N("dms"),dd:N("dd")}}});if(this.accessibilityTab(t),null!=this.xytype){if("EPSG:4258d"===this.xytype&&"d"===this.xydata){t.querySelector("#m-xylocator-srs").value=this.xytype;var o=t.querySelector("#m-xylocator-srs");o.options[o.selectedIndex].setAttribute("data-units",this.xydata),t.querySelector("input#LON").value=this.xylon,t.querySelector("input#LAT").value=this.xylat}else if("EPSG:4326d"===this.xytype&&"d"===this.xydata){t.querySelector("#m-xylocator-srs").value=this.xytype;var n=t.querySelector("#m-xylocator-srs");n.options[n.selectedIndex].setAttribute("data-units",this.xydata),t.querySelector("input#LON").value=this.xylon,t.querySelector("input#LAT").value=this.xylat}else if("EPSG:4258dms"===this.xytype&&"dms"===this.xydata){t.querySelector("#m-xylocator-srs").value=this.xytype;var a=t.querySelector("#m-xylocator-srs");a.options[a.selectedIndex].setAttribute("data-units",this.xydata),t.querySelector("input#LONHH").value=this.xylonhh,t.querySelector("input#LONMM").value=this.xylonmm,t.querySelector("input#LONSS").value=this.xylonss,t.querySelector("input#LATHH").value=this.xylathh,t.querySelector("input#LATMM").value=this.xylatmm,t.querySelector("input#LATSS").value=this.xylatss}else if("EPSG:4326dms"===this.xytype&&"dms"===this.xydata){t.querySelector("#m-xylocator-srs").value=this.xytype;var i=t.querySelector("#m-xylocator-srs");i.options[i.selectedIndex].setAttribute("data-units",this.xydata),t.querySelector("input#LONHH").value=this.xylonhh,t.querySelector("input#LONMM").value=this.xylonmm,t.querySelector("input#LONSS").value=this.xylonss,t.querySelector("input#LATHH").value=this.xylathh,t.querySelector("input#LATMM").value=this.xylatmm,t.querySelector("input#LATSS").value=this.xylatss}else{t.querySelector("#m-xylocator-srs").value=this.xytype;var r=t.querySelector("#m-xylocator-srs");r.options[r.selectedIndex].setAttribute("data-units",this.xydata),t.querySelector("input#UTM-X").value=this.xyutmx,t.querySelector("input#UTM-Y").value=this.xyutmy}"d"===this.xydata?(t.querySelector("div#m-xylocator-utm").style.display="none",t.querySelector("div#m-xylocator-dms").style.display="none",t.querySelector("div#m-xylocator-latlon").style.display="table"):"dms"===this.xydata?(t.querySelector("div#m-xylocator-utm").style.display="none",t.querySelector("div#m-xylocator-latlon").style.display="none",t.querySelector("div#m-xylocator-dms").style.display="block"):(t.querySelector("div#m-xylocator-latlon").style.display="none",t.querySelector("div#m-xylocator-dms").style.display="none",t.querySelector("div#m-xylocator-utm").style.display="block")}t.querySelector("select#m-xylocator-srs").addEventListener("change",(function(t){return e.manageInputs_(t)})),t.querySelector("button#m-xylocator-loc").addEventListener("click",(function(o){return e.calculate_(o,t)})),this.resultsBox.appendChild(t)}}},{key:"activationManager",value:function(e,t){e?(document.getElementById(t).style.backgroundColor="#71a7d3",document.getElementById(t).style.color="white"):(document.querySelectorAll(t).forEach((function(e){return e.parentNode.removeChild(e)})),document.getElementById(t).style.backgroundColor="white",document.getElementById(t).style.color="#7A7A73")}},{key:"calculate_",value:function(e,t){try{var o=document.querySelector(".m-xylocator-container select#m-xylocator-srs"),n=o.options[o.selectedIndex],a=n.value;this.xytype=t.querySelector("#m-xylocator-srs").value,this.xydata=n.getAttribute("data-units"),"d"===this.xydata&&(a=a.replace("d","")),"dms"===this.xydata&&(a=a.replace("dms","")),"EPSG:4258d"===this.xytype&&"d"===this.xydata||"EPSG:4326d"===this.xytype&&"d"===this.xydata?(this.xylon=t.querySelector("input#LON").value,this.xylat=t.querySelector("input#LAT").value):"EPSG:4258dms"===this.xytype&&"dms"===this.xydata||"EPSG:4326dms"===this.xytype&&"dms"===this.xydata?(this.xylonhh=t.querySelector("input#LONHH").value,this.xylonmm=t.querySelector("input#LONMM").value,this.xylonss=t.querySelector("input#LONSS").value,this.xylathh=t.querySelector("input#LATHH").value,this.xylatmm=t.querySelector("input#LATMM").value,this.xylatss=t.querySelector("input#LATSS").value):(this.xyutmx=t.querySelector("input#UTM-X").value,this.xyutmy=t.querySelector("input#UTM-Y").value);var i=-1,r=-1;if("d"===n.getAttribute("data-units")){var s=document.querySelector("div#m-xylocator-latlon input#LON").value.replace(",","."),l=document.querySelector("div#m-xylocator-latlon input#LAT").value.replace(",",".");i=parseFloat(s),r=parseFloat(l);var c=this.getImpl().reproject(a,[i,r]);this.locator_(c,null)}else if("dms"===n.getAttribute("data-units")){var u=document.querySelector("div#m-xylocator-dms input#LONHH").value,p=document.querySelector("div#m-xylocator-dms input#LONMM").value,d=document.querySelector("div#m-xylocator-dms input#LONSS").value,m=document.querySelector('div#m-xylocator-dms input[name="LONDIR"]:checked').value,h=document.querySelector("div#m-xylocator-dms input#LATHH").value,y=document.querySelector("div#m-xylocator-dms input#LATMM").value,v=document.querySelector("div#m-xylocator-dms input#LATSS").value,g=document.querySelector('div#m-xylocator-dms input[name="LATDIR"]:checked').value;if(this.checkDegreeValue_(p)&&this.checkDegreeValue_(d)&&this.checkDegreeValue_(y)&&this.checkDegreeValue_(v)&&parseFloat(u)>=0&&parseFloat(u)<=180&&parseFloat(h)>=0&&parseFloat(h)<=180)try{i=parseFloat(u)+parseFloat(p)/60+parseFloat(d)/3600,r=parseFloat(h)+parseFloat(y)/60+parseFloat(v)/3600,"east"!==m&&0!==i&&(i=-i),"north"!==g&&0!==r&&(r=-r);var f=this.getImpl().reproject(a,[i,r]);this.locator_(f,null)}catch(e){M.dialog.error(N("exception.transforming"),"Error")}else M.dialog.error(N("exception.wrong_values"),"Error")}else try{var b=document.querySelector("div#m-xylocator-utm input#UTM-X").value.replace(",","."),x=document.querySelector("div#m-xylocator-utm input#UTM-Y").value.replace(",",".");i=parseFloat(b),r=parseFloat(x);var S=this.getImpl().reproject(a,[i,r]);this.locator_(S,null)}catch(e){M.dialog.error(N("exception.transforming"),"Error")}this.clearResults(),this.activationManager(!1,"m-ignsearchlocator-xylocator-button");var P=this.getImpl().reprojectXY(a,[i,r]);this.locator_(P,null)}catch(e){throw M.dialog.error(N("exception.wrong_coords"),"Error"),e}}},{key:"checkDegreeValue_",value:function(e){return parseFloat(e)>=0&&parseFloat(e)<60}},{key:"manageInputs_",value:function(e){var t=e.target,o=t.options[t.selectedIndex];"d"===o.getAttribute("data-units")?(document.querySelector("div#m-xylocator-utm").style.display="none",document.querySelector("div#m-xylocator-dms").style.display="none",document.querySelector("div#m-xylocator-latlon").style.display="table"):"dms"===o.getAttribute("data-units")?(document.querySelector("div#m-xylocator-utm").style.display="none",document.querySelector("div#m-xylocator-latlon").style.display="none",document.querySelector("div#m-xylocator-dms").style.display="block"):(document.querySelector("div#m-xylocator-latlon").style.display="none",document.querySelector("div#m-xylocator-dms").style.display="none",document.querySelector("div#m-xylocator-utm").style.display="block")}},{key:"locator_",value:function(e,t){var o=e[0],n=e[1],a=parseFloat(o),i=parseFloat(n);if(this.map.removeLayers(this.coordinatesLayer),Number.isNaN(a)||Number.isNaN(i))M.dialog.error(N("exception.wrong_coords"),"Error");else{this.map.setCenter("".concat(a,",").concat(i,"*false")),this.map.setZoom(this.zoom),this.fire("xylocator:locationCentered",[{zoom:this.zoom,center:[a,i]}]),this.coordinatesLayer=new M.layer.Vector({name:N("coordinateresult")},{displayInLayerSwitcher:!1});var r=new M.Feature("localizacion",{type:"Feature",properties:{},geometry:{type:"Point",coordinates:[a,i]}});this.coordinatesLayer.addFeatures([r]),null===t?this.coordinatesLayer.setStyle(new M.style.Point({radius:8,fill:{color:"#f00",opacity:.5},stroke:{color:"#f00",opacity:1,width:3}})):(this.createGeometryStyles(),this.coordinatesLayer.setStyle(this.point)),this.createGeometryStyles(),this.coordinatesLayer.setStyle(this.point),this.coordinatesLayer.setZIndex(1e19),this.map.addLayers(this.coordinatesLayer)}}},{key:"setResultVisibility",value:function(e){this.resultVisibility_=e}},{key:"changePlaceholder",value:function(){"g"===this.servicesToSearch?this.searchInput.placeholder=N("direccion"):"n"===this.servicesToSearch&&(this.searchInput.placeholder="Topónimo")}},{key:"createGeometryStyles",value:function(){"pinBlanco"===this.pointStyle?this.point=new M.style.Point({radius:5,icon:{src:M.utils.concatUrlPaths([M.config.THEME_URL,"/img/marker.svg"]),scale:1.4,fill:{color:"#71a7d3"},stroke:{width:30,color:"white"},anchor:[.5,1]}}):"pinRojo"===this.pointStyle?this.point=new M.style.Point({radius:5,icon:{src:M.utils.concatUrlPaths([M.config.THEME_URL,"/img/pinign.svg"])}}):"pinMorado"===this.pointStyle&&(this.point=new M.style.Point({radius:5,icon:{src:M.utils.concatUrlPaths([M.config.THEME_URL,"/img/m-pin-24.svg"])}})),this.simple=new M.style.Polygon({fill:{color:"black",opacity:0}})}},{key:"showSearchPopUp",value:function(e,t,o){var n,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this.map.getProjection().code,r="EPSG:4326",s=this.getImpl().reprojectReverse([t[1],t[0]],r,i);n=N(1!==o?"aprox":"exact"),this.showPopUp(e,s,t,n,!1,a)}},{key:"showSearchPopUpRC",value:function(e,t,o){var n,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i="EPSG:4326",r=this.map.getProjection().code,s=this.getImpl().reprojectReverse([t[0],t[1]],r,i);n=N(1!==o?"aprox":"exact"),this.showPopUp(e,t,s,n,!1,a)}},{key:"showPopUp",value:function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},r=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s={content:"",title:""};if(null!==n&&(s.content+="<div><b>".concat(n,"</b></div>")),s.content+="<div><b>".concat(void 0!==e?e:"-","</b></div><br/>\n                <div class='ignsearchlocator-popup'><b>Lat:</b>").concat(o[0].toFixed(6),"</div>\n                <div class='ignsearchlocator-popup'><b>Lon:</b>").concat(o[1].toFixed(6)," </div>"),this.map.getPopup()instanceof M.Popup&&!0===a)this.popup=this.map.getPopup(),this.popup.addTab(s);else{var l=new M.Popup({panMapIfOutOfView:!i.fake});l.addTab(s),this.map.addPopup(l,[t[0],t[1]]),this.popup=l}r&&"pinBlanco"===this.pointStyle&&this.popup.getImpl().setOffset([0,-30]),this.lat=t[1],this.lng=t[0]}},{key:"setScale",value:function(e){this.getImpl().setScale(e)}},{key:"accessibilityTab",value:function(e){var t=this;e.getAttribute("tabindex")&&e.setAttribute("tabindex",this.order),e.querySelectorAll('[tabindex="0"]').forEach((function(e){return e.setAttribute("tabindex",t.order)}))}}])&&I(t.prototype,o),n&&I(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(a=n.key,i=void 0,i=function(e,t){if("object"!==G(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!==G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===G(i)?i:String(i)),n)}var a,i}function V(e,t){return(V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=Y(e);if(t){var a=Y(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return z(this,o)}}function z(e,t){if(t&&("object"===G(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var J=["Estado","Isla administrativa","Comarca administrativa","Jurisdicción","Vértice Geodésico","Alineación montañosa","Montaña","Paso de montaña","Llanura","Depresión","Vertientes","Comarca geográfica","Paraje","Elemento puntual del paisaje","Saliente costero","Playa","Isla","Otro relieve costero","Curso natural de agua","Masa de agua","Curso artificial de agua","Hidrónimo puntual","Glaciares","Mar","Entrante costero y estrecho marítimo","Relieve submarino"],W=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(s,M.Plugin);var t,o,i,r=H(s);function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=r.call(this)).map_=null,t.controls_=[],t.servicesToSearch=e.servicesToSearch||"gn";t.CMC_url=null!=e.CMC_url?e.CMC_url:"http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejeroCodigos.asmx/ConsultaMunicipioCodigos";t.DNPPP_url=null!=e.DNPPP_url?e.DNPPP_url:"http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejeroCodigos.asmx/Consulta_DNPPP_Codigos";t.CPMRC_url=null!=e.CPMRC_url?e.CPMRC_url:"http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCoordenadas.asmx/Consulta_CPMRC",t.catastroWMS=e.catastroWMS||"http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCoordenadas.asmx/Consulta_RCCOOR",t.maxResults=e.maxResults||10,t.noProcess=e.noProcess||"poblacion",t.countryCode=e.countryCode||"es",t.urlCandidates=e.urlCandidates||"https://www.cartociudad.es/geocoder/api/geocoder/candidatesJsonp",t.urlFind=e.urlFind||"https://www.cartociudad.es/geocoder/api/geocoder/findJsonp",t.urlReverse=e.urlReverse||"https://www.cartociudad.es/geocoder/api/geocoder/reverseGeocode",t.urlPrefix=e.urlPrefix||"http://www.idee.es/",t.urlAssistant=e.urlAssistant||"https://www.idee.es/communicationsPoolServlet/SearchAssistant",t.urlDispatcher=e.urlDispatcher||"https://www.idee.es/communicationsPoolServlet/Dispatcher",t.nomenclatorSearchType=J||a,t.resultVisibility=e.resultVisibility||!0,t.isCollapsed=e.isCollapsed||!1,t.collapsible=e.collapsible||!1,t.position=e.position||"TL",t.pointStyle=e.pointStyle||"pinBlanco",t.tooltip_=e.tooltip||N("tooltip"),t.reverse_=e.reverse||!1,t.locationID_=e.locationID&&e.locationID.replace(/\^/g,"&")||"",t.requestStreet_=e.requestStreet&&e.requestStreet.replace(/\^/g,"&")||"";var o=e.geocoderCoords;return M.utils.isString(o)&&(o=o.split(","),o=[Number.parseFloat(o[0]),Number.parseFloat(o[1])]),t.geocoderCoords_=o||[],t.metadata_=n.metadata,t.zoom_=16,void 0!==e.zoom&&(t.zoom_=parseInt(e.zoom,10)),t.searchPosition=e.searchPosition||"nomenclator,geocoder",t.helpUrl=e.helpUrl,t.cadastre=e.cadastre,void 0!==e.cadastre&&(t.cadastre=!0),t.searchCoordinatesXYZ=e.searchCoordinatesXYZ,void 0!==e.searchCoordinatesXYZ&&(t.searchCoordinatesXYZ=!0),t.order=e.order>=-1?e.order:null,t}return t=s,i=[{key:"getJSONTranslations",value:function(e){return"en"===e||"es"===e?"en"===e?E:L:M.language.getTranslation(e).ignsearchlocator}}],(o=[{key:"addTo",value:function(e){var t=this;this.controls_.push(new F(this.servicesToSearch,this.CMC_url,this.DNPPP_url,this.CPMRC_url,this.catastroWMS,this.maxResults,this.noProcess,this.countryCode,this.urlCandidates,this.urlFind,this.urlReverse,this.urlPrefix,this.urlAssistant,this.urlDispatcher,this.resultVisibility,this.reverse_,this.locationID_,this.requestStreet_,this.geocoderCoords_,this.zoom_,this.searchPosition,this.position,this.pointStyle,this.nomenclatorSearchType,this.helpUrl,this.cadastre,this.searchCoordinatesXYZ,this.order)),this.controls_[0].on("ignsearchlocator:entityFound",(function(e){t.fire("ignsearchlocator:entityFound",[e])})),this.controls_[0].on("xylocator:locationCentered",(function(e){t.fire("xylocator:locationCentered",e)})),this.map_=e,"TC"===this.position&&(this.collapsible=!1),this.panel_=new M.ui.Panel("IGNSearchLocator",{collapsible:this.collapsible,position:M.ui.position[this.position],collapsed:this.isCollapsed,className:"ign-searchlocator-panel",collapsedButtonClass:"icon-ignsearch",tooltip:this.tooltip_,order:this.order}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_)}},{key:"setResultVisibility",value:function(e){this.controls_[0].setResultVisibility(e)}},{key:"name",get:function(){return"ignsearchlocator"}},{key:"reverse",get:function(){return this.reverse_}},{key:"geocoderCoords",get:function(){return this.controls_[0].geocoderCoords}},{key:"requestStreet",get:function(){return this.controls_[0].requestStreet}},{key:"locationID",get:function(){return this.controls_[0].locationID}},{key:"equals",value:function(e){return e instanceof s}},{key:"getAPIRest",value:function(){return"".concat(this.name,"=").concat(this.position,"*").concat(this.collapsible,"*").concat(this.isCollapsed,"*").concat(this.order,"*").concat(this.tooltip_,"*").concat(this.servicesToSearch,"*").concat(this.maxResults,"*").concat(this.noProcess,"*").concat(this.resultVisibility,"*").concat(this.reverse_,"*").concat(this.requestStreet_,"*").concat(this.locationID_,"*").concat(this.geocoderCoords_,"*").concat(this.zoom_,"*").concat(this.searchPosition,"*").concat(this.pointStyle,"*").concat(this.helpUrl,"*").concat(this.countryCode,"*").concat(this.cadastre,"*").concat(this.searchCoordinatesXYZ,"*").concat(this.urlCandidates,"*").concat(this.urlFind,"*").concat(this.urlReverse,"*").concat(this.urlPrefix,"*").concat(this.urlAssistant,"*").concat(this.urlDispatcher,"*").concat(this.CMC_url,"*").concat(this.DNPPP_url,"*").concat(this.CPMRC_url,"*").concat(this.catastroWMS)}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"destroy",value:function(){this.map_.removeControls(this.controls_);var e=[null,null,null];this.map_=e[0],this.controls_=e[1],this.panel_=e[2]}}])&&U(t.prototype,o),i&&U(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}();window.M.plugin||(window.M.plugin={}),window.M.control||(window.M.control={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.plugin.IGNSearchLocator=W,window.M.control.IGNSearchLocatorControl=F,window.M.impl.control.IGNSearchLocatorControl=y}]);
//# sourceMappingURL=ignsearchlocator.ol.min.js.map