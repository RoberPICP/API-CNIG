{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/templates/perfiltopografico.html","webpack:///./src/impl/ol/js/profilcontrol.js","webpack:///./src/facade/js/i18n/language.js","webpack:///./src/impl/ol/js/topographicprofilecontrol.js","webpack:///./src/facade/js/topographicprofilecontrol.js","webpack:///./src/facade/js/topographicprofile.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","child","parent","translations","en","es","getLang","res","M","language","getTranslation","lang","topographicprofile","getValue","keyPath","arguments","length","undefined","translation","utils","isNullOrEmpty","console","warn","concat","split","reduce","prev","current","info","Profil","opt_options","_this","options","this","element","self","target","document","createElement","classList","add","className","trim","elementTitle","textContent","appendChild","button","setAttribute","close","e","map","removeControl","source","clear","addEventListener","button2","download","image","getImage","a","href","click","remove","div_inner","div","style","position","ratio","canvas_","width","height","styles","keys","forEach","div_to_canvas","onMove","ol","control","Control","margin_","top","left","bottom","right","ytitle","xtitle","bar_","cursor_","popup_","cellPadding","cellSpacing","clientWidth","firstTr","div_zmin","innerHTML","zmin","div_zmax","zmax","div_distance","distance","secondTr","div_altitude","altitude","div_distance2","div_time2","time","tab_","feature","setGeometry","constructor","popup","box_canvas","getBoundingClientRect","pos","window","pageYOffset","documentElement","clientTop","pageXOffset","clientLeft","dx","pageX","dy","pageY","display","scale_","p0","dy_","parentElement","querySelector","altitudeUnits","toFixed","distanceUnitsKM","dispatchEvent","type","coord","contains","show","hide","toggle","b","isShown","g","Feature","getGeometry","canvas","ctx","getContext","w","h","setTransform","clearRect","test","getLayout","getCoordinates","getType","proj","projection","getMap","getView","getProjection","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","z","ti","p1","p2","Infinity","sphere","getDistance","transform","getTime","push","distanceUnitsM","grad","graduation","Math","ceil","floor","amplitude","max","scx","scy","font","textAlign","textBaseline","fillStyle","zunit","fillText","setLineDash","step","unit","round","txt","replace","save","rotate","PI","restore","t0","t1","dt","trunc","mn","encoderOptions","toDataURL","TopographicprofileControl","_M$impl$Control","_inherits","impl","_super","_createSuper","opts","_classCallCheck","_ref","serviceURL","distancePoinst_","mercator_","coordEPSG4326","_ref2","projectionMap_","profil_","facadeMap_","vector_","source_","vectorProfile_","sourceProfile_","draw_","lineCoord_","pointsCoord_","dataPoints_","pt","_ref3","lineString_","feature_","style_","html","initOlLayers","_get","_getPrototypeOf","evt","Style","Stroke","color","Circle","radius","fill","Fill","Vector","wrapX","layer","setZIndex","getMapImpl","addLayer","code","originPoint","destPoint","addX","addY","points","String","oriMete","destMete","angle","getAngleBetweenPoints","getDistBetweenPoints","distPoint","newPointA","cos","sin","newPointB","firstPoint","secondPoint","geom","LineString","getLength","atan2","body","cursor","deactivate","pointerEvents","activate","createIteraction","addInteraction","typeGeom","interaction","Draw","on","clearLayer","findNewPoints","getDataFromGGISCore","_this2","pointsBbox","altitudes","promises","filter","elem","proxy","bbox","url","remote","Promise","all","then","responses","response","alt","responseText","text","join","indexOf","item","parseFloat","arrayXZY","data","index","center","extent","getCenter","controlProfile","arrayXZY2","setCoordinates","err","dialog","error","coordsXYZ","_this3","getSource","addFeature","geometry","addControl","drawPoint","Point","setStyle","once","getState","getFeatures","removeInteraction","removeLayer","_M$Control","isUndefined","TopographicprofileImplControl","exception","template","compileSync","string","parseToHtml","templateVars","vars","htmlText","Handlebars","compile","templateFn","stringToHtml","success","fail","template_","title","Topographicprofile","_M$Plugin","Plugin","map_","controls_","position_","metadata_","api","metadata","panel_","control_","options_","visible","ui","Panel","addControls","addPanels","getElementsByClassName","impl_","setDataFromLocal","removeControls","plugin","M$plugin$Topographicprofile","Topographicprofilecontrol","M$control$Topographicprofilecontrol","M$impl$control$TopographicprofileControl"],"mappings":"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","file":"topographicprofile.ol.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","module.exports = \"<div class=\\\"m-control m-container m-topographicprofile-container\\\">\\r\\n    <button id='m-topographicprofile-btn' class=\\\"m-topographicprofile-btn icon-chart\\\"></button>\\r\\n</div>\\r\\n\";","/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n\n/*import ol_ext_inherits from '../util/ext'\nimport { getDistance as ol_sphere_getDistance } from 'ol/sphere'\nimport { transform as ol_proj_transform } from 'ol/proj'\nimport ol_control_Control from 'ol/control/Control'\nimport ol_Feature from 'ol/Feature'*/\n\nimport { getValue } from '../../../facade/js/i18n/language';\n\nconst inherits = (child, parent) => {\n  child.prototype = Object.create(parent.prototype);\n  child.prototype.constructor = child;\n};\n\n/** Custom infos list\n * @api stable\n */\nconst info = {\n  \"zmin\": \"Zmin\",\n  \"zmax\": \"Zmax\",\n  \"ytitle\": \"Altitude (m)\",\n  \"xtitle\": \"Distance (km)\",\n  \"time\": \"Time\",\n  \"altitude\": \"Altitude\",\n  \"distance\": \"Distance\",\n  \"altitudeUnits\": \"m\",\n  \"distanceUnitsM\": \"m\",\n  \"distanceUnitsKM\": \"km\",\n};\n\n\n\n/*eslint-disable*/\n\n/**\n * @classdesc OpenLayers 3 Profil Control.\n *\tDraw a profil of a feature (with a 3D geometry)\n *\n * @constructor\n * @extends {ol_control_Control}\n * @fires  over, out, show\n * @param {Object=} _ol_control_ opt_options.\n *\n */\nvar Profil = function(opt_options) {\n  var options = opt_options || {};\n  this.info = options.info || info;\n  var self = this;\n\n  var element;\n  if (options.target) {\n    element = document.createElement(\"div\");\n    element.classList.add(options.className || \"ol-profil\");\n  } else {\n    element = document.createElement(\"div\");\n    element.className = ((options.className || 'ol-profil') + ' ol-unselectable ol-control ol-collapsed').trim();\n    let elementTitle = document.createElement('p');\n    elementTitle.textContent = getValue('profil.title');\n    element.appendChild(elementTitle);\n    // let cross = document.createElement('button');\n    // cross.className = 'cross';\n    // element.appendChild(cross);\n    // cross.addEventListener(\"click\", function(e) {\n\n    // })\n    const button = document.createElement('button');\n    button.setAttribute('type', 'button');\n    button.setAttribute('class', 'profile-close-button');\n    const close = (e) => {\n      opt_options.map.removeControl(this);\n      options.source.clear();\n    };\n    button.addEventListener('click', close);\n    button.addEventListener('touchstart', close);\n    elementTitle.appendChild(button);\n\n    const button2 = document.createElement('button');\n    button2.setAttribute('type', 'button');\n    button2.setAttribute('class', 'profile-download-button');\n    const download = (e) => {\n      const image = this.getImage();\n      const a = document.createElement('a');\n      a.href = image;\n      a.download = 'Perfil.png';\n      a.click();\n      a.remove();\n    };\n    button2.addEventListener('click', download);\n    button2.addEventListener('touchstart', download);\n    elementTitle.appendChild(button2);\n  }\n\n  var div_inner = document.createElement(\"div\");\n  div_inner.classList.add(\"ol-inner\");\n  element.appendChild(div_inner);\n  var div = document.createElement(\"div\");\n  div.style.position = \"relative\";\n  div_inner.appendChild(div);\n\n  var ratio = this.ratio = 2;\n  this.canvas_ = document.createElement('canvas');\n  this.canvas_.width = (options.width || 400) * ratio;\n  this.canvas_.height = (options.height || 250) * ratio;\n\n  var styles = {\n    \"msTransform\": \"scale(0.5,0.5)\",\n    \"msTransformOrigin\": \"0 0\",\n    \"webkitTransform\": \"scale(0.5,0.5)\",\n    \"webkitTransformOrigin\": \"0 0\",\n    \"mozTransform\": \"scale(0.5,0.5)\",\n    \"mozTransformOrigin\": \"0 0\",\n    \"transform\": \"scale(0.5,0.5)\",\n    \"transformOrigin\": \"0 0\"\n  };\n\n  Object.keys(styles).forEach(function(style) {\n    if (style in self.canvas_.style) {\n      self.canvas_.style[style] = styles[style];\n    }\n  });\n\n  var div_to_canvas = document.createElement(\"div\");\n  div.appendChild(div_to_canvas);\n  div_to_canvas.style.width = this.canvas_.width / ratio + \"px\";\n  div_to_canvas.style.height = this.canvas_.height / ratio + \"px\";\n  div_to_canvas.appendChild(this.canvas_);\n  div_to_canvas.addEventListener(\"click\", function(e) { self.onMove(e); });\n  div_to_canvas.addEventListener(\"mousemove\", function(e) { self.onMove(e); });\n\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n\n  // Offset in px\n  this.margin_ = { top: 25 * ratio, left: 55 * ratio, bottom: 45 * ratio, right: 25 * ratio };\n  if (!this.info.ytitle) this.margin_.left -= 20 * ratio;\n  if (!this.info.xtitle) this.margin_.bottom -= 20 * ratio;\n\n  // Cursor\n  this.bar_ = document.createElement(\"div\");\n  this.bar_.classList.add(\"ol-profilbar\");\n  this.bar_.style.top = (this.margin_.top / ratio) + \"px\";\n  this.bar_.style.height = (this.canvas_.height - this.margin_.top - this.margin_.bottom) / ratio + \"px\";\n  div.appendChild(this.bar_);\n\n  this.cursor_ = document.createElement(\"div\");\n  this.cursor_.classList.add(\"ol-profilcursor\");\n  div.appendChild(this.cursor_);\n\n  this.popup_ = document.createElement(\"div\");\n  this.popup_.classList.add(\"ol-profilpopup\");\n  this.cursor_.appendChild(this.popup_);\n\n  // Track information\n  var t = document.createElement(\"table\");\n  t.cellPadding = '0';\n  t.cellSpacing = '0';\n  t.style.clientWidth = this.canvas_.width / ratio + \"px\";\n  div.appendChild(t);\n\n  var firstTr = document.createElement(\"tr\");\n  firstTr.classList.add(\"track-info\");\n  t.appendChild(firstTr);\n  var div_zmin = document.createElement(\"td\");\n  div_zmin.innerHTML = (this.info.zmin || \"Zmin\") + ': <span class=\"zmin\">';\n  firstTr.appendChild(div_zmin);\n  var div_zmax = document.createElement(\"td\");\n  div_zmax.innerHTML = (this.info.zmax || \"Zmax\") + ': <span class=\"zmax\">';\n  firstTr.appendChild(div_zmax);\n  var div_distance = document.createElement(\"td\");\n  div_distance.innerHTML = (this.info.distance || \"Distance\") + ': <span class=\"dist\">';\n  firstTr.appendChild(div_distance);\n  //var div_time = document.createElement(\"td\");\n  //div_time.innerHTML = (this.info.time || \"Time\") + ': <span class=\"time\">';\n  //firstTr.appendChild(div_time);\n  var secondTr = document.createElement(\"tr\");\n  secondTr.classList.add(\"point-info\")\n  t.appendChild(secondTr);\n  var div_altitude = document.createElement(\"td\");\n  div_altitude.innerHTML = (this.info.altitude || \"Altitude\") + ': <span class=\"z\">';\n  secondTr.appendChild(div_altitude);\n  var div_distance2 = document.createElement(\"td\");\n  div_distance2.innerHTML = (\"Dist. parcial\") + ': <span class=\"dist\">';\n  secondTr.appendChild(div_distance2);\n  var div_time2 = document.createElement(\"td\");\n  div_time2.innerHTML = (this.info.time || \"Time\") + ': <span class=\"time\">';\n  secondTr.appendChild(div_time2);\n\n  // Array of data\n  this.tab_ = [];\n\n  // Show feature\n  if (options.feature) {\n    this.setGeometry(options.feature);\n  }\n};\ninherits(Profil, ol.control.Control);\n\n/** Show popup info\n * @param {string} info to display as a popup\n * @api stable\n */\nProfil.prototype.popup = function(info) {\n  this.popup_.innerHTML = info;\n}\n\n/** Mouse move over canvas\n */\nProfil.prototype.onMove = function(e) {\n  if (!this.tab_.length) return;\n  var box_canvas = this.canvas_.getBoundingClientRect();\n  var pos = {\n    top: box_canvas.top + window.pageYOffset - document.documentElement.clientTop,\n    left: box_canvas.left + window.pageXOffset - document.documentElement.clientLeft\n  };\n\n  var dx = e.pageX - pos.left;\n  var dy = e.pageY - pos.top;\n  var ratio = this.ratio;\n  if (dx > this.margin_.left / ratio && dx < (this.canvas_.width - this.margin_.right) / ratio &&\n    dy > this.margin_.top / ratio && dy < (this.canvas_.height - this.margin_.bottom) / ratio) {\n    this.bar_.style.left = dx + \"px\";\n    this.bar_.style.display = \"block\";\n    var d = (dx * ratio - this.margin_.left) / this.scale_[0];\n    var p0 = this.tab_[0];\n    for (var i = 1, p; p = this.tab_[i]; i++) {\n      if (p[0] >= d) {\n        if (d < (p[0] + p0[0]) / 2) p = p0;\n        break;\n      }\n    }\n    if (p) {\n      this.cursor_.style.left = dx + \"px\";\n      this.cursor_.style.top = (this.canvas_.height - this.margin_.bottom + p[1] * this.scale_[1] + this.dy_) / ratio + \"px\";\n      this.cursor_.style.display = \"block\";\n    } else {\n      this.cursor_.style.display = \"none\";\n    }\n    this.bar_.parentElement.classList.add(\"over\");\n    this.element.querySelector(\".point-info .z\").textContent = p[1] + this.info.altitudeUnits;\n    this.element.querySelector(\".point-info .dist\").textContent = (p[0] / 1000).toFixed(1) + this.info.distanceUnitsKM;\n    this.element.querySelector(\".point-info .time\").textContent = p[2];\n    if (dx > this.canvas_.width / ratio / 2) this.popup_.classList.add('ol-left');\n    else this.popup_.classList.remove('ol-left');\n    this.dispatchEvent({ type: 'over', click: e.type == \"click\", coord: p[3], time: p[2], distance: p[0] });\n  } else {\n    if (this.bar_.parentElement.classList.contains(\"over\")) {\n      this.bar_.style.display = 'none';\n      this.cursor_.style.display = 'none';\n      this.bar_.parentElement.classList.remove(\"over\");\n      this.dispatchEvent({ type: 'out' });\n    }\n  }\n}\n\n/** Show panel\n * @api stable\n */\nProfil.prototype.show = function() {\n  this.element.classList.remove(\"ol-collapsed\");\n  this.dispatchEvent({ type: 'show', show: true });\n}\n/** Hide panel\n * @api stable\n */\nProfil.prototype.hide = function() {\n  this.element.classList.add(\"ol-collapsed\");\n  this.dispatchEvent({ type: 'show', show: false });\n}\n/** Toggle panel\n * @api stable\n */\nProfil.prototype.toggle = function() {\n  this.element.classList.toggle(\"ol-collapsed\");\n  var b = this.element.classList.contains(\"ol-collapsed\");\n  this.dispatchEvent({ type: 'show', show: !b });\n}\n/** Is panel visible\n */\nProfil.prototype.isShown = function() {\n  return (!this.element.classList.contains(\"ol-collapsed\"));\n}\n\n/**\n * Set the geometry to draw the profil.\n * @param {ol.Feature|ol.geom} f the feature.\n * @param {Object=} options\n *\t\t- projection {ol.ProjectionLike} feature projection, default projection of the map\n *\t\t- zunit {m|km} default m\n *\t\t- unit {m|km} default km\n *\t\t- zmin {Number|undefined} default 0\n *\t\t- zmax {Number|undefined} default max Z of the feature\n *\t\t- graduation {Number|undefined} z graduation default 100\n *\t\t- amplitude {integer|undefined} amplitude of the altitude, default zmax-zmin\n * @api stable\n */\nProfil.prototype.setGeometry = function(g, options) {\n  if (!options) options = {};\n  if (g instanceof ol.Feature) g = g.getGeometry();\n  var canvas = this.canvas_;\n  var ctx = canvas.getContext('2d');\n  var w = canvas.width;\n  var h = canvas.height;\n  ctx.setTransform(1, 0, 0, 1, 0, 0);\n  ctx.clearRect(0, 0, w, h);\n\n  // No Z\n  if (!/Z/.test(g.getLayout())) return;\n  // No time\n  if (/M/.test(g.getLayout())) this.element.querySelector(\".time\").parentElement.style.display = 'block';\n  else this.element.querySelector(\".time\").parentElement.style.display = 'none';\n\n  // Coords\n  var c = g.getCoordinates();\n\n  switch (g.getType()) {\n    case \"LineString\":\n      break;\n    case \"MultiLineString\":\n      c = c[0];\n      break;\n    default:\n      return;\n  }\n\n  /*// Distance beetween 2 coords\n  var proj = options.projection || this.getMap().getView().getProjection();\n\n  function dist2d(p1, p2) {\n    const distancia = ol.sphere.getDistance(\n      ol.proj.transform(p1.map(coord => parseFloat(coord)), 'EPSG:4326', 'EPSG:4326'),\n      ol.proj.transform(p2.map(coord => parseFloat(coord)), 'EPSG:4326', 'EPSG:4326'));\n\n    return distancia;\n\n  }*/\n\n\n  // Distance beetween 2 coords\n  var proj = options.projection || this.getMap().getView().getProjection();\n\n\n  function dist2d(p1, p2) {\n    return ol.sphere.getDistance(\n      ol.proj.transform(p1, proj, 'EPSG:4326'),\n      ol.proj.transform(p2, proj, 'EPSG:4326'))\n  }\n\n  function getTime(t0, t1) {\n    if (!t0 || !t1) return \"-\"\n    var dt = (t1 - t0) / 60; // mn\n    var ti = Math.trunc(dt / 60);\n    var mn = Math.trunc(dt - ti * 60);\n    return ti + \"h\" + (mn < 10 ? \"0\" : \"\") + mn + \"mn\";\n  }\n\n  // Margin\n  ctx.setTransform(1, 0, 0, 1, this.margin_.left, h - this.margin_.bottom);\n  var ratio = this.ratio;\n\n  w -= this.margin_.right + this.margin_.left;\n  h -= this.margin_.top + this.margin_.bottom;\n  // Draw axes\n  ctx.strokeStyle = \"#000\";\n  ctx.lineWidth = 0.5 * ratio;\n  ctx.beginPath();\n  ctx.moveTo(0, 0);\n  ctx.lineTo(0, -h);\n  ctx.moveTo(0, 0);\n  ctx.lineTo(w, 0);\n  ctx.stroke();\n\n  //\n  var zmin = Infinity,\n    zmax = -Infinity;\n  var i, p, d, z, ti, t = this.tab_ = [];\n  for (i = 0, p; p = c[i]; i++) {\n    z = p[2];\n    if (z < zmin) zmin = z;\n    if (z > zmax) zmax = z;\n    if (i == 0) d = 0;\n    else d += dist2d(c[i - 1], p);\n    ti = getTime(c[0][3], p[3]);\n    t.push([d, z, ti, p]);\n  }\n\n  // Info\n  this.element.querySelector(\".track-info .zmin\").textContent = zmin.toFixed(2) + this.info.altitudeUnits;\n  this.element.querySelector(\".track-info .zmax\").textContent = zmax.toFixed(2) + this.info.altitudeUnits;\n  if (d > 1000) {\n    this.element.querySelector(\".track-info .dist\").textContent = (d / 1000).toFixed(1) + this.info.distanceUnitsKM;\n  } else {\n    this.element.querySelector(\".track-info .dist\").textContent = (d).toFixed(1) + this.info.distanceUnitsM;\n  }\n  //this.element.querySelector(\".track-info .time\").textContent = ti;\n\n  // Set graduation\n  var grad = options.graduation || 100;\n  while (true) {\n    zmax = Math.ceil(zmax / grad) * grad;\n    zmin = Math.floor(zmin / grad) * grad;\n    var nbgrad = (zmax - zmin) / grad;\n    if (h / nbgrad < 15 * ratio) {\n      grad *= 2;\n    } else break;\n  }\n\n  // Set amplitude\n  if (typeof(options.zmin) == 'number' && zmin > options.zmin) zmin = options.zmin;\n  if (typeof(options.zmax) == 'number' && zmax < options.zmax) zmax = options.zmax;\n  var amplitude = options.amplitude;\n  if (amplitude) {\n    zmax = Math.max(zmin + amplitude, zmax);\n  }\n\n  // Scales lines\n  var scx = w / d;\n  var scy = -h / (zmax - zmin);\n  var dy = this.dy_ = -zmin * scy;\n  this.scale_ = [scx, scy];\n  // Draw\n  ctx.font = (12 * ratio) + \"px arial\";\n  ctx.textAlign = \"right\";\n  ctx.textBaseline = \"middle\";\n  ctx.fillStyle = \"#000\";\n  // Scale Z\n  ctx.beginPath();\n  for (i = zmin; i <= zmax; i += grad) {\n    if (options.zunit != \"km\") ctx.fillText(i, -4 * ratio, i * scy + dy);\n    else ctx.fillText((i / 1000).toFixed(1), -4 * ratio, i * scy + dy);\n    ctx.moveTo(-2 * ratio, i * scy + dy);\n    if (i != 0) ctx.lineTo(d * scx, i * scy + dy);\n    else ctx.lineTo(0, i * scy + dy);\n  }\n  // Scale X\n  ctx.textAlign = \"center\";\n  ctx.textBaseline = \"top\";\n  ctx.setLineDash([ratio, 3 * ratio]);\n  var unit = options.unit || \"km\";\n  var step;\n  if (d > 1000) {\n    step = Math.round(d / 1000) * 100;\n    if (step > 1000) step = Math.ceil(step / 1000) * 1000;\n  } else {\n    unit = \"m\";\n    if (d > 100) step = Math.round(d / 100) * 10;\n    else if (d > 10) step = Math.round(d / 10);\n    else if (d > 1) step = Math.round(d) / 10;\n    else step = d;\n  }\n  for (i = 0; i <= d; i += step) {\n    var txt = (unit == \"m\") ? i : (i / 1000);\n    //if (i+step>d) txt += \" \"+ (options.zunits || \"km\");\n    ctx.fillText(Math.round(txt * 10) / 10, i * scx, 4 * ratio);\n    ctx.moveTo(i * scx, 2 * ratio);\n    ctx.lineTo(i * scx, 0);\n  }\n  ctx.font = (14 * ratio) + \"px arial\";\n  ctx.fillText(this.info.xtitle.replace(\"(km)\", \"(\" + unit + \")\"), w / 2, 18 * ratio);\n  ctx.save();\n  ctx.rotate(-Math.PI / 2);\n  ctx.fillText(this.info.ytitle, h / 2, -this.margin_.left);\n  ctx.restore();\n\n  ctx.stroke();\n\n  //\n  ctx.strokeStyle = \"#368\";\n  ctx.lineWidth = 3;\n  ctx.setLineDash([]);\n  ctx.beginPath();\n  for (i = 0; p = t[i]; i++) {\n    if (i == 0) ctx.moveTo(p[0] * scx, p[1] * scy + dy);\n    else ctx.lineTo(p[0] * scx, p[1] * scy + dy);\n  }\n  ctx.stroke();\n};\n\n/** Get profil image\n * @param {string|undefined} type image format or 'canvas' to get the canvas image, default image/png.\n * @param {Number|undefined} encoderOptions between 0 and 1 indicating image quality image/jpeg or image/webp, default 0.92.\n * @return {string} requested data uri\n * @api stable\n */\nProfil.prototype.getImage = function(type, encoderOptions) {\n  if (type === \"canvas\") return this.canvas_;\n  return this.canvas_.toDataURL(type, encoderOptions);\n}\n\nexport default Profil\n","import en from './en';\nimport es from './es';\n\n/**\n * Default object with es and en translate.\n *\n * @const\n * @type {object}\n */\nconst translations = {\n  en,\n  es,\n};\n\nconst getLang = () => {\n  let res = 'es';\n  if (typeof M.language.getLang === 'function') {\n    res = M.language.getLang();\n  }\n\n  return res;\n};\n\n/**\n * This function sets a new language translate.\n * @param {string} lang\n * @param {JSON} json\n * @public\n * @api\n */\nexport const addTranslation = (lang, json) => {\n  translations[lang] = json;\n};\n\n/**\n * This function gets a language translate.\n *\n * @param {string} lang\n * @return {JSON}\n * @public\n * @api\n */\n export const getTranslation = (lang) => {\n  if (lang === 'es' || lang === 'en') {\n    return translations[lang];\n  }\n  return M.language.getTranslation(lang).topographicprofile;\n};\n\n/**\n * This function gets a language value from key\n *\n * @public\n * @param {string}\n * @param {string}\n * @return {string}\n * @public\n * @api\n */\n\nexport const getValue = (keyPath, lang = getLang()) => {\n  const translation = getTranslation(lang);\n  let value = '';\n  if (M.utils.isNullOrEmpty(translation)) {\n    /* eslint-disable no-console */\n    console.warn(`The translation '${lang}' has not been defined.`);\n  } else {\n    value = keyPath.split('.').reduce((prev, current) => prev[current], translation);\n  }\n\n  return value;\n};\n","/* eslint-disable no-console */\r\n/**\r\n * @module M/impl/control/TopographicprofileControl\r\n */\r\nimport Profil from './profilcontrol';\r\nimport { getValue } from '../../../facade/js/i18n/language';\r\n\r\nconst PROFILE_URL = 'https://servicios.idee.es/wcs-inspire/mdt?request=GetCoverage&bbox=';\r\nconst PROFILE_URL_SUFFIX = '&service=WCS&version=1.0.0&coverage=Elevacion4258_500&' +\r\n  'interpolationMethod=bilinear&crs=EPSG%3A4258&format=ArcGrid&width=2&height=2';\r\nconst NO_DATA_VALUE = 'NODATA_value -9999.000';\r\n\r\nexport default class TopographicprofileControl extends M.impl.Control {\r\n\r\n  constructor(opts) {\r\n\r\n    super();\r\n    [this.distancePoinst_, this.mercator_, this.serviceURL, this.coordEPSG4326] = [opts.distance, 'EPSG:900913', opts.serviceURL, \"EPSG:4326\"];\r\n    [this.projectionMap_, this.profil_, this.facadeMap_, this.vector_, this.source_, this.vectorProfile_, this.sourceProfile_, this.draw_, this.lineCoord_, this.pointsCoord_, this.dataPoints_, this.pt] = [null, null, null, null, null, null, null, null, null, null, null, null];\r\n    [this.lineString_, this.feature_, this.style_] = [null, null, null];\r\n\r\n  }\r\n\r\n  /**\r\n   * This function adds the control to the specified map\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Map} map to add the plugin\r\n   * @param {HTMLElement} html of the plugin\r\n   * @api stable\r\n   */\r\n  addTo(map, html) {\r\n    this.facadeMap_ = map;\r\n\r\n    this.initOlLayers();\r\n    // super addTo - don't delete\r\n    super.addTo(map, html);\r\n  }\r\n\r\n  // Add your own functions\r\n  initOlLayers() {\r\n    this.style_ = function(evt) {\r\n      let style;\r\n      if (evt.getGeometry().getType() == 'LineString') {\r\n        style = [new ol.style.Style({\r\n          stroke: new ol.style.Stroke({\r\n            color: '#4286f4',\r\n            width: 2\r\n          })\r\n        })];\r\n      } else {\r\n        style = [new ol.style.Style({\r\n          image: new ol.style.Circle({\r\n            radius: 6,\r\n            fill: new ol.style.Fill({\r\n              color: '#4286f4'\r\n            })\r\n          }),\r\n          stroke: new ol.style.Stroke({\r\n            color: '#4286f4',\r\n            width: 2\r\n          }),\r\n          fill: new ol.style.Fill({\r\n            color: '#4286f4'\r\n          })\r\n        })];\r\n      }\r\n      return style;\r\n    }\r\n    this.source_ = new ol.source.Vector({\r\n      wrapX: false\r\n    });\r\n    this.vector_ = new ol.layer.Vector({\r\n      source: this.source_,\r\n      style: this.style_,\r\n      name: 'capatopo'\r\n    });\r\n    this.sourceProfile_ = new ol.source.Vector();\r\n    this.vectorProfile_ = new ol.layer.Vector({\r\n      source: this.sourceProfile_,\r\n    });\r\n    this.vector_.setZIndex(1000);\r\n    this.facadeMap_.getMapImpl().addLayer(this.vector_);\r\n    this.projectionMap_ = this.facadeMap_.getProjection().code;\r\n\r\n\r\n  }\r\n\r\n  findNewPoints(originPoint, destPoint) {\r\n    //let points = new Array();\r\n    let addX, addY;\r\n    let points = new String();\r\n    let oriMete = ol.proj.transform(originPoint, this.projectionMap_, this.mercator_);\r\n    let destMete = ol.proj.transform(destPoint, this.projectionMap_, this.mercator_);\r\n    let angle = this.getAngleBetweenPoints(oriMete, destMete);\r\n    let distance = this.getDistBetweenPoints(originPoint, destPoint);\r\n    if (distance < 50) {\r\n      return;\r\n    }\r\n    let distPoint = (distance / this.distancePoinst_ > this.distancePoinst_) ? distance / this.distancePoinst_ : this.distancePoinst_;\r\n    for (let i = 0; i <= distance / distPoint; i++) {\r\n      if (angle >= 0 && angle <= 90) {\r\n        [addX, addY] = [1, 1];\r\n      } else if (angle >= 90) {\r\n        [addX, addY] = [-1, 1];\r\n      } else if (angle <= 0 && angle >= -90) {\r\n        [addX, addY] = [1, -1];\r\n      } else {\r\n        [addX, addY] = [-1, -1];\r\n      }\r\n      let newPointA = [(Math.cos(angle * Math.PI / 180) * (distPoint * i)) + oriMete[0], (Math.sin(angle * Math.PI / 180) * (distPoint * i)) + oriMete[1]];\r\n      let newPointB = [(Math.cos(angle * Math.PI / 180) * ((distPoint * i) + addX)) + oriMete[0], (Math.sin(angle * Math.PI / 180) * ((distPoint * i) + addY)) + oriMete[1]];\r\n      points += (ol.proj.transform(newPointA, this.mercator_, this.coordEPSG4326)) + \",\";\r\n      points += (ol.proj.transform(newPointB, this.mercator_, this.coordEPSG4326)) + \"|\";\r\n    }\r\n\r\n    return points;\r\n  }\r\n\r\n\r\n  getDistBetweenPoints(firstPoint, secondPoint) {\r\n    let line = new ol.geom.LineString([ol.proj.transform(firstPoint, this.projectionMap_, this.mercator_), ol.proj.transform(secondPoint, this.projectionMap_, this.mercator_)]);\r\n    return line.getLength();\r\n\r\n  }\r\n\r\n  getAngleBetweenPoints(firstPoint, secondPoint) {\r\n    let p1 = {\r\n      x: firstPoint[0],\r\n      y: firstPoint[1]\r\n    };\r\n    let p2 = {\r\n      x: secondPoint[0],\r\n      y: secondPoint[1]\r\n    };\r\n    // angle in degrees\r\n    let angleDeg = Math.atan2(p2.y - p1.y, p2.x - p1.x) * 180 / Math.PI;\r\n    return angleDeg;\r\n  }\r\n\r\n  startLoad() {\r\n    document.body.style.cursor = 'wait';\r\n    this.deactivate();\r\n    let panel = document.querySelector(\".m-topographicprofile.activated\");\r\n    panel.style.pointerEvents = \"none\";\r\n\r\n  }\r\n\r\n\r\n  endLoad() {\r\n    document.body.style.cursor = 'default';\r\n    this.activate();\r\n    let panel = document.querySelector(\".m-topographicprofile.activated\");\r\n    panel.style.pointerEvents = \"auto\";\r\n  }\r\n\r\n\r\n  activate() {\r\n    if (!this.draw_) {\r\n      this.createIteraction(\"LineString\");\r\n    }\r\n    this.facadeMap_.getMapImpl().addInteraction(this.draw_);\r\n    document.querySelector('#m-topographicprofile-btn').classList.add('activated');\r\n  }\r\n\r\n  createIteraction(typeGeom) {\r\n    this.draw_ = new ol.interaction.Draw({\r\n      source: this.source_,\r\n      type: /** @type {ol.geom.GeometryType} */ (typeGeom)\r\n    });\r\n    this.draw_.on('drawstart', function(evt) {\r\n      this.projectionMap_ = this.facadeMap_.getProjection().code;\r\n      this.clearLayer();\r\n    }.bind(this));\r\n    this.draw_.on('drawend', function(evt) {\r\n      this.lineCoord_ = evt.feature.getGeometry().getCoordinates();\r\n      // this.facadeMap_.getMapImpl().addInteraction(this.draw_);\r\n      this.pointsCoord_ = new String();\r\n      for (let i = 1; i < this.lineCoord_.length; i++) {\r\n        this.pointsCoord_ = this.pointsCoord_.concat(this.findNewPoints(this.lineCoord_[i - 1], this.lineCoord_[i]));\r\n      }\r\n      this.getDataFromGGISCore();\r\n    }.bind(this));\r\n  }\r\n\r\n  getDataFromGGISCore() {\r\n    if (!this.pointsCoord_) return;\r\n    let pointsBbox = this.pointsCoord_.split('|');\r\n    const altitudes = [];\r\n    const promises = [];\r\n    pointsBbox = pointsBbox.filter((elem) => {\r\n      return elem !== '' && elem.trim().length > 3;\r\n    });\r\n\r\n    M.proxy(false);\r\n    pointsBbox.forEach((bbox) => {\r\n      const url = `${PROFILE_URL}${bbox}${PROFILE_URL_SUFFIX}`;\r\n      promises.push(M.remote.get(url));\r\n    });\r\n\r\n    Promise.all(promises).then((responses) => {\r\n      M.proxy(true);\r\n      responses.forEach((response) => {\r\n        let alt = 0;\r\n        const responseText = response.text.split(NO_DATA_VALUE).join('');\r\n        if (responseText.indexOf('dy') > -1) {\r\n          alt = responseText.split('dy')[1].split(' ').filter((item) => {\r\n            return item !== '';\r\n          })[1];\r\n        } else if (responseText.indexOf('cellsize') > -1) {\r\n          alt = responseText.split('cellsize')[1].split(' ').filter((item) => {\r\n            return item !== '';\r\n          })[1];\r\n        }\r\n\r\n        altitudes.push(parseFloat(alt));\r\n      });\r\n\r\n      const arrayXZY = [];\r\n      altitudes.forEach((data, index) => {\r\n        const points = pointsBbox[index].split(',');\r\n        const center = ol.extent.getCenter([parseFloat(points[0]), parseFloat(points[1]),\r\n          parseFloat(points[2]), parseFloat(points[3])\r\n        ]);\r\n        arrayXZY.push([center[0], center[1], data]);\r\n      });\r\n      this.controlProfile();\r\n\r\n      const arrayXZY2 = arrayXZY.map((coord) => {\r\n        return ol.proj.transform(coord, 'EPSG:4326', this.facadeMap_.getProjection().code);\r\n      });\r\n\r\n      this.lineString_.setCoordinates(arrayXZY2);\r\n    }).catch((err) => {\r\n      M.proxy(true);\r\n      M.dialog.error('No se han obtenido datos');\r\n    });\r\n  }\r\n\r\n  setDataFromLocal(coordsXYZ) {\r\n    this.controlProfile();\r\n    coordsXYZ = coordsXYZ.map((coord) => ol.proj.transform(coord, 'EPSG:4326', this.facadeMap_.getProjection().code));\r\n    this.lineString_.setCoordinates(coordsXYZ);\r\n    this.vector_.getSource().addFeature(this.feature_);\r\n  }\r\n\r\n\r\n  controlProfile() {\r\n    if (!this.profil_) {\r\n      this.lineString_ = new ol.geom.LineString([]);\r\n      this.feature_ = new ol.Feature({\r\n        geometry: this.lineString_,\r\n        name: 'Line'\r\n      });\r\n      this.sourceProfile_.addFeature(this.feature_);\r\n      this.profil_ = new Profil({\r\n        info: {\r\n          zmin: getValue('profil.zmin'),\r\n          zmax: getValue('profil.zmax'),\r\n          altitude: getValue('profil.altitude'),\r\n          distance: getValue('profil.distance'),\r\n          ytitle: getValue('profil.ytitle'),\r\n          xtitle: getValue('profil.xtitle'),\r\n          altitudeUnits: 'm',\r\n          \"distanceUnitsM\": 'm',\r\n          'distanceUnitsKM': 'km'\r\n        },\r\n        projection: this.facadeMap_.getProjection().code,\r\n        map: this.facadeMap_.getMapImpl(),\r\n        source: this.source_\r\n      });\r\n      this.facadeMap_.getMapImpl().addControl(this.profil_);\r\n      let drawPoint = function(e) {\r\n        if (!this.pt) return;\r\n        if (e.type == \"over\") { // Show point at coord\r\n          this.pt.setGeometry(new ol.geom.Point(e.coord));\r\n          this.pt.setStyle([new ol.style.Style({\r\n            image: new ol.style.Circle({\r\n              radius: 7,\r\n              fill: new ol.style.Fill({\r\n                color: '#ff0000',\r\n              }),\r\n            }),\r\n          })]);\r\n        } else { // hide point\r\n          this.pt.setStyle([]);\r\n        }\r\n      }.bind(this);\r\n      this.sourceProfile_.once('change', function(e) {\r\n        if (this.sourceProfile_.getState() === 'ready') {\r\n          this.profil_.setGeometry(this.sourceProfile_.getFeatures()[0]);\r\n          this.pt = new ol.Feature(new ol.geom.Point([0, 0]));\r\n          this.pt.setStyle([]);\r\n          this.source_.addFeature(this.pt);\r\n        }\r\n      }.bind(this));\r\n\r\n      this.profil_.on([\"over\", \"out\"], function(e) {\r\n        if (e.type == \"over\") this.profil_.popup(e.coord[2] + \" m\");\r\n        drawPoint(e);\r\n      }.bind(this));\r\n\r\n    }\r\n    this.profil_.show();\r\n  }\r\n\r\n  deactivate() {\r\n    if (this.draw_) {\r\n      this.facadeMap_.getMapImpl().removeInteraction(this.draw_);\r\n      this.clearLayer();\r\n      document.querySelector('#m-topographicprofile-btn').classList.remove('activated');\r\n    }\r\n    //Aquí hay que poner que se cambie el estilo del botón\r\n  }\r\n\r\n  clearLayer() {\r\n    this.source_.clear();\r\n    if (this.profil_) {\r\n      this.profil_.hide();\r\n      this.sourceProfile_.clear();\r\n      this.facadeMap_.getMapImpl().removeControl(this.profil_);\r\n      this.profil_ = null;\r\n    }\r\n  }\r\n\r\n  removeLayer() {\r\n    this.deactivate();\r\n    this.clearLayer();\r\n    this.facadeMap_.getMapImpl().removeLayer(this.vector_);\r\n  }\r\n\r\n  destroy() {\r\n    this.removeLayer();\r\n    this.facadeMap_.getMapImpl().removeControl(this);\r\n  }\r\n\r\n  toggle() {\r\n    if (this.profil_) {\r\n      this.profil_.toggle();\r\n    }\r\n  }\r\n\r\n\r\n}\r\n","/**\r\n * @module M/control/Topographicprofilecontrol\r\n */\r\n\r\nimport TopographicprofileImplControl from 'impl/topographicprofilecontrol';\r\nimport template from 'templates/perfiltopografico';\r\nimport { getValue } from './i18n/language';\r\n\r\nexport default class TopographicprofileControl extends M.Control {\r\n  /**\r\n   * @classdesc\r\n   * Main constructor of the class. Creates a PluginControl\r\n   * control\r\n   *\r\n   * @constructor\r\n   * @extends {M.Control}\r\n   * @api stable\r\n   */\r\n  constructor(opts) {\r\n\r\n    // 1. checks if the implementation can create PluginControl\r\n    if (M.utils.isUndefined(TopographicprofileImplControl)) {\r\n      M.exception('La implementación usada no puede crear controles TopographicprofileControl');\r\n    }\r\n    // 2. implementation of this control\r\n    const impl = new TopographicprofileImplControl(opts);\r\n    super(impl, 'Topographicprofile');\r\n\r\n\r\n  }\r\n\r\n  /**\r\n   * This function creates the view\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Map} map to add the control\r\n   * @api stable\r\n   */\r\n  createView(map) {\r\n    if (!M.template.compileSync) { // JGL: retrocompatibilidad Mapea4\r\n      M.template.compileSync = (string, options) => {\r\n        let templateCompiled;\r\n        let templateVars = {};\r\n        let parseToHtml;\r\n        if (!M.utils.isUndefined(options)) {\r\n          templateVars = M.utils.extends(templateVars, options.vars);\r\n          parseToHtml = options.parseToHtml;\r\n        }\r\n        const templateFn = Handlebars.compile(string);\r\n        const htmlText = templateFn(templateVars);\r\n        if (parseToHtml !== false) {\r\n          templateCompiled = M.utils.stringToHtml(htmlText);\r\n        } else {\r\n          templateCompiled = htmlText;\r\n        }\r\n        return templateCompiled;\r\n      };\r\n    }\r\n    this.facadeMap_ = map;\r\n\r\n    return new Promise((success, fail) => {\r\n      const html = M.template.compileSync(template);\r\n      // Añadir código dependiente del DOM\r\n      this.template_ = html;\r\n      html.querySelector('#m-topographicprofile-btn').title = getValue('title');\r\n      success(html);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * This function gets activation button\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {HTML} html of control\r\n   * @api stable\r\n   */\r\n  getActivationButton(html) {\r\n    return html.querySelector('#m-topographicprofile-btn');\r\n  }\r\n\r\n\r\n  /**\r\n   * This function is called on the control deactivation\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   */\r\n  deactivate() {\r\n    super.deactivate();\r\n  }\r\n\r\n  /**\r\n   * This function compares controls\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Control} control to compare\r\n   * @api stable\r\n   */\r\n  equals(control) {\r\n    return control instanceof TopographicprofileControl;\r\n  }\r\n}\r\n","/**\r\n * @module M/plugin/Topographicprofile\r\n */\r\nimport 'assets/css/topographicprofile';\r\nimport TopographicprofileControl from './topographicprofilecontrol';\r\nimport api from '../../api';\r\nimport { getValue } from './i18n/language';\r\n\r\nimport es from './i18n/es';\r\nimport en from './i18n/en';\r\n\r\nexport default class Topographicprofile extends M.Plugin {\r\n  /**\r\n   * @classdesc\r\n   * Main facade plugin object. This class creates a plugin\r\n   * object which has an implementation Object\r\n   *\r\n   * @constructor\r\n   * @extends {M.Plugin}\r\n   * @param {Object} impl implementation object\r\n   * @api stable\r\n   */\r\n  constructor(opts = {}) {\r\n    super();\r\n    /**\r\n     * Facade of the map\r\n     * @private\r\n     * @type {M.Map}\r\n     */\r\n    this.map_ = null;\r\n\r\n    /**\r\n     * Array of controls\r\n     * @private\r\n     * @type {Array<M.Control>}\r\n     */\r\n    this.controls_ = [];\r\n\r\n    /**\r\n     * Position\r\n     * @private\r\n     * @type {Array<M.Control>}\r\n     */\r\n    this.position_ = opts.position ? opts.position : 'TR';\r\n\r\n\r\n    /**\r\n     * Metadata from api.json\r\n     * @private\r\n     * @type {Object}\r\n     */\r\n    this.metadata_ = api.metadata;\r\n\r\n\r\n\r\n    this.facadeMap_ = null;\r\n    this.panel_ = null;\r\n    this.control_ = null;\r\n    this.options_ = opts;\r\n\r\n    /**\r\n     * Distance, default 30\r\n     * @private\r\n     * @type {Boolean}\r\n     */\r\n    this.options_.distance = opts.distance || 30;\r\n\r\n     /**\r\n     * Hide or show panel. By default true.\r\n     * @private\r\n     * @type {Boolean}\r\n     */\r\n    this.options_.visible = opts.hasOwnProperty('visible') ? opts.visible : true;\r\n    // this.options_.serviceURL = opts.serviceURL || ((M.config.GGIS_RESTAPI) ? M.config.GGIS_RESTAPI + \"/services/elevation\" : \"http://ggiscloud.guadaltel.com/ggiscloud/restapi/services/elevation\");\r\n    //'http://idecan5.grafcan.es/ServicioWPS/mdt';\r\n  }\r\n\r\n  /**\r\n   * Return plugin language\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {string} lang type language\r\n   * @api stable\r\n   */\r\n   static getJSONTranslations(lang) {\r\n    if (lang === 'en' || lang === 'es') {\r\n      return (lang === 'en') ? en : es;\r\n    }\r\n    return M.language.getTranslation(lang).topographicprofile;\r\n  }\r\n\r\n  /**\r\n   * This function adds this plugin into the map\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Map} map the map to add the plugin\r\n   * @api stable\r\n   */\r\n  addTo(map) {\r\n    this.controls_.push(new TopographicprofileControl(this.options_));\r\n    this.map_ = map;\r\n    // panel para agregar control - no obligatorio\r\n    this.panel_ = new M.ui.Panel('panelTopographicprofile', {\r\n      // 'collapsible': true,\r\n      'className': 'm-topographicprofile',\r\n      'collapsedButtonClass': 'icon-chart',\r\n      'position': M.ui.position[this.position_],\r\n      'tooltip': getValue('tooltip')\r\n    });\r\n    this.panel_.addControls(this.controls_);\r\n    map.addPanels(this.panel_);\r\n    if(!this.options_.visible) {\r\n      document.getElementsByClassName('m-topographicprofile')[0].style.display = 'none';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * This function set externally data for draw the graphic.\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   */\r\n  setDataFromLocal(coordsXYZ) {\r\n    this.controls_[0].impl_.setDataFromLocal(coordsXYZ);\r\n  }\r\n\r\n  /**\r\n   * This function gets metadata plugin\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   */\r\n  getMetadata() {\r\n    return this.metadata_;\r\n  }\r\n\r\n  /**\r\n   * Get the API REST Parameters of the plugin\r\n   *\r\n   * @function\r\n   * @public\r\n   * @api\r\n   */\r\n  getAPIRest() {\r\n    return `${this.name}=${this.position_}`\r\n  }\r\n\r\n  /**\r\n   * This function destroys this plugin\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   */\r\n  destroy() {\r\n    this.map_.removeControls(this.controls_);\r\n    [this.map_, this.controls_, this.panel_] = [null, null, null];\r\n  }\r\n\r\n  get name() {\r\n    return \"topographicprofile\";\r\n  }\r\n}\r\n","import M$plugin$Topographicprofile from '/home/alvaroramirez/Escritorio/entrega API/API-CNIG/api-ign-js/src/plugins/topographicprofile/src/facade/js/topographicprofile';\nimport M$control$Topographicprofilecontrol from '/home/alvaroramirez/Escritorio/entrega API/API-CNIG/api-ign-js/src/plugins/topographicprofile/src/facade/js/topographicprofilecontrol';\nimport M$impl$control$TopographicprofileControl from '/home/alvaroramirez/Escritorio/entrega API/API-CNIG/api-ign-js/src/plugins/topographicprofile/src/impl/ol/js/topographicprofilecontrol';\n\nif (!window.M.plugin) window.M.plugin = {};\nif (!window.M.control) window.M.control = {};\nif (!window.M.impl) window.M.impl = {};\nif (!window.M.impl.control) window.M.impl.control = {};\nwindow.M.plugin.Topographicprofile = M$plugin$Topographicprofile;\nwindow.M.control.Topographicprofilecontrol = M$control$Topographicprofilecontrol;\nwindow.M.impl.control.TopographicprofileControl = M$impl$control$TopographicprofileControl;\n"],"sourceRoot":""}